2021-11-03 13:41:11,360 ERROR org.apache.juli.logging.DirectJDKLog [http-nio-80-exec-4] Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is org.thymeleaf.exceptions.TemplateInputException: Error resolving template [<!DOCTYPE html>
<html>
<head>
   <meta charset="UTF-8">
   <title>Главная</title>
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
         integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

   <!-- Не переносите подтягивание jQuery вниз файла, иначе он не сможет его прочитать в header-е, который встраивается
        в начало этой странице -->
   <script src="https://code.jquery.com/jquery-3.6.0.min.js"
           integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
</head>
<body>
   
   
   <!-- модалка для входа юзеру -->
   <div class="modal fade" id="user_modal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
         <div class="modal-content">
            <div class="modal-header">
               <h5 class="modal-title">Войдите в систему</h5>
               <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="user_signin_form" action="/login" method="post">
               <div class="modal-body">
                  <div class="mb-3">
                     <label for="username_input" class="form-label">Введите email:</label>
                     <input id="username_input" type="text" name="j_username" class="form-control"
                            placeholder="Username">
                     <div id="username_checker" class="form-text" style="color:#a40000;"></div>
                  </div>
                  <div class="mb-3">
                     <label for="password_input" class="form-label">Введите пароль:</label>
                     <input id="password_input" type="password" name="j_password" class="form-control"
                            placeholder="Password">
                     <div id="password_checker" class="form-text" style="color:#a40000;"></div>
                  </div>
                  <div class="mb-3">
                     <label for="verification_code_input" class="form-label">
                        Введите код с телефона (если используете 2FA):
                     </label>
                     <input id="verification_code_input" type="text" name="code" class="form-control"
                            placeholder="Verification code">
                  </div>
                  <div class="form-check">
                     <input class="form-check-input" type="checkbox" name="remember-me" id="flexCheckChecked"
                            checked>
                     <label class="form-check-label" for="flexCheckChecked">
                        Запомнить пароль
                     </label>
                  </div>
                  <br>
                  <p align="center">или войдите с помощью:</p>
                  <div class="form-group" align="center">
                     <div class="col-md-3">
                        <a class="btn btn-outline-dark" href="/oauth2/authorization/google" role="button"
                           style="text-transform:none">
                           <img width="20px" style="margin-bottom:3px; margin-right:10px; margin-left:30px"
                                src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/53/Google_%22G%22_Logo.svg/512px-Google_%22G%22_Logo.svg.png"/>
                           Login with google
                        </a>
                     </div>
                  </div>
                  <div class="form-group" align="center">
                     <div class="col-md-3">
                        <a class="btn btn-outline-dark" href="/oauth2/authorization/github" role="button"
                           style="text-transform:none" w>
                           <img width="20px" style="margin-bottom:3px; margin-right:10px; margin-left:30px"
                                src="https://wodensoft.co.uk/wp-content/uploads/2020/05/Github.png"/>
                           Login with github
                        </a>
                     </div>
                  </div>
                  <hr>
                  <p align="center">если вы у нас впервые:</p>
               </div>

               <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Отмена</button>
                  <button type="button" id="user_signin_btn" class="btn btn-primary"
                          onclick="{event.preventDefault(); signin()}">
                     Войти
                  </button>
               </div>
            </form>
         </div>
      </div>
   </div>

   <!-- Модалка для регистрации -->
   <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
         <div class="modal-content" style="width:750px;">
            <div class="modal-body">
               <div class="box">
                  <div class="form loginBox">
                     <b></b>
                     <b></b>

                     <form>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="usernameSave">Имя пользователя</label>
                              <input class="form-control" type="text" value="" id="usernameSave" required
                                     minlength="4"
                                     placeholder="Введите имя пользователя">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="emailSave">Адрес электронной почты</label>
                              <input class="form-control" type="email" value="" id="emailSave"
                                     pattern="^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}"
                                     title="в формате user@example.com" required
                                     placeholder="Введите адрес электронной почты">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="passwordSave">Пароль</label>
                              <input class="form-control" type="password" value="" id="passwordSave" required
                                     minlength="6"
                                     placeholder="Введите пароль">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="phoneSave">Номер телефона</label>
                              <input class="form-control" type="text" value="" id="phoneSave" required
                                     minlength="11" pattern="[0-9]+"
                                     title="указать цифрами" placeholder="Введите номер телефона">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="first_nameSave">Имя</label>
                              <input class="form-control" type="text" value="" id="first_nameSave"
                                     placeholder="Введите имя">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="last_nameSave">Фамилия</label>
                              <input class="form-control" type="text" value="" id="last_nameSave"
                                     placeholder="Введите фамилию">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="ageSave">Возраст</label>
                              <input class="form-control" type="number" value="" id="ageSave"
                                     placeholder="Введите возраст">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-2">
                              <label class="form-label" for="countrySave">Страна</label>
                              <input class="form-control" type="text" value="" id="countrySave"
                                     placeholder="Введите страну">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="citySave">Город</label>
                              <input class="form-control" type="text" value="" id="citySave"
                                     placeholder="Введите город">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="cityIndexSave">Индекс города</label>
                              <input class="form-control" type="text" value="" id="cityIndexSave"
                                     placeholder="Введите индекс города">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-2">
                              <label class="form-label" for="streetSave">Улица</label>
                              <input class="form-control" type="text" value="" id="streetSave"
                                     placeholder="Введите улицу">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="houseSave">Номер дома</label>
                              <input class="form-control" type="text" value="" id="houseSave"
                                     placeholder="Введите номер дома">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="birthdaySave">Дата рождения</label>
                              <input class="form-control" type="date" value="" id="birthdaySave">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="genderSave">Выберите пол:</label>
                              <br>
                              <select class="form-select" size="3" id="genderSave" name="gender" required="">
                                 <option id="ManSave" value="MALE">Мужчина</option>
                                 <option id="WomanSave" value="FEMALE">Женщина</option>
                                 <option id="NoGenderSave" value="UNKNOWN">Не определен</option>
                              </select>
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <input type="button" class="btn btn-primary" value="Зарегистрироваться"
                                     onclick="{event.preventDefault(); saveUser()}"/>
                           </div>
                        </div>
                     </form>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>

   <!--HEADER-->
   <div>
      <!--HEADER-->
      <header class="bg-dark text-white" style="height: 44px;">
         <div class="container" style="height: 44px;">
            <div class="d-flex align-items-center justify-content-center justify-content-lg-start"
                 style="height: 44px;">
               <a href="/" class="d-flex align-items-center mb-lg-0 text-white text-decoration-none">
                  <h5 style="margin: 0;">LOGO</h5>
               </a>
               <!--NavBar(HEADER)-->
               <ul class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0 ms-5">
                  <li><a href="/shops" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Магазины</font></font></a></li>
                  <li><a href="#" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Товары</font></font></a></li>
                  <li></li>
                  <li><a href="#" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Ещё...</font></font></a></li>
                  <li></li>
                  <li></li>
               </ul>




               <div class="text-end">


                  <button type="button" id="user_open_modal_btn"
                          class="btn btn-outline-light me-2">Войти
                  </button>
                  <button type="button" id="user_open_modal_reg" class="btn btn-warning">
                     Зарегистрироваться
                  </button>

                  <script>
                     $(document).ready(function () {
                        if (window.location.href !== 'http://localhost:8888/') {
                           $('#user_open_modal_btn').hide();
                        }
                     })
                     $(document).ready(function () {
                        if (window.location.href !== 'http://localhost:8888/') {
                           $('#user_open_modal_reg').hide();
                        }
                     })
                  </script>

                  <!--ссылка и информация пользователя при аутентификации-->
                  
               </div>
            </div>
         </div>
         <nav class="navbar fixed-bottom navbar-light bg-light">
            <a class="navbar-brand" href="/feedback">Обратная связь</a>
         </nav>
      </header>
   </div>

   <!--Main zone-->
   <section class="d-flex">
      <!--Sidebar-->
      <div class="bg-light" style="width: 350px; min-height: 100vh; padding-top: 30px; padding-bottom: 200px">
         <div class="container-fluid">
            <div class="row">
               <div class="col-12 d-flex align-items-center">
                  <h5>Категории</h5>
               </div>

               <div class="col-12 d-flex justify-content-center">
                  <hr style="width: 100%; margin: 0;">
               </div>
               <!--Категории-->
               <div class="col-12 mt-4">
                  <ul class="nav nav-pills flex-column mb-auto">
                     <li class="nav-item">
                        <a id="popular_show_btn" href="#" class="nav-link active" aria-current="page">
                           Популярное
                           </font></font></a>
                     </li>

                     
                        <li class="nav-item">
                           <a id="9" href="#"
                              class="nav-link link-dark" aria-current="page">Автомобили</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="3" href="#"
                              class="nav-link link-dark" aria-current="page">Аксессуары</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="5" href="#"
                              class="nav-link link-dark" aria-current="page">Бытовая техника</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="6" href="#"
                              class="nav-link link-dark" aria-current="page">Детские товары</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="7" href="#"
                              class="nav-link link-dark" aria-current="page">Компьютеры</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="4" href="#"
                              class="nav-link link-dark" aria-current="page">Мебель</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="8" href="#"
                              class="nav-link link-dark" aria-current="page">Мобильные телефоны</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="2" href="#"
                              class="nav-link link-dark" aria-current="page">Обувь</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="1" href="#"
                              class="nav-link link-dark" aria-current="page">Одежда</a>
                        </li>
                     
                  </ul>
               </div>
            </div>
         </div>
      </div>

      <!--Main Body-->
      <div class="container-fluid" style="padding-top: 30px; padding-left: 35px; padding-bottom: 40px;">
         <div class="row">
            <div class="col-12">
               <form style="width: 650px;" class="d-flex">
                  <input id="search_input" type="search" class="form-control" name="search"
                         placeholder="Поиск по наименованию:">
                  <button id="search_btn" type="button" class="btn btn-success" style="width: 150px;">Поиск</button>
               </form>
            </div>

            <!-- QR and enable 2FA -->
            

         <!--Контейнер для динамического контента (js)-->
         <div class="collapse" id="dinamic_content">
            <div class="col-12" style="margin-top: 30px;">
               <h4 id="dinamic_head"></h4>
            </div>
            <!--сюда генерируются товары-->
            <div class="col-12 d-flex flex-wrap mt-3" id="dinamic_content_inner">

               </div>
            </div>

            <!--Контейнер для статического контента (при загрузке страницы)-->
            <div class="collapse show" id="popular_show_content">
               <div class="col-12" style="margin-top: 30px;">
                  <h4>
                     Популярные товары
                  </h4>
               </div>
               <!--Блок популярные товары-->
               <div class="col-12 d-flex flex-wrap mt-3">
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://pe-shop.ru/pictures/product/big/6045_big.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Антисептик для рук</h5>
                           <p class="card-text">Антисептик для рук</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;5&#39;,&#39;1&#39;)">В корзину</a>
                              <a href="/product/5" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton5">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem5"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.ikea.com/ru/ru/images/products/klappa-myagkaya-igrushka-myach-raznocvetnyy__0873096_pe682670_s5.jpg?f=xxs" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Мягкая игрушка</h5>
                           <p class="card-text">Мягкая игрушка</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;10&#39;,&#39;2&#39;)">В корзину</a>
                              <a href="/product/10" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton10">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem10"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.ikea.com/ru/ru/images/products/gulligast-gulligest-mobil__0923957_pe788456_s5.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Мобиль</h5>
                           <p class="card-text">Мобиль</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;11&#39;,&#39;3&#39;)">В корзину</a>
                              <a href="/product/11" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton11">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem11"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.opticmall.ru/assets/images/products/3908/2132-622-17.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Очки RAY BAN</h5>
                           <p class="card-text">Очки RAY BAN</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;4&#39;,&#39;2&#39;)">В корзину</a>
                              <a href="/product/4" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton4">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem4"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://cdn.rbt.ru/images/gen/item_image/image/8507/23/850668_r7634.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Ноутбук Lenovo</h5>
                           <p class="card-text">Ноутбук Lenovo</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;7&#39;,&#39;4&#39;)">В корзину</a>
                              <a href="/product/7" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton7">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem7"></div>
                        </div>
                     </div>
                  

               </div>
               <!--Блок популярные магазины-->
               <div class="col-12" style="margin-top: 30px;">
                  <h4>
                     Популярные магазины
                  </h4>
               </div>

               <div class="col-12 d-flex flex-wrap mt-3">
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/beru.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Яндекс Маркет</h5>
                           <p class="card-text">Одежда, обувь, бытовая техника</p>
                           <a href="/showcase/1" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/lamoda.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Lamoda</h5>
                           <p class="card-text">Одежда, обувь, аксессуары</p>
                           <a href="/showcase/2" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/aliexpress.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">AliExpress</h5>
                           <p class="card-text">Любые товары</p>
                           <a href="/showcase/4" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
               </div>
            </div>

         </div>
      </div>
   </section>

   <script src="https://code.jquery.com/jquery-3.6.0.min.js"
           integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

   <!-- JavaScript Bundle with Popper -->
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
           integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
           crossorigin="anonymous"></script>
   <script>
      /**
       * связано с статическим контентом
       */
      const popular_show_btn = $('#popular_show_btn');
      const popular_show_content = $('#popular_show_content');
      /**
       * динамический контент
       */
      const dinamic_show_content = $('#dinamic_content');
      const dinamic_head = $('#dinamic_head');
      const dinamic_inner_content = $('#dinamic_content_inner');
      /**
       * поиск
       */
      const search_input = $('#search_input');
      const search_btn = $('#search_btn');
      /**
       *  вход в систему и модальное окно входа в систему
       */
      const user_modal = $('#user_modal');
      const user_open_modal_btn = $('#user_open_modal_btn');
      const user_signin_form = $('#user_signin_form');
      const username_input = $('#username_input');
      const password_input = $('#password_input');
      const username_checker = $('#username_checker');
      const password_checker = $('#password_checker');
      const loginModal = $('#loginModal');
      const user_open_modal_reg = $('#user_open_modal_reg');

      $(document).ready(function () {

         /**
          * обработчик
          * проверка корректности отпавленной формы
          */
         $(user_signin_form).on('submit', function (e) {
            username_checker.html('');
            password_checker.html('');
            let username = username_input.val();
            let password = password_input.val();
            if (username === "" || username === " ") {
               username_checker.html('Поле username не должно быть пустым');
               e.preventDefault();
            } else if (password === "" || password === " ") {
               password_checker.html('Поле password не должно быть пустым')
               e.preventDefault();
            }
         })

         /**
          * обработчик
          * открытие модального окна входа в систему
          */
         $(user_open_modal_btn).on('click', function (e) {
            e.preventDefault();
            user_modal.modal('show');
         })
         $(user_open_modal_reg).on('click', function (e) {
            e.preventDefault();
            loginModal.modal('show');
         })

         /**
          * обработчик
          * обработка поиска
          */
         $(search_btn).on('click', function (e) {
            e.preventDefault();
            toggleClassesContent($(this));
            toggleClassesNavBar(null);
            let valueSearch = search_input.val();
            search_input.val('');

            /**
             * обрабочтик
             * проверка на пустое значение поиска
             */
            if (valueSearch === '') {
               dinamic_head.html('');
               dinamic_head.html('Все товары')
            } else {
               dinamic_head.html('');
               dinamic_head.html('Результат запроса "' + valueSearch + '"');
            }
         })

         /**
          * обработчик
          * обработчик на кнопке "популярное" в навбар
          */
         $(popular_show_btn).on('click', function (e) {
            e.preventDefault();
            toggleClassesContent($(this));
            toggleClassesNavBar($(this));
         })

         /**
          * обработчик
          * обработчик на все кнопки в навбар кроме "популярное"
          */
         $('.link-dark').on('click', function (e) {
            e.preventDefault();
            /**
             * переключение стилей кнопок навбара и контейнера с контентом
             */
            toggleClassesContent($(this));
            toggleClassesNavBar($(this));

            /**
             * перезапись категории в заголовок
             */
            let category = $(this).html();
            dinamic_head.html("");
            dinamic_head.html(category);
            /** перезапись динамического контента
             *  товары по категории
             */
            searchByCategory($(this));
         })


      })

      /**
       * отправляет GET запрос на /home/category/id = категории
       * генерирует html из массива итемов на странице
       */
      async function searchByCategory(e) {
         const categoryId = $(e).attr("id");
         const response = await fetch("/category/" + categoryId);
         if (response.ok) {
            let items = await response.json();
            /**
             * Добавляем итемы по категориям на страницу
             * */
            let itemsByCategoryHTML = "";
            for (let i = 0; i < items.length; i++) {
               itemsByCategoryHTML += '<div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">\n' +
                  '                       <img src="' + items[i].images[0] + '" class="card-img-top" alt="popular_item" style="height: 180px;">' +
                  '                           <div class="card-body">\n' +
                  '                                <h5 class="card-title">' + items[i].name + '</h5>' +
                  '                                <p class="card-text">' + items[i].description + '</p>' +
                  '                                <div class="d-flex">\n' +
                  '                                    <a href="#" class="btn btn-danger" style="width: 150px;">В корзину</a>' +
                  '                                    <a href="/product/' + items[i].id + '" class="btn btn-primary" style="margin-left: 10px;">Смотреть</a>' +
                  '                                </div>' +
                  '                           </div>' +
                  '                   </div>';
            }
            dinamic_inner_content.html("");
            dinamic_inner_content.html(itemsByCategoryHTML);
         }
      }

      /**
       * функция переключения классов контейнера с контентом
       */
      function toggleClassesContent(e) {
         if ($(e).is(popular_show_btn)) {
            popular_show_content.addClass('show');
            dinamic_show_content.removeClass('show');
            dinamic_inner_content.html("");
         } else {
            popular_show_content.removeClass('show');
            dinamic_show_content.addClass('show');
         }
      }

      /**
       * функция переключения кнопок в навбар
       */
      function toggleClassesNavBar(e) {
         $('.active').removeClass('active').addClass('link-dark');
         $(e).removeClass('link-dark');
         $(e).addClass('active');
      }

      async function addCartItem(itemId, shopId) {
         // let quant = document.getElementById("itemQuant").value;
         let url = new URL("http://localhost:8888/api/cart/add")
         const response = await fetch(url, {
            method: 'POST',
            headers: {
               "Accept": "application/json",
               "Content-Type": "application/json; charset=utf-8",
            },
            body: JSON.stringify({
               quantity: 1,
               item: {
                  id: itemId
               },
               shop: {
                  id: shopId
               },
            })
         })
      }

      $(async function () {
         await favoriteItem()
      })

      async function favoriteItem() {
         let items = document.getElementsByName("favItems")
         for (let i = 0; i < items.length; i++) {
            let itemDivID = items[i].id;
            let itemId = itemDivID.substr(itemDivID.indexOf("m") + 1, itemDivID.length - itemDivID.indexOf("m") + 1)
            await favoriteButtonItem(itemId);
         }
      }

   </script>
   <script type="text/javascript" src="/js/favoriteHome.js"></script>
   <script type="text/javascript" src="js/registration.js"></script>
   <script type="text/javascript" src="js/signin.js"></script>
   <script type="text/javascript" src="js/twoFactorAuth.js"></script>
</body>
</html>
], template might not exist or might not be accessible by any of the configured Template Resolvers] with root cause
org.thymeleaf.exceptions.TemplateInputException: Error resolving template [<!DOCTYPE html>
<html>
<head>
   <meta charset="UTF-8">
   <title>Главная</title>
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
         integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

   <!-- Не переносите подтягивание jQuery вниз файла, иначе он не сможет его прочитать в header-е, который встраивается
        в начало этой странице -->
   <script src="https://code.jquery.com/jquery-3.6.0.min.js"
           integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
</head>
<body>
   
   
   <!-- модалка для входа юзеру -->
   <div class="modal fade" id="user_modal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
         <div class="modal-content">
            <div class="modal-header">
               <h5 class="modal-title">Войдите в систему</h5>
               <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="user_signin_form" action="/login" method="post">
               <div class="modal-body">
                  <div class="mb-3">
                     <label for="username_input" class="form-label">Введите email:</label>
                     <input id="username_input" type="text" name="j_username" class="form-control"
                            placeholder="Username">
                     <div id="username_checker" class="form-text" style="color:#a40000;"></div>
                  </div>
                  <div class="mb-3">
                     <label for="password_input" class="form-label">Введите пароль:</label>
                     <input id="password_input" type="password" name="j_password" class="form-control"
                            placeholder="Password">
                     <div id="password_checker" class="form-text" style="color:#a40000;"></div>
                  </div>
                  <div class="mb-3">
                     <label for="verification_code_input" class="form-label">
                        Введите код с телефона (если используете 2FA):
                     </label>
                     <input id="verification_code_input" type="text" name="code" class="form-control"
                            placeholder="Verification code">
                  </div>
                  <div class="form-check">
                     <input class="form-check-input" type="checkbox" name="remember-me" id="flexCheckChecked"
                            checked>
                     <label class="form-check-label" for="flexCheckChecked">
                        Запомнить пароль
                     </label>
                  </div>
                  <br>
                  <p align="center">или войдите с помощью:</p>
                  <div class="form-group" align="center">
                     <div class="col-md-3">
                        <a class="btn btn-outline-dark" href="/oauth2/authorization/google" role="button"
                           style="text-transform:none">
                           <img width="20px" style="margin-bottom:3px; margin-right:10px; margin-left:30px"
                                src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/53/Google_%22G%22_Logo.svg/512px-Google_%22G%22_Logo.svg.png"/>
                           Login with google
                        </a>
                     </div>
                  </div>
                  <div class="form-group" align="center">
                     <div class="col-md-3">
                        <a class="btn btn-outline-dark" href="/oauth2/authorization/github" role="button"
                           style="text-transform:none" w>
                           <img width="20px" style="margin-bottom:3px; margin-right:10px; margin-left:30px"
                                src="https://wodensoft.co.uk/wp-content/uploads/2020/05/Github.png"/>
                           Login with github
                        </a>
                     </div>
                  </div>
                  <hr>
                  <p align="center">если вы у нас впервые:</p>
               </div>

               <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Отмена</button>
                  <button type="button" id="user_signin_btn" class="btn btn-primary"
                          onclick="{event.preventDefault(); signin()}">
                     Войти
                  </button>
               </div>
            </form>
         </div>
      </div>
   </div>

   <!-- Модалка для регистрации -->
   <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
         <div class="modal-content" style="width:750px;">
            <div class="modal-body">
               <div class="box">
                  <div class="form loginBox">
                     <b></b>
                     <b></b>

                     <form>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="usernameSave">Имя пользователя</label>
                              <input class="form-control" type="text" value="" id="usernameSave" required
                                     minlength="4"
                                     placeholder="Введите имя пользователя">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="emailSave">Адрес электронной почты</label>
                              <input class="form-control" type="email" value="" id="emailSave"
                                     pattern="^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}"
                                     title="в формате user@example.com" required
                                     placeholder="Введите адрес электронной почты">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="passwordSave">Пароль</label>
                              <input class="form-control" type="password" value="" id="passwordSave" required
                                     minlength="6"
                                     placeholder="Введите пароль">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="phoneSave">Номер телефона</label>
                              <input class="form-control" type="text" value="" id="phoneSave" required
                                     minlength="11" pattern="[0-9]+"
                                     title="указать цифрами" placeholder="Введите номер телефона">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="first_nameSave">Имя</label>
                              <input class="form-control" type="text" value="" id="first_nameSave"
                                     placeholder="Введите имя">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="last_nameSave">Фамилия</label>
                              <input class="form-control" type="text" value="" id="last_nameSave"
                                     placeholder="Введите фамилию">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="ageSave">Возраст</label>
                              <input class="form-control" type="number" value="" id="ageSave"
                                     placeholder="Введите возраст">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-2">
                              <label class="form-label" for="countrySave">Страна</label>
                              <input class="form-control" type="text" value="" id="countrySave"
                                     placeholder="Введите страну">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="citySave">Город</label>
                              <input class="form-control" type="text" value="" id="citySave"
                                     placeholder="Введите город">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="cityIndexSave">Индекс города</label>
                              <input class="form-control" type="text" value="" id="cityIndexSave"
                                     placeholder="Введите индекс города">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-2">
                              <label class="form-label" for="streetSave">Улица</label>
                              <input class="form-control" type="text" value="" id="streetSave"
                                     placeholder="Введите улицу">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="houseSave">Номер дома</label>
                              <input class="form-control" type="text" value="" id="houseSave"
                                     placeholder="Введите номер дома">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="birthdaySave">Дата рождения</label>
                              <input class="form-control" type="date" value="" id="birthdaySave">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="genderSave">Выберите пол:</label>
                              <br>
                              <select class="form-select" size="3" id="genderSave" name="gender" required="">
                                 <option id="ManSave" value="MALE">Мужчина</option>
                                 <option id="WomanSave" value="FEMALE">Женщина</option>
                                 <option id="NoGenderSave" value="UNKNOWN">Не определен</option>
                              </select>
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <input type="button" class="btn btn-primary" value="Зарегистрироваться"
                                     onclick="{event.preventDefault(); saveUser()}"/>
                           </div>
                        </div>
                     </form>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>

   <!--HEADER-->
   <div>
      <!--HEADER-->
      <header class="bg-dark text-white" style="height: 44px;">
         <div class="container" style="height: 44px;">
            <div class="d-flex align-items-center justify-content-center justify-content-lg-start"
                 style="height: 44px;">
               <a href="/" class="d-flex align-items-center mb-lg-0 text-white text-decoration-none">
                  <h5 style="margin: 0;">LOGO</h5>
               </a>
               <!--NavBar(HEADER)-->
               <ul class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0 ms-5">
                  <li><a href="/shops" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Магазины</font></font></a></li>
                  <li><a href="#" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Товары</font></font></a></li>
                  <li></li>
                  <li><a href="#" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Ещё...</font></font></a></li>
                  <li></li>
                  <li></li>
               </ul>




               <div class="text-end">


                  <button type="button" id="user_open_modal_btn"
                          class="btn btn-outline-light me-2">Войти
                  </button>
                  <button type="button" id="user_open_modal_reg" class="btn btn-warning">
                     Зарегистрироваться
                  </button>

                  <script>
                     $(document).ready(function () {
                        if (window.location.href !== 'http://localhost:8888/') {
                           $('#user_open_modal_btn').hide();
                        }
                     })
                     $(document).ready(function () {
                        if (window.location.href !== 'http://localhost:8888/') {
                           $('#user_open_modal_reg').hide();
                        }
                     })
                  </script>

                  <!--ссылка и информация пользователя при аутентификации-->
                  
               </div>
            </div>
         </div>
         <nav class="navbar fixed-bottom navbar-light bg-light">
            <a class="navbar-brand" href="/feedback">Обратная связь</a>
         </nav>
      </header>
   </div>

   <!--Main zone-->
   <section class="d-flex">
      <!--Sidebar-->
      <div class="bg-light" style="width: 350px; min-height: 100vh; padding-top: 30px; padding-bottom: 200px">
         <div class="container-fluid">
            <div class="row">
               <div class="col-12 d-flex align-items-center">
                  <h5>Категории</h5>
               </div>

               <div class="col-12 d-flex justify-content-center">
                  <hr style="width: 100%; margin: 0;">
               </div>
               <!--Категории-->
               <div class="col-12 mt-4">
                  <ul class="nav nav-pills flex-column mb-auto">
                     <li class="nav-item">
                        <a id="popular_show_btn" href="#" class="nav-link active" aria-current="page">
                           Популярное
                           </font></font></a>
                     </li>

                     
                        <li class="nav-item">
                           <a id="9" href="#"
                              class="nav-link link-dark" aria-current="page">Автомобили</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="3" href="#"
                              class="nav-link link-dark" aria-current="page">Аксессуары</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="5" href="#"
                              class="nav-link link-dark" aria-current="page">Бытовая техника</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="6" href="#"
                              class="nav-link link-dark" aria-current="page">Детские товары</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="7" href="#"
                              class="nav-link link-dark" aria-current="page">Компьютеры</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="4" href="#"
                              class="nav-link link-dark" aria-current="page">Мебель</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="8" href="#"
                              class="nav-link link-dark" aria-current="page">Мобильные телефоны</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="2" href="#"
                              class="nav-link link-dark" aria-current="page">Обувь</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="1" href="#"
                              class="nav-link link-dark" aria-current="page">Одежда</a>
                        </li>
                     
                  </ul>
               </div>
            </div>
         </div>
      </div>

      <!--Main Body-->
      <div class="container-fluid" style="padding-top: 30px; padding-left: 35px; padding-bottom: 40px;">
         <div class="row">
            <div class="col-12">
               <form style="width: 650px;" class="d-flex">
                  <input id="search_input" type="search" class="form-control" name="search"
                         placeholder="Поиск по наименованию:">
                  <button id="search_btn" type="button" class="btn btn-success" style="width: 150px;">Поиск</button>
               </form>
            </div>

            <!-- QR and enable 2FA -->
            

         <!--Контейнер для динамического контента (js)-->
         <div class="collapse" id="dinamic_content">
            <div class="col-12" style="margin-top: 30px;">
               <h4 id="dinamic_head"></h4>
            </div>
            <!--сюда генерируются товары-->
            <div class="col-12 d-flex flex-wrap mt-3" id="dinamic_content_inner">

               </div>
            </div>

            <!--Контейнер для статического контента (при загрузке страницы)-->
            <div class="collapse show" id="popular_show_content">
               <div class="col-12" style="margin-top: 30px;">
                  <h4>
                     Популярные товары
                  </h4>
               </div>
               <!--Блок популярные товары-->
               <div class="col-12 d-flex flex-wrap mt-3">
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://pe-shop.ru/pictures/product/big/6045_big.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Антисептик для рук</h5>
                           <p class="card-text">Антисептик для рук</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;5&#39;,&#39;1&#39;)">В корзину</a>
                              <a href="/product/5" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton5">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem5"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.ikea.com/ru/ru/images/products/klappa-myagkaya-igrushka-myach-raznocvetnyy__0873096_pe682670_s5.jpg?f=xxs" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Мягкая игрушка</h5>
                           <p class="card-text">Мягкая игрушка</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;10&#39;,&#39;2&#39;)">В корзину</a>
                              <a href="/product/10" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton10">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem10"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.ikea.com/ru/ru/images/products/gulligast-gulligest-mobil__0923957_pe788456_s5.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Мобиль</h5>
                           <p class="card-text">Мобиль</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;11&#39;,&#39;3&#39;)">В корзину</a>
                              <a href="/product/11" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton11">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem11"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.opticmall.ru/assets/images/products/3908/2132-622-17.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Очки RAY BAN</h5>
                           <p class="card-text">Очки RAY BAN</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;4&#39;,&#39;2&#39;)">В корзину</a>
                              <a href="/product/4" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton4">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem4"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://cdn.rbt.ru/images/gen/item_image/image/8507/23/850668_r7634.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Ноутбук Lenovo</h5>
                           <p class="card-text">Ноутбук Lenovo</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;7&#39;,&#39;4&#39;)">В корзину</a>
                              <a href="/product/7" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton7">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem7"></div>
                        </div>
                     </div>
                  

               </div>
               <!--Блок популярные магазины-->
               <div class="col-12" style="margin-top: 30px;">
                  <h4>
                     Популярные магазины
                  </h4>
               </div>

               <div class="col-12 d-flex flex-wrap mt-3">
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/beru.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Яндекс Маркет</h5>
                           <p class="card-text">Одежда, обувь, бытовая техника</p>
                           <a href="/showcase/1" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/lamoda.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Lamoda</h5>
                           <p class="card-text">Одежда, обувь, аксессуары</p>
                           <a href="/showcase/2" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/aliexpress.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">AliExpress</h5>
                           <p class="card-text">Любые товары</p>
                           <a href="/showcase/4" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
               </div>
            </div>

         </div>
      </div>
   </section>

   <script src="https://code.jquery.com/jquery-3.6.0.min.js"
           integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

   <!-- JavaScript Bundle with Popper -->
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
           integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
           crossorigin="anonymous"></script>
   <script>
      /**
       * связано с статическим контентом
       */
      const popular_show_btn = $('#popular_show_btn');
      const popular_show_content = $('#popular_show_content');
      /**
       * динамический контент
       */
      const dinamic_show_content = $('#dinamic_content');
      const dinamic_head = $('#dinamic_head');
      const dinamic_inner_content = $('#dinamic_content_inner');
      /**
       * поиск
       */
      const search_input = $('#search_input');
      const search_btn = $('#search_btn');
      /**
       *  вход в систему и модальное окно входа в систему
       */
      const user_modal = $('#user_modal');
      const user_open_modal_btn = $('#user_open_modal_btn');
      const user_signin_form = $('#user_signin_form');
      const username_input = $('#username_input');
      const password_input = $('#password_input');
      const username_checker = $('#username_checker');
      const password_checker = $('#password_checker');
      const loginModal = $('#loginModal');
      const user_open_modal_reg = $('#user_open_modal_reg');

      $(document).ready(function () {

         /**
          * обработчик
          * проверка корректности отпавленной формы
          */
         $(user_signin_form).on('submit', function (e) {
            username_checker.html('');
            password_checker.html('');
            let username = username_input.val();
            let password = password_input.val();
            if (username === "" || username === " ") {
               username_checker.html('Поле username не должно быть пустым');
               e.preventDefault();
            } else if (password === "" || password === " ") {
               password_checker.html('Поле password не должно быть пустым')
               e.preventDefault();
            }
         })

         /**
          * обработчик
          * открытие модального окна входа в систему
          */
         $(user_open_modal_btn).on('click', function (e) {
            e.preventDefault();
            user_modal.modal('show');
         })
         $(user_open_modal_reg).on('click', function (e) {
            e.preventDefault();
            loginModal.modal('show');
         })

         /**
          * обработчик
          * обработка поиска
          */
         $(search_btn).on('click', function (e) {
            e.preventDefault();
            toggleClassesContent($(this));
            toggleClassesNavBar(null);
            let valueSearch = search_input.val();
            search_input.val('');

            /**
             * обрабочтик
             * проверка на пустое значение поиска
             */
            if (valueSearch === '') {
               dinamic_head.html('');
               dinamic_head.html('Все товары')
            } else {
               dinamic_head.html('');
               dinamic_head.html('Результат запроса "' + valueSearch + '"');
            }
         })

         /**
          * обработчик
          * обработчик на кнопке "популярное" в навбар
          */
         $(popular_show_btn).on('click', function (e) {
            e.preventDefault();
            toggleClassesContent($(this));
            toggleClassesNavBar($(this));
         })

         /**
          * обработчик
          * обработчик на все кнопки в навбар кроме "популярное"
          */
         $('.link-dark').on('click', function (e) {
            e.preventDefault();
            /**
             * переключение стилей кнопок навбара и контейнера с контентом
             */
            toggleClassesContent($(this));
            toggleClassesNavBar($(this));

            /**
             * перезапись категории в заголовок
             */
            let category = $(this).html();
            dinamic_head.html("");
            dinamic_head.html(category);
            /** перезапись динамического контента
             *  товары по категории
             */
            searchByCategory($(this));
         })


      })

      /**
       * отправляет GET запрос на /home/category/id = категории
       * генерирует html из массива итемов на странице
       */
      async function searchByCategory(e) {
         const categoryId = $(e).attr("id");
         const response = await fetch("/category/" + categoryId);
         if (response.ok) {
            let items = await response.json();
            /**
             * Добавляем итемы по категориям на страницу
             * */
            let itemsByCategoryHTML = "";
            for (let i = 0; i < items.length; i++) {
               itemsByCategoryHTML += '<div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">\n' +
                  '                       <img src="' + items[i].images[0] + '" class="card-img-top" alt="popular_item" style="height: 180px;">' +
                  '                           <div class="card-body">\n' +
                  '                                <h5 class="card-title">' + items[i].name + '</h5>' +
                  '                                <p class="card-text">' + items[i].description + '</p>' +
                  '                                <div class="d-flex">\n' +
                  '                                    <a href="#" class="btn btn-danger" style="width: 150px;">В корзину</a>' +
                  '                                    <a href="/product/' + items[i].id + '" class="btn btn-primary" style="margin-left: 10px;">Смотреть</a>' +
                  '                                </div>' +
                  '                           </div>' +
                  '                   </div>';
            }
            dinamic_inner_content.html("");
            dinamic_inner_content.html(itemsByCategoryHTML);
         }
      }

      /**
       * функция переключения классов контейнера с контентом
       */
      function toggleClassesContent(e) {
         if ($(e).is(popular_show_btn)) {
            popular_show_content.addClass('show');
            dinamic_show_content.removeClass('show');
            dinamic_inner_content.html("");
         } else {
            popular_show_content.removeClass('show');
            dinamic_show_content.addClass('show');
         }
      }

      /**
       * функция переключения кнопок в навбар
       */
      function toggleClassesNavBar(e) {
         $('.active').removeClass('active').addClass('link-dark');
         $(e).removeClass('link-dark');
         $(e).addClass('active');
      }

      async function addCartItem(itemId, shopId) {
         // let quant = document.getElementById("itemQuant").value;
         let url = new URL("http://localhost:8888/api/cart/add")
         const response = await fetch(url, {
            method: 'POST',
            headers: {
               "Accept": "application/json",
               "Content-Type": "application/json; charset=utf-8",
            },
            body: JSON.stringify({
               quantity: 1,
               item: {
                  id: itemId
               },
               shop: {
                  id: shopId
               },
            })
         })
      }

      $(async function () {
         await favoriteItem()
      })

      async function favoriteItem() {
         let items = document.getElementsByName("favItems")
         for (let i = 0; i < items.length; i++) {
            let itemDivID = items[i].id;
            let itemId = itemDivID.substr(itemDivID.indexOf("m") + 1, itemDivID.length - itemDivID.indexOf("m") + 1)
            await favoriteButtonItem(itemId);
         }
      }

   </script>
   <script type="text/javascript" src="/js/favoriteHome.js"></script>
   <script type="text/javascript" src="js/registration.js"></script>
   <script type="text/javascript" src="js/signin.js"></script>
   <script type="text/javascript" src="js/twoFactorAuth.js"></script>
</body>
</html>
], template might not exist or might not be accessible by any of the configured Template Resolvers
	at org.thymeleaf.engine.TemplateManager.resolveTemplate(TemplateManager.java:869)
	at org.thymeleaf.engine.TemplateManager.parseAndProcess(TemplateManager.java:607)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1098)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1072)
	at org.thymeleaf.spring5.view.ThymeleafView.renderFragment(ThymeleafView.java:366)
	at org.thymeleaf.spring5.view.ThymeleafView.render(ThymeleafView.java:190)
	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1397)
	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1142)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1081)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:655)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:327)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:121)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:115)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:105)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:218)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:212)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:110)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:80)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:211)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:183)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:358)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:271)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:94)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1726)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:829)
2021-11-03 13:41:11,509 ERROR org.thymeleaf.TemplateEngine [http-nio-80-exec-5] [THYMELEAF][http-nio-80-exec-5] Exception processing template "<!DOCTYPE html>
 <html>
 <head>
   [...]t type="text/javascript" src="js/twoFactorAuth.js"></script>
 </body>
 </html>
 ": Error resolving template [<!DOCTYPE html>
<html>
<head>
   <meta charset="UTF-8">
   <title>Главная</title>
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
         integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

   <!-- Не переносите подтягивание jQuery вниз файла, иначе он не сможет его прочитать в header-е, который встраивается
        в начало этой странице -->
   <script src="https://code.jquery.com/jquery-3.6.0.min.js"
           integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
</head>
<body>
   
   
   <!-- модалка для входа юзеру -->
   <div class="modal fade" id="user_modal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
         <div class="modal-content">
            <div class="modal-header">
               <h5 class="modal-title">Войдите в систему</h5>
               <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="user_signin_form" action="/login" method="post">
               <div class="modal-body">
                  <div class="mb-3">
                     <label for="username_input" class="form-label">Введите email:</label>
                     <input id="username_input" type="text" name="j_username" class="form-control"
                            placeholder="Username">
                     <div id="username_checker" class="form-text" style="color:#a40000;"></div>
                  </div>
                  <div class="mb-3">
                     <label for="password_input" class="form-label">Введите пароль:</label>
                     <input id="password_input" type="password" name="j_password" class="form-control"
                            placeholder="Password">
                     <div id="password_checker" class="form-text" style="color:#a40000;"></div>
                  </div>
                  <div class="mb-3">
                     <label for="verification_code_input" class="form-label">
                        Введите код с телефона (если используете 2FA):
                     </label>
                     <input id="verification_code_input" type="text" name="code" class="form-control"
                            placeholder="Verification code">
                  </div>
                  <div class="form-check">
                     <input class="form-check-input" type="checkbox" name="remember-me" id="flexCheckChecked"
                            checked>
                     <label class="form-check-label" for="flexCheckChecked">
                        Запомнить пароль
                     </label>
                  </div>
                  <br>
                  <p align="center">или войдите с помощью:</p>
                  <div class="form-group" align="center">
                     <div class="col-md-3">
                        <a class="btn btn-outline-dark" href="/oauth2/authorization/google" role="button"
                           style="text-transform:none">
                           <img width="20px" style="margin-bottom:3px; margin-right:10px; margin-left:30px"
                                src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/53/Google_%22G%22_Logo.svg/512px-Google_%22G%22_Logo.svg.png"/>
                           Login with google
                        </a>
                     </div>
                  </div>
                  <div class="form-group" align="center">
                     <div class="col-md-3">
                        <a class="btn btn-outline-dark" href="/oauth2/authorization/github" role="button"
                           style="text-transform:none" w>
                           <img width="20px" style="margin-bottom:3px; margin-right:10px; margin-left:30px"
                                src="https://wodensoft.co.uk/wp-content/uploads/2020/05/Github.png"/>
                           Login with github
                        </a>
                     </div>
                  </div>
                  <hr>
                  <p align="center">если вы у нас впервые:</p>
               </div>

               <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Отмена</button>
                  <button type="button" id="user_signin_btn" class="btn btn-primary"
                          onclick="{event.preventDefault(); signin()}">
                     Войти
                  </button>
               </div>
            </form>
         </div>
      </div>
   </div>

   <!-- Модалка для регистрации -->
   <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
         <div class="modal-content" style="width:750px;">
            <div class="modal-body">
               <div class="box">
                  <div class="form loginBox">
                     <b></b>
                     <b></b>

                     <form>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="usernameSave">Имя пользователя</label>
                              <input class="form-control" type="text" value="" id="usernameSave" required
                                     minlength="4"
                                     placeholder="Введите имя пользователя">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="emailSave">Адрес электронной почты</label>
                              <input class="form-control" type="email" value="" id="emailSave"
                                     pattern="^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}"
                                     title="в формате user@example.com" required
                                     placeholder="Введите адрес электронной почты">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="passwordSave">Пароль</label>
                              <input class="form-control" type="password" value="" id="passwordSave" required
                                     minlength="6"
                                     placeholder="Введите пароль">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="phoneSave">Номер телефона</label>
                              <input class="form-control" type="text" value="" id="phoneSave" required
                                     minlength="11" pattern="[0-9]+"
                                     title="указать цифрами" placeholder="Введите номер телефона">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="first_nameSave">Имя</label>
                              <input class="form-control" type="text" value="" id="first_nameSave"
                                     placeholder="Введите имя">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="last_nameSave">Фамилия</label>
                              <input class="form-control" type="text" value="" id="last_nameSave"
                                     placeholder="Введите фамилию">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="ageSave">Возраст</label>
                              <input class="form-control" type="number" value="" id="ageSave"
                                     placeholder="Введите возраст">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-2">
                              <label class="form-label" for="countrySave">Страна</label>
                              <input class="form-control" type="text" value="" id="countrySave"
                                     placeholder="Введите страну">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="citySave">Город</label>
                              <input class="form-control" type="text" value="" id="citySave"
                                     placeholder="Введите город">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="cityIndexSave">Индекс города</label>
                              <input class="form-control" type="text" value="" id="cityIndexSave"
                                     placeholder="Введите индекс города">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-2">
                              <label class="form-label" for="streetSave">Улица</label>
                              <input class="form-control" type="text" value="" id="streetSave"
                                     placeholder="Введите улицу">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="houseSave">Номер дома</label>
                              <input class="form-control" type="text" value="" id="houseSave"
                                     placeholder="Введите номер дома">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="birthdaySave">Дата рождения</label>
                              <input class="form-control" type="date" value="" id="birthdaySave">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="genderSave">Выберите пол:</label>
                              <br>
                              <select class="form-select" size="3" id="genderSave" name="gender" required="">
                                 <option id="ManSave" value="MALE">Мужчина</option>
                                 <option id="WomanSave" value="FEMALE">Женщина</option>
                                 <option id="NoGenderSave" value="UNKNOWN">Не определен</option>
                              </select>
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <input type="button" class="btn btn-primary" value="Зарегистрироваться"
                                     onclick="{event.preventDefault(); saveUser()}"/>
                           </div>
                        </div>
                     </form>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>

   <!--HEADER-->
   <div>
      <!--HEADER-->
      <header class="bg-dark text-white" style="height: 44px;">
         <div class="container" style="height: 44px;">
            <div class="d-flex align-items-center justify-content-center justify-content-lg-start"
                 style="height: 44px;">
               <a href="/" class="d-flex align-items-center mb-lg-0 text-white text-decoration-none">
                  <h5 style="margin: 0;">LOGO</h5>
               </a>
               <!--NavBar(HEADER)-->
               <ul class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0 ms-5">
                  <li><a href="/shops" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Магазины</font></font></a></li>
                  <li><a href="#" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Товары</font></font></a></li>
                  <li></li>
                  <li><a href="#" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Ещё...</font></font></a></li>
                  <li></li>
                  <li></li>
               </ul>




               <div class="text-end">


                  <button type="button" id="user_open_modal_btn"
                          class="btn btn-outline-light me-2">Войти
                  </button>
                  <button type="button" id="user_open_modal_reg" class="btn btn-warning">
                     Зарегистрироваться
                  </button>

                  <script>
                     $(document).ready(function () {
                        if (window.location.href !== 'http://localhost:8888/') {
                           $('#user_open_modal_btn').hide();
                        }
                     })
                     $(document).ready(function () {
                        if (window.location.href !== 'http://localhost:8888/') {
                           $('#user_open_modal_reg').hide();
                        }
                     })
                  </script>

                  <!--ссылка и информация пользователя при аутентификации-->
                  
               </div>
            </div>
         </div>
         <nav class="navbar fixed-bottom navbar-light bg-light">
            <a class="navbar-brand" href="/feedback">Обратная связь</a>
         </nav>
      </header>
   </div>

   <!--Main zone-->
   <section class="d-flex">
      <!--Sidebar-->
      <div class="bg-light" style="width: 350px; min-height: 100vh; padding-top: 30px; padding-bottom: 200px">
         <div class="container-fluid">
            <div class="row">
               <div class="col-12 d-flex align-items-center">
                  <h5>Категории</h5>
               </div>

               <div class="col-12 d-flex justify-content-center">
                  <hr style="width: 100%; margin: 0;">
               </div>
               <!--Категории-->
               <div class="col-12 mt-4">
                  <ul class="nav nav-pills flex-column mb-auto">
                     <li class="nav-item">
                        <a id="popular_show_btn" href="#" class="nav-link active" aria-current="page">
                           Популярное
                           </font></font></a>
                     </li>

                     
                        <li class="nav-item">
                           <a id="9" href="#"
                              class="nav-link link-dark" aria-current="page">Автомобили</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="3" href="#"
                              class="nav-link link-dark" aria-current="page">Аксессуары</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="5" href="#"
                              class="nav-link link-dark" aria-current="page">Бытовая техника</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="6" href="#"
                              class="nav-link link-dark" aria-current="page">Детские товары</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="7" href="#"
                              class="nav-link link-dark" aria-current="page">Компьютеры</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="4" href="#"
                              class="nav-link link-dark" aria-current="page">Мебель</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="8" href="#"
                              class="nav-link link-dark" aria-current="page">Мобильные телефоны</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="2" href="#"
                              class="nav-link link-dark" aria-current="page">Обувь</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="1" href="#"
                              class="nav-link link-dark" aria-current="page">Одежда</a>
                        </li>
                     
                  </ul>
               </div>
            </div>
         </div>
      </div>

      <!--Main Body-->
      <div class="container-fluid" style="padding-top: 30px; padding-left: 35px; padding-bottom: 40px;">
         <div class="row">
            <div class="col-12">
               <form style="width: 650px;" class="d-flex">
                  <input id="search_input" type="search" class="form-control" name="search"
                         placeholder="Поиск по наименованию:">
                  <button id="search_btn" type="button" class="btn btn-success" style="width: 150px;">Поиск</button>
               </form>
            </div>

            <!-- QR and enable 2FA -->
            

         <!--Контейнер для динамического контента (js)-->
         <div class="collapse" id="dinamic_content">
            <div class="col-12" style="margin-top: 30px;">
               <h4 id="dinamic_head"></h4>
            </div>
            <!--сюда генерируются товары-->
            <div class="col-12 d-flex flex-wrap mt-3" id="dinamic_content_inner">

               </div>
            </div>

            <!--Контейнер для статического контента (при загрузке страницы)-->
            <div class="collapse show" id="popular_show_content">
               <div class="col-12" style="margin-top: 30px;">
                  <h4>
                     Популярные товары
                  </h4>
               </div>
               <!--Блок популярные товары-->
               <div class="col-12 d-flex flex-wrap mt-3">
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://pe-shop.ru/pictures/product/big/6045_big.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Антисептик для рук</h5>
                           <p class="card-text">Антисептик для рук</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;5&#39;,&#39;1&#39;)">В корзину</a>
                              <a href="/product/5" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton5">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem5"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.ikea.com/ru/ru/images/products/klappa-myagkaya-igrushka-myach-raznocvetnyy__0873096_pe682670_s5.jpg?f=xxs" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Мягкая игрушка</h5>
                           <p class="card-text">Мягкая игрушка</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;10&#39;,&#39;2&#39;)">В корзину</a>
                              <a href="/product/10" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton10">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem10"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.ikea.com/ru/ru/images/products/gulligast-gulligest-mobil__0923957_pe788456_s5.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Мобиль</h5>
                           <p class="card-text">Мобиль</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;11&#39;,&#39;3&#39;)">В корзину</a>
                              <a href="/product/11" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton11">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem11"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.opticmall.ru/assets/images/products/3908/2132-622-17.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Очки RAY BAN</h5>
                           <p class="card-text">Очки RAY BAN</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;4&#39;,&#39;2&#39;)">В корзину</a>
                              <a href="/product/4" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton4">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem4"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://cdn.rbt.ru/images/gen/item_image/image/8507/23/850668_r7634.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Ноутбук Lenovo</h5>
                           <p class="card-text">Ноутбук Lenovo</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;7&#39;,&#39;4&#39;)">В корзину</a>
                              <a href="/product/7" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton7">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem7"></div>
                        </div>
                     </div>
                  

               </div>
               <!--Блок популярные магазины-->
               <div class="col-12" style="margin-top: 30px;">
                  <h4>
                     Популярные магазины
                  </h4>
               </div>

               <div class="col-12 d-flex flex-wrap mt-3">
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/beru.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Яндекс Маркет</h5>
                           <p class="card-text">Одежда, обувь, бытовая техника</p>
                           <a href="/showcase/1" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/lamoda.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Lamoda</h5>
                           <p class="card-text">Одежда, обувь, аксессуары</p>
                           <a href="/showcase/2" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/aliexpress.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">AliExpress</h5>
                           <p class="card-text">Любые товары</p>
                           <a href="/showcase/4" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
               </div>
            </div>

         </div>
      </div>
   </section>

   <script src="https://code.jquery.com/jquery-3.6.0.min.js"
           integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

   <!-- JavaScript Bundle with Popper -->
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
           integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
           crossorigin="anonymous"></script>
   <script>
      /**
       * связано с статическим контентом
       */
      const popular_show_btn = $('#popular_show_btn');
      const popular_show_content = $('#popular_show_content');
      /**
       * динамический контент
       */
      const dinamic_show_content = $('#dinamic_content');
      const dinamic_head = $('#dinamic_head');
      const dinamic_inner_content = $('#dinamic_content_inner');
      /**
       * поиск
       */
      const search_input = $('#search_input');
      const search_btn = $('#search_btn');
      /**
       *  вход в систему и модальное окно входа в систему
       */
      const user_modal = $('#user_modal');
      const user_open_modal_btn = $('#user_open_modal_btn');
      const user_signin_form = $('#user_signin_form');
      const username_input = $('#username_input');
      const password_input = $('#password_input');
      const username_checker = $('#username_checker');
      const password_checker = $('#password_checker');
      const loginModal = $('#loginModal');
      const user_open_modal_reg = $('#user_open_modal_reg');

      $(document).ready(function () {

         /**
          * обработчик
          * проверка корректности отпавленной формы
          */
         $(user_signin_form).on('submit', function (e) {
            username_checker.html('');
            password_checker.html('');
            let username = username_input.val();
            let password = password_input.val();
            if (username === "" || username === " ") {
               username_checker.html('Поле username не должно быть пустым');
               e.preventDefault();
            } else if (password === "" || password === " ") {
               password_checker.html('Поле password не должно быть пустым')
               e.preventDefault();
            }
         })

         /**
          * обработчик
          * открытие модального окна входа в систему
          */
         $(user_open_modal_btn).on('click', function (e) {
            e.preventDefault();
            user_modal.modal('show');
         })
         $(user_open_modal_reg).on('click', function (e) {
            e.preventDefault();
            loginModal.modal('show');
         })

         /**
          * обработчик
          * обработка поиска
          */
         $(search_btn).on('click', function (e) {
            e.preventDefault();
            toggleClassesContent($(this));
            toggleClassesNavBar(null);
            let valueSearch = search_input.val();
            search_input.val('');

            /**
             * обрабочтик
             * проверка на пустое значение поиска
             */
            if (valueSearch === '') {
               dinamic_head.html('');
               dinamic_head.html('Все товары')
            } else {
               dinamic_head.html('');
               dinamic_head.html('Результат запроса "' + valueSearch + '"');
            }
         })

         /**
          * обработчик
          * обработчик на кнопке "популярное" в навбар
          */
         $(popular_show_btn).on('click', function (e) {
            e.preventDefault();
            toggleClassesContent($(this));
            toggleClassesNavBar($(this));
         })

         /**
          * обработчик
          * обработчик на все кнопки в навбар кроме "популярное"
          */
         $('.link-dark').on('click', function (e) {
            e.preventDefault();
            /**
             * переключение стилей кнопок навбара и контейнера с контентом
             */
            toggleClassesContent($(this));
            toggleClassesNavBar($(this));

            /**
             * перезапись категории в заголовок
             */
            let category = $(this).html();
            dinamic_head.html("");
            dinamic_head.html(category);
            /** перезапись динамического контента
             *  товары по категории
             */
            searchByCategory($(this));
         })


      })

      /**
       * отправляет GET запрос на /home/category/id = категории
       * генерирует html из массива итемов на странице
       */
      async function searchByCategory(e) {
         const categoryId = $(e).attr("id");
         const response = await fetch("/category/" + categoryId);
         if (response.ok) {
            let items = await response.json();
            /**
             * Добавляем итемы по категориям на страницу
             * */
            let itemsByCategoryHTML = "";
            for (let i = 0; i < items.length; i++) {
               itemsByCategoryHTML += '<div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">\n' +
                  '                       <img src="' + items[i].images[0] + '" class="card-img-top" alt="popular_item" style="height: 180px;">' +
                  '                           <div class="card-body">\n' +
                  '                                <h5 class="card-title">' + items[i].name + '</h5>' +
                  '                                <p class="card-text">' + items[i].description + '</p>' +
                  '                                <div class="d-flex">\n' +
                  '                                    <a href="#" class="btn btn-danger" style="width: 150px;">В корзину</a>' +
                  '                                    <a href="/product/' + items[i].id + '" class="btn btn-primary" style="margin-left: 10px;">Смотреть</a>' +
                  '                                </div>' +
                  '                           </div>' +
                  '                   </div>';
            }
            dinamic_inner_content.html("");
            dinamic_inner_content.html(itemsByCategoryHTML);
         }
      }

      /**
       * функция переключения классов контейнера с контентом
       */
      function toggleClassesContent(e) {
         if ($(e).is(popular_show_btn)) {
            popular_show_content.addClass('show');
            dinamic_show_content.removeClass('show');
            dinamic_inner_content.html("");
         } else {
            popular_show_content.removeClass('show');
            dinamic_show_content.addClass('show');
         }
      }

      /**
       * функция переключения кнопок в навбар
       */
      function toggleClassesNavBar(e) {
         $('.active').removeClass('active').addClass('link-dark');
         $(e).removeClass('link-dark');
         $(e).addClass('active');
      }

      async function addCartItem(itemId, shopId) {
         // let quant = document.getElementById("itemQuant").value;
         let url = new URL("http://localhost:8888/api/cart/add")
         const response = await fetch(url, {
            method: 'POST',
            headers: {
               "Accept": "application/json",
               "Content-Type": "application/json; charset=utf-8",
            },
            body: JSON.stringify({
               quantity: 1,
               item: {
                  id: itemId
               },
               shop: {
                  id: shopId
               },
            })
         })
      }

      $(async function () {
         await favoriteItem()
      })

      async function favoriteItem() {
         let items = document.getElementsByName("favItems")
         for (let i = 0; i < items.length; i++) {
            let itemDivID = items[i].id;
            let itemId = itemDivID.substr(itemDivID.indexOf("m") + 1, itemDivID.length - itemDivID.indexOf("m") + 1)
            await favoriteButtonItem(itemId);
         }
      }

   </script>
   <script type="text/javascript" src="/js/favoriteHome.js"></script>
   <script type="text/javascript" src="js/registration.js"></script>
   <script type="text/javascript" src="js/signin.js"></script>
   <script type="text/javascript" src="js/twoFactorAuth.js"></script>
</body>
</html>
], template might not exist or might not be accessible by any of the configured Template Resolvers
org.thymeleaf.exceptions.TemplateInputException: Error resolving template [<!DOCTYPE html>
<html>
<head>
   <meta charset="UTF-8">
   <title>Главная</title>
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
         integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

   <!-- Не переносите подтягивание jQuery вниз файла, иначе он не сможет его прочитать в header-е, который встраивается
        в начало этой странице -->
   <script src="https://code.jquery.com/jquery-3.6.0.min.js"
           integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
</head>
<body>
   
   
   <!-- модалка для входа юзеру -->
   <div class="modal fade" id="user_modal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
         <div class="modal-content">
            <div class="modal-header">
               <h5 class="modal-title">Войдите в систему</h5>
               <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="user_signin_form" action="/login" method="post">
               <div class="modal-body">
                  <div class="mb-3">
                     <label for="username_input" class="form-label">Введите email:</label>
                     <input id="username_input" type="text" name="j_username" class="form-control"
                            placeholder="Username">
                     <div id="username_checker" class="form-text" style="color:#a40000;"></div>
                  </div>
                  <div class="mb-3">
                     <label for="password_input" class="form-label">Введите пароль:</label>
                     <input id="password_input" type="password" name="j_password" class="form-control"
                            placeholder="Password">
                     <div id="password_checker" class="form-text" style="color:#a40000;"></div>
                  </div>
                  <div class="mb-3">
                     <label for="verification_code_input" class="form-label">
                        Введите код с телефона (если используете 2FA):
                     </label>
                     <input id="verification_code_input" type="text" name="code" class="form-control"
                            placeholder="Verification code">
                  </div>
                  <div class="form-check">
                     <input class="form-check-input" type="checkbox" name="remember-me" id="flexCheckChecked"
                            checked>
                     <label class="form-check-label" for="flexCheckChecked">
                        Запомнить пароль
                     </label>
                  </div>
                  <br>
                  <p align="center">или войдите с помощью:</p>
                  <div class="form-group" align="center">
                     <div class="col-md-3">
                        <a class="btn btn-outline-dark" href="/oauth2/authorization/google" role="button"
                           style="text-transform:none">
                           <img width="20px" style="margin-bottom:3px; margin-right:10px; margin-left:30px"
                                src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/53/Google_%22G%22_Logo.svg/512px-Google_%22G%22_Logo.svg.png"/>
                           Login with google
                        </a>
                     </div>
                  </div>
                  <div class="form-group" align="center">
                     <div class="col-md-3">
                        <a class="btn btn-outline-dark" href="/oauth2/authorization/github" role="button"
                           style="text-transform:none" w>
                           <img width="20px" style="margin-bottom:3px; margin-right:10px; margin-left:30px"
                                src="https://wodensoft.co.uk/wp-content/uploads/2020/05/Github.png"/>
                           Login with github
                        </a>
                     </div>
                  </div>
                  <hr>
                  <p align="center">если вы у нас впервые:</p>
               </div>

               <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Отмена</button>
                  <button type="button" id="user_signin_btn" class="btn btn-primary"
                          onclick="{event.preventDefault(); signin()}">
                     Войти
                  </button>
               </div>
            </form>
         </div>
      </div>
   </div>

   <!-- Модалка для регистрации -->
   <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
         <div class="modal-content" style="width:750px;">
            <div class="modal-body">
               <div class="box">
                  <div class="form loginBox">
                     <b></b>
                     <b></b>

                     <form>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="usernameSave">Имя пользователя</label>
                              <input class="form-control" type="text" value="" id="usernameSave" required
                                     minlength="4"
                                     placeholder="Введите имя пользователя">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="emailSave">Адрес электронной почты</label>
                              <input class="form-control" type="email" value="" id="emailSave"
                                     pattern="^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}"
                                     title="в формате user@example.com" required
                                     placeholder="Введите адрес электронной почты">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="passwordSave">Пароль</label>
                              <input class="form-control" type="password" value="" id="passwordSave" required
                                     minlength="6"
                                     placeholder="Введите пароль">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="phoneSave">Номер телефона</label>
                              <input class="form-control" type="text" value="" id="phoneSave" required
                                     minlength="11" pattern="[0-9]+"
                                     title="указать цифрами" placeholder="Введите номер телефона">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="first_nameSave">Имя</label>
                              <input class="form-control" type="text" value="" id="first_nameSave"
                                     placeholder="Введите имя">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="last_nameSave">Фамилия</label>
                              <input class="form-control" type="text" value="" id="last_nameSave"
                                     placeholder="Введите фамилию">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="ageSave">Возраст</label>
                              <input class="form-control" type="number" value="" id="ageSave"
                                     placeholder="Введите возраст">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-2">
                              <label class="form-label" for="countrySave">Страна</label>
                              <input class="form-control" type="text" value="" id="countrySave"
                                     placeholder="Введите страну">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="citySave">Город</label>
                              <input class="form-control" type="text" value="" id="citySave"
                                     placeholder="Введите город">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="cityIndexSave">Индекс города</label>
                              <input class="form-control" type="text" value="" id="cityIndexSave"
                                     placeholder="Введите индекс города">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-2">
                              <label class="form-label" for="streetSave">Улица</label>
                              <input class="form-control" type="text" value="" id="streetSave"
                                     placeholder="Введите улицу">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="houseSave">Номер дома</label>
                              <input class="form-control" type="text" value="" id="houseSave"
                                     placeholder="Введите номер дома">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="birthdaySave">Дата рождения</label>
                              <input class="form-control" type="date" value="" id="birthdaySave">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="genderSave">Выберите пол:</label>
                              <br>
                              <select class="form-select" size="3" id="genderSave" name="gender" required="">
                                 <option id="ManSave" value="MALE">Мужчина</option>
                                 <option id="WomanSave" value="FEMALE">Женщина</option>
                                 <option id="NoGenderSave" value="UNKNOWN">Не определен</option>
                              </select>
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <input type="button" class="btn btn-primary" value="Зарегистрироваться"
                                     onclick="{event.preventDefault(); saveUser()}"/>
                           </div>
                        </div>
                     </form>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>

   <!--HEADER-->
   <div>
      <!--HEADER-->
      <header class="bg-dark text-white" style="height: 44px;">
         <div class="container" style="height: 44px;">
            <div class="d-flex align-items-center justify-content-center justify-content-lg-start"
                 style="height: 44px;">
               <a href="/" class="d-flex align-items-center mb-lg-0 text-white text-decoration-none">
                  <h5 style="margin: 0;">LOGO</h5>
               </a>
               <!--NavBar(HEADER)-->
               <ul class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0 ms-5">
                  <li><a href="/shops" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Магазины</font></font></a></li>
                  <li><a href="#" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Товары</font></font></a></li>
                  <li></li>
                  <li><a href="#" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Ещё...</font></font></a></li>
                  <li></li>
                  <li></li>
               </ul>




               <div class="text-end">


                  <button type="button" id="user_open_modal_btn"
                          class="btn btn-outline-light me-2">Войти
                  </button>
                  <button type="button" id="user_open_modal_reg" class="btn btn-warning">
                     Зарегистрироваться
                  </button>

                  <script>
                     $(document).ready(function () {
                        if (window.location.href !== 'http://localhost:8888/') {
                           $('#user_open_modal_btn').hide();
                        }
                     })
                     $(document).ready(function () {
                        if (window.location.href !== 'http://localhost:8888/') {
                           $('#user_open_modal_reg').hide();
                        }
                     })
                  </script>

                  <!--ссылка и информация пользователя при аутентификации-->
                  
               </div>
            </div>
         </div>
         <nav class="navbar fixed-bottom navbar-light bg-light">
            <a class="navbar-brand" href="/feedback">Обратная связь</a>
         </nav>
      </header>
   </div>

   <!--Main zone-->
   <section class="d-flex">
      <!--Sidebar-->
      <div class="bg-light" style="width: 350px; min-height: 100vh; padding-top: 30px; padding-bottom: 200px">
         <div class="container-fluid">
            <div class="row">
               <div class="col-12 d-flex align-items-center">
                  <h5>Категории</h5>
               </div>

               <div class="col-12 d-flex justify-content-center">
                  <hr style="width: 100%; margin: 0;">
               </div>
               <!--Категории-->
               <div class="col-12 mt-4">
                  <ul class="nav nav-pills flex-column mb-auto">
                     <li class="nav-item">
                        <a id="popular_show_btn" href="#" class="nav-link active" aria-current="page">
                           Популярное
                           </font></font></a>
                     </li>

                     
                        <li class="nav-item">
                           <a id="9" href="#"
                              class="nav-link link-dark" aria-current="page">Автомобили</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="3" href="#"
                              class="nav-link link-dark" aria-current="page">Аксессуары</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="5" href="#"
                              class="nav-link link-dark" aria-current="page">Бытовая техника</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="6" href="#"
                              class="nav-link link-dark" aria-current="page">Детские товары</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="7" href="#"
                              class="nav-link link-dark" aria-current="page">Компьютеры</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="4" href="#"
                              class="nav-link link-dark" aria-current="page">Мебель</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="8" href="#"
                              class="nav-link link-dark" aria-current="page">Мобильные телефоны</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="2" href="#"
                              class="nav-link link-dark" aria-current="page">Обувь</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="1" href="#"
                              class="nav-link link-dark" aria-current="page">Одежда</a>
                        </li>
                     
                  </ul>
               </div>
            </div>
         </div>
      </div>

      <!--Main Body-->
      <div class="container-fluid" style="padding-top: 30px; padding-left: 35px; padding-bottom: 40px;">
         <div class="row">
            <div class="col-12">
               <form style="width: 650px;" class="d-flex">
                  <input id="search_input" type="search" class="form-control" name="search"
                         placeholder="Поиск по наименованию:">
                  <button id="search_btn" type="button" class="btn btn-success" style="width: 150px;">Поиск</button>
               </form>
            </div>

            <!-- QR and enable 2FA -->
            

         <!--Контейнер для динамического контента (js)-->
         <div class="collapse" id="dinamic_content">
            <div class="col-12" style="margin-top: 30px;">
               <h4 id="dinamic_head"></h4>
            </div>
            <!--сюда генерируются товары-->
            <div class="col-12 d-flex flex-wrap mt-3" id="dinamic_content_inner">

               </div>
            </div>

            <!--Контейнер для статического контента (при загрузке страницы)-->
            <div class="collapse show" id="popular_show_content">
               <div class="col-12" style="margin-top: 30px;">
                  <h4>
                     Популярные товары
                  </h4>
               </div>
               <!--Блок популярные товары-->
               <div class="col-12 d-flex flex-wrap mt-3">
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://pe-shop.ru/pictures/product/big/6045_big.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Антисептик для рук</h5>
                           <p class="card-text">Антисептик для рук</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;5&#39;,&#39;1&#39;)">В корзину</a>
                              <a href="/product/5" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton5">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem5"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.ikea.com/ru/ru/images/products/klappa-myagkaya-igrushka-myach-raznocvetnyy__0873096_pe682670_s5.jpg?f=xxs" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Мягкая игрушка</h5>
                           <p class="card-text">Мягкая игрушка</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;10&#39;,&#39;2&#39;)">В корзину</a>
                              <a href="/product/10" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton10">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem10"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.ikea.com/ru/ru/images/products/gulligast-gulligest-mobil__0923957_pe788456_s5.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Мобиль</h5>
                           <p class="card-text">Мобиль</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;11&#39;,&#39;3&#39;)">В корзину</a>
                              <a href="/product/11" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton11">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem11"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.opticmall.ru/assets/images/products/3908/2132-622-17.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Очки RAY BAN</h5>
                           <p class="card-text">Очки RAY BAN</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;4&#39;,&#39;2&#39;)">В корзину</a>
                              <a href="/product/4" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton4">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem4"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://cdn.rbt.ru/images/gen/item_image/image/8507/23/850668_r7634.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Ноутбук Lenovo</h5>
                           <p class="card-text">Ноутбук Lenovo</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;7&#39;,&#39;4&#39;)">В корзину</a>
                              <a href="/product/7" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton7">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem7"></div>
                        </div>
                     </div>
                  

               </div>
               <!--Блок популярные магазины-->
               <div class="col-12" style="margin-top: 30px;">
                  <h4>
                     Популярные магазины
                  </h4>
               </div>

               <div class="col-12 d-flex flex-wrap mt-3">
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/beru.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Яндекс Маркет</h5>
                           <p class="card-text">Одежда, обувь, бытовая техника</p>
                           <a href="/showcase/1" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/lamoda.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Lamoda</h5>
                           <p class="card-text">Одежда, обувь, аксессуары</p>
                           <a href="/showcase/2" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/aliexpress.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">AliExpress</h5>
                           <p class="card-text">Любые товары</p>
                           <a href="/showcase/4" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
               </div>
            </div>

         </div>
      </div>
   </section>

   <script src="https://code.jquery.com/jquery-3.6.0.min.js"
           integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

   <!-- JavaScript Bundle with Popper -->
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
           integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
           crossorigin="anonymous"></script>
   <script>
      /**
       * связано с статическим контентом
       */
      const popular_show_btn = $('#popular_show_btn');
      const popular_show_content = $('#popular_show_content');
      /**
       * динамический контент
       */
      const dinamic_show_content = $('#dinamic_content');
      const dinamic_head = $('#dinamic_head');
      const dinamic_inner_content = $('#dinamic_content_inner');
      /**
       * поиск
       */
      const search_input = $('#search_input');
      const search_btn = $('#search_btn');
      /**
       *  вход в систему и модальное окно входа в систему
       */
      const user_modal = $('#user_modal');
      const user_open_modal_btn = $('#user_open_modal_btn');
      const user_signin_form = $('#user_signin_form');
      const username_input = $('#username_input');
      const password_input = $('#password_input');
      const username_checker = $('#username_checker');
      const password_checker = $('#password_checker');
      const loginModal = $('#loginModal');
      const user_open_modal_reg = $('#user_open_modal_reg');

      $(document).ready(function () {

         /**
          * обработчик
          * проверка корректности отпавленной формы
          */
         $(user_signin_form).on('submit', function (e) {
            username_checker.html('');
            password_checker.html('');
            let username = username_input.val();
            let password = password_input.val();
            if (username === "" || username === " ") {
               username_checker.html('Поле username не должно быть пустым');
               e.preventDefault();
            } else if (password === "" || password === " ") {
               password_checker.html('Поле password не должно быть пустым')
               e.preventDefault();
            }
         })

         /**
          * обработчик
          * открытие модального окна входа в систему
          */
         $(user_open_modal_btn).on('click', function (e) {
            e.preventDefault();
            user_modal.modal('show');
         })
         $(user_open_modal_reg).on('click', function (e) {
            e.preventDefault();
            loginModal.modal('show');
         })

         /**
          * обработчик
          * обработка поиска
          */
         $(search_btn).on('click', function (e) {
            e.preventDefault();
            toggleClassesContent($(this));
            toggleClassesNavBar(null);
            let valueSearch = search_input.val();
            search_input.val('');

            /**
             * обрабочтик
             * проверка на пустое значение поиска
             */
            if (valueSearch === '') {
               dinamic_head.html('');
               dinamic_head.html('Все товары')
            } else {
               dinamic_head.html('');
               dinamic_head.html('Результат запроса "' + valueSearch + '"');
            }
         })

         /**
          * обработчик
          * обработчик на кнопке "популярное" в навбар
          */
         $(popular_show_btn).on('click', function (e) {
            e.preventDefault();
            toggleClassesContent($(this));
            toggleClassesNavBar($(this));
         })

         /**
          * обработчик
          * обработчик на все кнопки в навбар кроме "популярное"
          */
         $('.link-dark').on('click', function (e) {
            e.preventDefault();
            /**
             * переключение стилей кнопок навбара и контейнера с контентом
             */
            toggleClassesContent($(this));
            toggleClassesNavBar($(this));

            /**
             * перезапись категории в заголовок
             */
            let category = $(this).html();
            dinamic_head.html("");
            dinamic_head.html(category);
            /** перезапись динамического контента
             *  товары по категории
             */
            searchByCategory($(this));
         })


      })

      /**
       * отправляет GET запрос на /home/category/id = категории
       * генерирует html из массива итемов на странице
       */
      async function searchByCategory(e) {
         const categoryId = $(e).attr("id");
         const response = await fetch("/category/" + categoryId);
         if (response.ok) {
            let items = await response.json();
            /**
             * Добавляем итемы по категориям на страницу
             * */
            let itemsByCategoryHTML = "";
            for (let i = 0; i < items.length; i++) {
               itemsByCategoryHTML += '<div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">\n' +
                  '                       <img src="' + items[i].images[0] + '" class="card-img-top" alt="popular_item" style="height: 180px;">' +
                  '                           <div class="card-body">\n' +
                  '                                <h5 class="card-title">' + items[i].name + '</h5>' +
                  '                                <p class="card-text">' + items[i].description + '</p>' +
                  '                                <div class="d-flex">\n' +
                  '                                    <a href="#" class="btn btn-danger" style="width: 150px;">В корзину</a>' +
                  '                                    <a href="/product/' + items[i].id + '" class="btn btn-primary" style="margin-left: 10px;">Смотреть</a>' +
                  '                                </div>' +
                  '                           </div>' +
                  '                   </div>';
            }
            dinamic_inner_content.html("");
            dinamic_inner_content.html(itemsByCategoryHTML);
         }
      }

      /**
       * функция переключения классов контейнера с контентом
       */
      function toggleClassesContent(e) {
         if ($(e).is(popular_show_btn)) {
            popular_show_content.addClass('show');
            dinamic_show_content.removeClass('show');
            dinamic_inner_content.html("");
         } else {
            popular_show_content.removeClass('show');
            dinamic_show_content.addClass('show');
         }
      }

      /**
       * функция переключения кнопок в навбар
       */
      function toggleClassesNavBar(e) {
         $('.active').removeClass('active').addClass('link-dark');
         $(e).removeClass('link-dark');
         $(e).addClass('active');
      }

      async function addCartItem(itemId, shopId) {
         // let quant = document.getElementById("itemQuant").value;
         let url = new URL("http://localhost:8888/api/cart/add")
         const response = await fetch(url, {
            method: 'POST',
            headers: {
               "Accept": "application/json",
               "Content-Type": "application/json; charset=utf-8",
            },
            body: JSON.stringify({
               quantity: 1,
               item: {
                  id: itemId
               },
               shop: {
                  id: shopId
               },
            })
         })
      }

      $(async function () {
         await favoriteItem()
      })

      async function favoriteItem() {
         let items = document.getElementsByName("favItems")
         for (let i = 0; i < items.length; i++) {
            let itemDivID = items[i].id;
            let itemId = itemDivID.substr(itemDivID.indexOf("m") + 1, itemDivID.length - itemDivID.indexOf("m") + 1)
            await favoriteButtonItem(itemId);
         }
      }

   </script>
   <script type="text/javascript" src="/js/favoriteHome.js"></script>
   <script type="text/javascript" src="js/registration.js"></script>
   <script type="text/javascript" src="js/signin.js"></script>
   <script type="text/javascript" src="js/twoFactorAuth.js"></script>
</body>
</html>
], template might not exist or might not be accessible by any of the configured Template Resolvers
	at org.thymeleaf.engine.TemplateManager.resolveTemplate(TemplateManager.java:869)
	at org.thymeleaf.engine.TemplateManager.parseAndProcess(TemplateManager.java:607)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1098)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1072)
	at org.thymeleaf.spring5.view.ThymeleafView.renderFragment(ThymeleafView.java:366)
	at org.thymeleaf.spring5.view.ThymeleafView.render(ThymeleafView.java:190)
	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1397)
	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1142)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1081)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:655)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:327)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:121)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:115)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:105)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:218)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:212)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:110)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:80)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:211)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:183)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:358)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:271)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:94)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1726)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:829)
2021-11-03 13:41:11,513 ERROR org.apache.juli.logging.DirectJDKLog [http-nio-80-exec-5] Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is org.thymeleaf.exceptions.TemplateInputException: Error resolving template [<!DOCTYPE html>
<html>
<head>
   <meta charset="UTF-8">
   <title>Главная</title>
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
         integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

   <!-- Не переносите подтягивание jQuery вниз файла, иначе он не сможет его прочитать в header-е, который встраивается
        в начало этой странице -->
   <script src="https://code.jquery.com/jquery-3.6.0.min.js"
           integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
</head>
<body>
   
   
   <!-- модалка для входа юзеру -->
   <div class="modal fade" id="user_modal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
         <div class="modal-content">
            <div class="modal-header">
               <h5 class="modal-title">Войдите в систему</h5>
               <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="user_signin_form" action="/login" method="post">
               <div class="modal-body">
                  <div class="mb-3">
                     <label for="username_input" class="form-label">Введите email:</label>
                     <input id="username_input" type="text" name="j_username" class="form-control"
                            placeholder="Username">
                     <div id="username_checker" class="form-text" style="color:#a40000;"></div>
                  </div>
                  <div class="mb-3">
                     <label for="password_input" class="form-label">Введите пароль:</label>
                     <input id="password_input" type="password" name="j_password" class="form-control"
                            placeholder="Password">
                     <div id="password_checker" class="form-text" style="color:#a40000;"></div>
                  </div>
                  <div class="mb-3">
                     <label for="verification_code_input" class="form-label">
                        Введите код с телефона (если используете 2FA):
                     </label>
                     <input id="verification_code_input" type="text" name="code" class="form-control"
                            placeholder="Verification code">
                  </div>
                  <div class="form-check">
                     <input class="form-check-input" type="checkbox" name="remember-me" id="flexCheckChecked"
                            checked>
                     <label class="form-check-label" for="flexCheckChecked">
                        Запомнить пароль
                     </label>
                  </div>
                  <br>
                  <p align="center">или войдите с помощью:</p>
                  <div class="form-group" align="center">
                     <div class="col-md-3">
                        <a class="btn btn-outline-dark" href="/oauth2/authorization/google" role="button"
                           style="text-transform:none">
                           <img width="20px" style="margin-bottom:3px; margin-right:10px; margin-left:30px"
                                src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/53/Google_%22G%22_Logo.svg/512px-Google_%22G%22_Logo.svg.png"/>
                           Login with google
                        </a>
                     </div>
                  </div>
                  <div class="form-group" align="center">
                     <div class="col-md-3">
                        <a class="btn btn-outline-dark" href="/oauth2/authorization/github" role="button"
                           style="text-transform:none" w>
                           <img width="20px" style="margin-bottom:3px; margin-right:10px; margin-left:30px"
                                src="https://wodensoft.co.uk/wp-content/uploads/2020/05/Github.png"/>
                           Login with github
                        </a>
                     </div>
                  </div>
                  <hr>
                  <p align="center">если вы у нас впервые:</p>
               </div>

               <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Отмена</button>
                  <button type="button" id="user_signin_btn" class="btn btn-primary"
                          onclick="{event.preventDefault(); signin()}">
                     Войти
                  </button>
               </div>
            </form>
         </div>
      </div>
   </div>

   <!-- Модалка для регистрации -->
   <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
         <div class="modal-content" style="width:750px;">
            <div class="modal-body">
               <div class="box">
                  <div class="form loginBox">
                     <b></b>
                     <b></b>

                     <form>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="usernameSave">Имя пользователя</label>
                              <input class="form-control" type="text" value="" id="usernameSave" required
                                     minlength="4"
                                     placeholder="Введите имя пользователя">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="emailSave">Адрес электронной почты</label>
                              <input class="form-control" type="email" value="" id="emailSave"
                                     pattern="^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}"
                                     title="в формате user@example.com" required
                                     placeholder="Введите адрес электронной почты">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="passwordSave">Пароль</label>
                              <input class="form-control" type="password" value="" id="passwordSave" required
                                     minlength="6"
                                     placeholder="Введите пароль">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="phoneSave">Номер телефона</label>
                              <input class="form-control" type="text" value="" id="phoneSave" required
                                     minlength="11" pattern="[0-9]+"
                                     title="указать цифрами" placeholder="Введите номер телефона">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="first_nameSave">Имя</label>
                              <input class="form-control" type="text" value="" id="first_nameSave"
                                     placeholder="Введите имя">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="last_nameSave">Фамилия</label>
                              <input class="form-control" type="text" value="" id="last_nameSave"
                                     placeholder="Введите фамилию">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="ageSave">Возраст</label>
                              <input class="form-control" type="number" value="" id="ageSave"
                                     placeholder="Введите возраст">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-2">
                              <label class="form-label" for="countrySave">Страна</label>
                              <input class="form-control" type="text" value="" id="countrySave"
                                     placeholder="Введите страну">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="citySave">Город</label>
                              <input class="form-control" type="text" value="" id="citySave"
                                     placeholder="Введите город">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="cityIndexSave">Индекс города</label>
                              <input class="form-control" type="text" value="" id="cityIndexSave"
                                     placeholder="Введите индекс города">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-2">
                              <label class="form-label" for="streetSave">Улица</label>
                              <input class="form-control" type="text" value="" id="streetSave"
                                     placeholder="Введите улицу">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="houseSave">Номер дома</label>
                              <input class="form-control" type="text" value="" id="houseSave"
                                     placeholder="Введите номер дома">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="birthdaySave">Дата рождения</label>
                              <input class="form-control" type="date" value="" id="birthdaySave">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="genderSave">Выберите пол:</label>
                              <br>
                              <select class="form-select" size="3" id="genderSave" name="gender" required="">
                                 <option id="ManSave" value="MALE">Мужчина</option>
                                 <option id="WomanSave" value="FEMALE">Женщина</option>
                                 <option id="NoGenderSave" value="UNKNOWN">Не определен</option>
                              </select>
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <input type="button" class="btn btn-primary" value="Зарегистрироваться"
                                     onclick="{event.preventDefault(); saveUser()}"/>
                           </div>
                        </div>
                     </form>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>

   <!--HEADER-->
   <div>
      <!--HEADER-->
      <header class="bg-dark text-white" style="height: 44px;">
         <div class="container" style="height: 44px;">
            <div class="d-flex align-items-center justify-content-center justify-content-lg-start"
                 style="height: 44px;">
               <a href="/" class="d-flex align-items-center mb-lg-0 text-white text-decoration-none">
                  <h5 style="margin: 0;">LOGO</h5>
               </a>
               <!--NavBar(HEADER)-->
               <ul class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0 ms-5">
                  <li><a href="/shops" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Магазины</font></font></a></li>
                  <li><a href="#" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Товары</font></font></a></li>
                  <li></li>
                  <li><a href="#" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Ещё...</font></font></a></li>
                  <li></li>
                  <li></li>
               </ul>




               <div class="text-end">


                  <button type="button" id="user_open_modal_btn"
                          class="btn btn-outline-light me-2">Войти
                  </button>
                  <button type="button" id="user_open_modal_reg" class="btn btn-warning">
                     Зарегистрироваться
                  </button>

                  <script>
                     $(document).ready(function () {
                        if (window.location.href !== 'http://localhost:8888/') {
                           $('#user_open_modal_btn').hide();
                        }
                     })
                     $(document).ready(function () {
                        if (window.location.href !== 'http://localhost:8888/') {
                           $('#user_open_modal_reg').hide();
                        }
                     })
                  </script>

                  <!--ссылка и информация пользователя при аутентификации-->
                  
               </div>
            </div>
         </div>
         <nav class="navbar fixed-bottom navbar-light bg-light">
            <a class="navbar-brand" href="/feedback">Обратная связь</a>
         </nav>
      </header>
   </div>

   <!--Main zone-->
   <section class="d-flex">
      <!--Sidebar-->
      <div class="bg-light" style="width: 350px; min-height: 100vh; padding-top: 30px; padding-bottom: 200px">
         <div class="container-fluid">
            <div class="row">
               <div class="col-12 d-flex align-items-center">
                  <h5>Категории</h5>
               </div>

               <div class="col-12 d-flex justify-content-center">
                  <hr style="width: 100%; margin: 0;">
               </div>
               <!--Категории-->
               <div class="col-12 mt-4">
                  <ul class="nav nav-pills flex-column mb-auto">
                     <li class="nav-item">
                        <a id="popular_show_btn" href="#" class="nav-link active" aria-current="page">
                           Популярное
                           </font></font></a>
                     </li>

                     
                        <li class="nav-item">
                           <a id="9" href="#"
                              class="nav-link link-dark" aria-current="page">Автомобили</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="3" href="#"
                              class="nav-link link-dark" aria-current="page">Аксессуары</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="5" href="#"
                              class="nav-link link-dark" aria-current="page">Бытовая техника</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="6" href="#"
                              class="nav-link link-dark" aria-current="page">Детские товары</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="7" href="#"
                              class="nav-link link-dark" aria-current="page">Компьютеры</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="4" href="#"
                              class="nav-link link-dark" aria-current="page">Мебель</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="8" href="#"
                              class="nav-link link-dark" aria-current="page">Мобильные телефоны</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="2" href="#"
                              class="nav-link link-dark" aria-current="page">Обувь</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="1" href="#"
                              class="nav-link link-dark" aria-current="page">Одежда</a>
                        </li>
                     
                  </ul>
               </div>
            </div>
         </div>
      </div>

      <!--Main Body-->
      <div class="container-fluid" style="padding-top: 30px; padding-left: 35px; padding-bottom: 40px;">
         <div class="row">
            <div class="col-12">
               <form style="width: 650px;" class="d-flex">
                  <input id="search_input" type="search" class="form-control" name="search"
                         placeholder="Поиск по наименованию:">
                  <button id="search_btn" type="button" class="btn btn-success" style="width: 150px;">Поиск</button>
               </form>
            </div>

            <!-- QR and enable 2FA -->
            

         <!--Контейнер для динамического контента (js)-->
         <div class="collapse" id="dinamic_content">
            <div class="col-12" style="margin-top: 30px;">
               <h4 id="dinamic_head"></h4>
            </div>
            <!--сюда генерируются товары-->
            <div class="col-12 d-flex flex-wrap mt-3" id="dinamic_content_inner">

               </div>
            </div>

            <!--Контейнер для статического контента (при загрузке страницы)-->
            <div class="collapse show" id="popular_show_content">
               <div class="col-12" style="margin-top: 30px;">
                  <h4>
                     Популярные товары
                  </h4>
               </div>
               <!--Блок популярные товары-->
               <div class="col-12 d-flex flex-wrap mt-3">
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://pe-shop.ru/pictures/product/big/6045_big.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Антисептик для рук</h5>
                           <p class="card-text">Антисептик для рук</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;5&#39;,&#39;1&#39;)">В корзину</a>
                              <a href="/product/5" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton5">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem5"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.ikea.com/ru/ru/images/products/klappa-myagkaya-igrushka-myach-raznocvetnyy__0873096_pe682670_s5.jpg?f=xxs" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Мягкая игрушка</h5>
                           <p class="card-text">Мягкая игрушка</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;10&#39;,&#39;2&#39;)">В корзину</a>
                              <a href="/product/10" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton10">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem10"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.ikea.com/ru/ru/images/products/gulligast-gulligest-mobil__0923957_pe788456_s5.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Мобиль</h5>
                           <p class="card-text">Мобиль</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;11&#39;,&#39;3&#39;)">В корзину</a>
                              <a href="/product/11" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton11">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem11"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.opticmall.ru/assets/images/products/3908/2132-622-17.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Очки RAY BAN</h5>
                           <p class="card-text">Очки RAY BAN</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;4&#39;,&#39;2&#39;)">В корзину</a>
                              <a href="/product/4" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton4">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem4"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://cdn.rbt.ru/images/gen/item_image/image/8507/23/850668_r7634.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Ноутбук Lenovo</h5>
                           <p class="card-text">Ноутбук Lenovo</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;7&#39;,&#39;4&#39;)">В корзину</a>
                              <a href="/product/7" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton7">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem7"></div>
                        </div>
                     </div>
                  

               </div>
               <!--Блок популярные магазины-->
               <div class="col-12" style="margin-top: 30px;">
                  <h4>
                     Популярные магазины
                  </h4>
               </div>

               <div class="col-12 d-flex flex-wrap mt-3">
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/beru.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Яндекс Маркет</h5>
                           <p class="card-text">Одежда, обувь, бытовая техника</p>
                           <a href="/showcase/1" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/lamoda.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Lamoda</h5>
                           <p class="card-text">Одежда, обувь, аксессуары</p>
                           <a href="/showcase/2" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/aliexpress.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">AliExpress</h5>
                           <p class="card-text">Любые товары</p>
                           <a href="/showcase/4" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
               </div>
            </div>

         </div>
      </div>
   </section>

   <script src="https://code.jquery.com/jquery-3.6.0.min.js"
           integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

   <!-- JavaScript Bundle with Popper -->
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
           integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
           crossorigin="anonymous"></script>
   <script>
      /**
       * связано с статическим контентом
       */
      const popular_show_btn = $('#popular_show_btn');
      const popular_show_content = $('#popular_show_content');
      /**
       * динамический контент
       */
      const dinamic_show_content = $('#dinamic_content');
      const dinamic_head = $('#dinamic_head');
      const dinamic_inner_content = $('#dinamic_content_inner');
      /**
       * поиск
       */
      const search_input = $('#search_input');
      const search_btn = $('#search_btn');
      /**
       *  вход в систему и модальное окно входа в систему
       */
      const user_modal = $('#user_modal');
      const user_open_modal_btn = $('#user_open_modal_btn');
      const user_signin_form = $('#user_signin_form');
      const username_input = $('#username_input');
      const password_input = $('#password_input');
      const username_checker = $('#username_checker');
      const password_checker = $('#password_checker');
      const loginModal = $('#loginModal');
      const user_open_modal_reg = $('#user_open_modal_reg');

      $(document).ready(function () {

         /**
          * обработчик
          * проверка корректности отпавленной формы
          */
         $(user_signin_form).on('submit', function (e) {
            username_checker.html('');
            password_checker.html('');
            let username = username_input.val();
            let password = password_input.val();
            if (username === "" || username === " ") {
               username_checker.html('Поле username не должно быть пустым');
               e.preventDefault();
            } else if (password === "" || password === " ") {
               password_checker.html('Поле password не должно быть пустым')
               e.preventDefault();
            }
         })

         /**
          * обработчик
          * открытие модального окна входа в систему
          */
         $(user_open_modal_btn).on('click', function (e) {
            e.preventDefault();
            user_modal.modal('show');
         })
         $(user_open_modal_reg).on('click', function (e) {
            e.preventDefault();
            loginModal.modal('show');
         })

         /**
          * обработчик
          * обработка поиска
          */
         $(search_btn).on('click', function (e) {
            e.preventDefault();
            toggleClassesContent($(this));
            toggleClassesNavBar(null);
            let valueSearch = search_input.val();
            search_input.val('');

            /**
             * обрабочтик
             * проверка на пустое значение поиска
             */
            if (valueSearch === '') {
               dinamic_head.html('');
               dinamic_head.html('Все товары')
            } else {
               dinamic_head.html('');
               dinamic_head.html('Результат запроса "' + valueSearch + '"');
            }
         })

         /**
          * обработчик
          * обработчик на кнопке "популярное" в навбар
          */
         $(popular_show_btn).on('click', function (e) {
            e.preventDefault();
            toggleClassesContent($(this));
            toggleClassesNavBar($(this));
         })

         /**
          * обработчик
          * обработчик на все кнопки в навбар кроме "популярное"
          */
         $('.link-dark').on('click', function (e) {
            e.preventDefault();
            /**
             * переключение стилей кнопок навбара и контейнера с контентом
             */
            toggleClassesContent($(this));
            toggleClassesNavBar($(this));

            /**
             * перезапись категории в заголовок
             */
            let category = $(this).html();
            dinamic_head.html("");
            dinamic_head.html(category);
            /** перезапись динамического контента
             *  товары по категории
             */
            searchByCategory($(this));
         })


      })

      /**
       * отправляет GET запрос на /home/category/id = категории
       * генерирует html из массива итемов на странице
       */
      async function searchByCategory(e) {
         const categoryId = $(e).attr("id");
         const response = await fetch("/category/" + categoryId);
         if (response.ok) {
            let items = await response.json();
            /**
             * Добавляем итемы по категориям на страницу
             * */
            let itemsByCategoryHTML = "";
            for (let i = 0; i < items.length; i++) {
               itemsByCategoryHTML += '<div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">\n' +
                  '                       <img src="' + items[i].images[0] + '" class="card-img-top" alt="popular_item" style="height: 180px;">' +
                  '                           <div class="card-body">\n' +
                  '                                <h5 class="card-title">' + items[i].name + '</h5>' +
                  '                                <p class="card-text">' + items[i].description + '</p>' +
                  '                                <div class="d-flex">\n' +
                  '                                    <a href="#" class="btn btn-danger" style="width: 150px;">В корзину</a>' +
                  '                                    <a href="/product/' + items[i].id + '" class="btn btn-primary" style="margin-left: 10px;">Смотреть</a>' +
                  '                                </div>' +
                  '                           </div>' +
                  '                   </div>';
            }
            dinamic_inner_content.html("");
            dinamic_inner_content.html(itemsByCategoryHTML);
         }
      }

      /**
       * функция переключения классов контейнера с контентом
       */
      function toggleClassesContent(e) {
         if ($(e).is(popular_show_btn)) {
            popular_show_content.addClass('show');
            dinamic_show_content.removeClass('show');
            dinamic_inner_content.html("");
         } else {
            popular_show_content.removeClass('show');
            dinamic_show_content.addClass('show');
         }
      }

      /**
       * функция переключения кнопок в навбар
       */
      function toggleClassesNavBar(e) {
         $('.active').removeClass('active').addClass('link-dark');
         $(e).removeClass('link-dark');
         $(e).addClass('active');
      }

      async function addCartItem(itemId, shopId) {
         // let quant = document.getElementById("itemQuant").value;
         let url = new URL("http://localhost:8888/api/cart/add")
         const response = await fetch(url, {
            method: 'POST',
            headers: {
               "Accept": "application/json",
               "Content-Type": "application/json; charset=utf-8",
            },
            body: JSON.stringify({
               quantity: 1,
               item: {
                  id: itemId
               },
               shop: {
                  id: shopId
               },
            })
         })
      }

      $(async function () {
         await favoriteItem()
      })

      async function favoriteItem() {
         let items = document.getElementsByName("favItems")
         for (let i = 0; i < items.length; i++) {
            let itemDivID = items[i].id;
            let itemId = itemDivID.substr(itemDivID.indexOf("m") + 1, itemDivID.length - itemDivID.indexOf("m") + 1)
            await favoriteButtonItem(itemId);
         }
      }

   </script>
   <script type="text/javascript" src="/js/favoriteHome.js"></script>
   <script type="text/javascript" src="js/registration.js"></script>
   <script type="text/javascript" src="js/signin.js"></script>
   <script type="text/javascript" src="js/twoFactorAuth.js"></script>
</body>
</html>
], template might not exist or might not be accessible by any of the configured Template Resolvers] with root cause
org.thymeleaf.exceptions.TemplateInputException: Error resolving template [<!DOCTYPE html>
<html>
<head>
   <meta charset="UTF-8">
   <title>Главная</title>
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
         integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

   <!-- Не переносите подтягивание jQuery вниз файла, иначе он не сможет его прочитать в header-е, который встраивается
        в начало этой странице -->
   <script src="https://code.jquery.com/jquery-3.6.0.min.js"
           integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
</head>
<body>
   
   
   <!-- модалка для входа юзеру -->
   <div class="modal fade" id="user_modal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
         <div class="modal-content">
            <div class="modal-header">
               <h5 class="modal-title">Войдите в систему</h5>
               <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="user_signin_form" action="/login" method="post">
               <div class="modal-body">
                  <div class="mb-3">
                     <label for="username_input" class="form-label">Введите email:</label>
                     <input id="username_input" type="text" name="j_username" class="form-control"
                            placeholder="Username">
                     <div id="username_checker" class="form-text" style="color:#a40000;"></div>
                  </div>
                  <div class="mb-3">
                     <label for="password_input" class="form-label">Введите пароль:</label>
                     <input id="password_input" type="password" name="j_password" class="form-control"
                            placeholder="Password">
                     <div id="password_checker" class="form-text" style="color:#a40000;"></div>
                  </div>
                  <div class="mb-3">
                     <label for="verification_code_input" class="form-label">
                        Введите код с телефона (если используете 2FA):
                     </label>
                     <input id="verification_code_input" type="text" name="code" class="form-control"
                            placeholder="Verification code">
                  </div>
                  <div class="form-check">
                     <input class="form-check-input" type="checkbox" name="remember-me" id="flexCheckChecked"
                            checked>
                     <label class="form-check-label" for="flexCheckChecked">
                        Запомнить пароль
                     </label>
                  </div>
                  <br>
                  <p align="center">или войдите с помощью:</p>
                  <div class="form-group" align="center">
                     <div class="col-md-3">
                        <a class="btn btn-outline-dark" href="/oauth2/authorization/google" role="button"
                           style="text-transform:none">
                           <img width="20px" style="margin-bottom:3px; margin-right:10px; margin-left:30px"
                                src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/53/Google_%22G%22_Logo.svg/512px-Google_%22G%22_Logo.svg.png"/>
                           Login with google
                        </a>
                     </div>
                  </div>
                  <div class="form-group" align="center">
                     <div class="col-md-3">
                        <a class="btn btn-outline-dark" href="/oauth2/authorization/github" role="button"
                           style="text-transform:none" w>
                           <img width="20px" style="margin-bottom:3px; margin-right:10px; margin-left:30px"
                                src="https://wodensoft.co.uk/wp-content/uploads/2020/05/Github.png"/>
                           Login with github
                        </a>
                     </div>
                  </div>
                  <hr>
                  <p align="center">если вы у нас впервые:</p>
               </div>

               <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Отмена</button>
                  <button type="button" id="user_signin_btn" class="btn btn-primary"
                          onclick="{event.preventDefault(); signin()}">
                     Войти
                  </button>
               </div>
            </form>
         </div>
      </div>
   </div>

   <!-- Модалка для регистрации -->
   <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
         <div class="modal-content" style="width:750px;">
            <div class="modal-body">
               <div class="box">
                  <div class="form loginBox">
                     <b></b>
                     <b></b>

                     <form>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="usernameSave">Имя пользователя</label>
                              <input class="form-control" type="text" value="" id="usernameSave" required
                                     minlength="4"
                                     placeholder="Введите имя пользователя">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="emailSave">Адрес электронной почты</label>
                              <input class="form-control" type="email" value="" id="emailSave"
                                     pattern="^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}"
                                     title="в формате user@example.com" required
                                     placeholder="Введите адрес электронной почты">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="passwordSave">Пароль</label>
                              <input class="form-control" type="password" value="" id="passwordSave" required
                                     minlength="6"
                                     placeholder="Введите пароль">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="phoneSave">Номер телефона</label>
                              <input class="form-control" type="text" value="" id="phoneSave" required
                                     minlength="11" pattern="[0-9]+"
                                     title="указать цифрами" placeholder="Введите номер телефона">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="first_nameSave">Имя</label>
                              <input class="form-control" type="text" value="" id="first_nameSave"
                                     placeholder="Введите имя">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="last_nameSave">Фамилия</label>
                              <input class="form-control" type="text" value="" id="last_nameSave"
                                     placeholder="Введите фамилию">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="ageSave">Возраст</label>
                              <input class="form-control" type="number" value="" id="ageSave"
                                     placeholder="Введите возраст">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-2">
                              <label class="form-label" for="countrySave">Страна</label>
                              <input class="form-control" type="text" value="" id="countrySave"
                                     placeholder="Введите страну">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="citySave">Город</label>
                              <input class="form-control" type="text" value="" id="citySave"
                                     placeholder="Введите город">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="cityIndexSave">Индекс города</label>
                              <input class="form-control" type="text" value="" id="cityIndexSave"
                                     placeholder="Введите индекс города">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-2">
                              <label class="form-label" for="streetSave">Улица</label>
                              <input class="form-control" type="text" value="" id="streetSave"
                                     placeholder="Введите улицу">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="houseSave">Номер дома</label>
                              <input class="form-control" type="text" value="" id="houseSave"
                                     placeholder="Введите номер дома">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="birthdaySave">Дата рождения</label>
                              <input class="form-control" type="date" value="" id="birthdaySave">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="genderSave">Выберите пол:</label>
                              <br>
                              <select class="form-select" size="3" id="genderSave" name="gender" required="">
                                 <option id="ManSave" value="MALE">Мужчина</option>
                                 <option id="WomanSave" value="FEMALE">Женщина</option>
                                 <option id="NoGenderSave" value="UNKNOWN">Не определен</option>
                              </select>
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <input type="button" class="btn btn-primary" value="Зарегистрироваться"
                                     onclick="{event.preventDefault(); saveUser()}"/>
                           </div>
                        </div>
                     </form>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>

   <!--HEADER-->
   <div>
      <!--HEADER-->
      <header class="bg-dark text-white" style="height: 44px;">
         <div class="container" style="height: 44px;">
            <div class="d-flex align-items-center justify-content-center justify-content-lg-start"
                 style="height: 44px;">
               <a href="/" class="d-flex align-items-center mb-lg-0 text-white text-decoration-none">
                  <h5 style="margin: 0;">LOGO</h5>
               </a>
               <!--NavBar(HEADER)-->
               <ul class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0 ms-5">
                  <li><a href="/shops" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Магазины</font></font></a></li>
                  <li><a href="#" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Товары</font></font></a></li>
                  <li></li>
                  <li><a href="#" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Ещё...</font></font></a></li>
                  <li></li>
                  <li></li>
               </ul>




               <div class="text-end">


                  <button type="button" id="user_open_modal_btn"
                          class="btn btn-outline-light me-2">Войти
                  </button>
                  <button type="button" id="user_open_modal_reg" class="btn btn-warning">
                     Зарегистрироваться
                  </button>

                  <script>
                     $(document).ready(function () {
                        if (window.location.href !== 'http://localhost:8888/') {
                           $('#user_open_modal_btn').hide();
                        }
                     })
                     $(document).ready(function () {
                        if (window.location.href !== 'http://localhost:8888/') {
                           $('#user_open_modal_reg').hide();
                        }
                     })
                  </script>

                  <!--ссылка и информация пользователя при аутентификации-->
                  
               </div>
            </div>
         </div>
         <nav class="navbar fixed-bottom navbar-light bg-light">
            <a class="navbar-brand" href="/feedback">Обратная связь</a>
         </nav>
      </header>
   </div>

   <!--Main zone-->
   <section class="d-flex">
      <!--Sidebar-->
      <div class="bg-light" style="width: 350px; min-height: 100vh; padding-top: 30px; padding-bottom: 200px">
         <div class="container-fluid">
            <div class="row">
               <div class="col-12 d-flex align-items-center">
                  <h5>Категории</h5>
               </div>

               <div class="col-12 d-flex justify-content-center">
                  <hr style="width: 100%; margin: 0;">
               </div>
               <!--Категории-->
               <div class="col-12 mt-4">
                  <ul class="nav nav-pills flex-column mb-auto">
                     <li class="nav-item">
                        <a id="popular_show_btn" href="#" class="nav-link active" aria-current="page">
                           Популярное
                           </font></font></a>
                     </li>

                     
                        <li class="nav-item">
                           <a id="9" href="#"
                              class="nav-link link-dark" aria-current="page">Автомобили</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="3" href="#"
                              class="nav-link link-dark" aria-current="page">Аксессуары</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="5" href="#"
                              class="nav-link link-dark" aria-current="page">Бытовая техника</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="6" href="#"
                              class="nav-link link-dark" aria-current="page">Детские товары</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="7" href="#"
                              class="nav-link link-dark" aria-current="page">Компьютеры</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="4" href="#"
                              class="nav-link link-dark" aria-current="page">Мебель</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="8" href="#"
                              class="nav-link link-dark" aria-current="page">Мобильные телефоны</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="2" href="#"
                              class="nav-link link-dark" aria-current="page">Обувь</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="1" href="#"
                              class="nav-link link-dark" aria-current="page">Одежда</a>
                        </li>
                     
                  </ul>
               </div>
            </div>
         </div>
      </div>

      <!--Main Body-->
      <div class="container-fluid" style="padding-top: 30px; padding-left: 35px; padding-bottom: 40px;">
         <div class="row">
            <div class="col-12">
               <form style="width: 650px;" class="d-flex">
                  <input id="search_input" type="search" class="form-control" name="search"
                         placeholder="Поиск по наименованию:">
                  <button id="search_btn" type="button" class="btn btn-success" style="width: 150px;">Поиск</button>
               </form>
            </div>

            <!-- QR and enable 2FA -->
            

         <!--Контейнер для динамического контента (js)-->
         <div class="collapse" id="dinamic_content">
            <div class="col-12" style="margin-top: 30px;">
               <h4 id="dinamic_head"></h4>
            </div>
            <!--сюда генерируются товары-->
            <div class="col-12 d-flex flex-wrap mt-3" id="dinamic_content_inner">

               </div>
            </div>

            <!--Контейнер для статического контента (при загрузке страницы)-->
            <div class="collapse show" id="popular_show_content">
               <div class="col-12" style="margin-top: 30px;">
                  <h4>
                     Популярные товары
                  </h4>
               </div>
               <!--Блок популярные товары-->
               <div class="col-12 d-flex flex-wrap mt-3">
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://pe-shop.ru/pictures/product/big/6045_big.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Антисептик для рук</h5>
                           <p class="card-text">Антисептик для рук</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;5&#39;,&#39;1&#39;)">В корзину</a>
                              <a href="/product/5" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton5">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem5"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.ikea.com/ru/ru/images/products/klappa-myagkaya-igrushka-myach-raznocvetnyy__0873096_pe682670_s5.jpg?f=xxs" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Мягкая игрушка</h5>
                           <p class="card-text">Мягкая игрушка</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;10&#39;,&#39;2&#39;)">В корзину</a>
                              <a href="/product/10" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton10">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem10"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.ikea.com/ru/ru/images/products/gulligast-gulligest-mobil__0923957_pe788456_s5.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Мобиль</h5>
                           <p class="card-text">Мобиль</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;11&#39;,&#39;3&#39;)">В корзину</a>
                              <a href="/product/11" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton11">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem11"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.opticmall.ru/assets/images/products/3908/2132-622-17.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Очки RAY BAN</h5>
                           <p class="card-text">Очки RAY BAN</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;4&#39;,&#39;2&#39;)">В корзину</a>
                              <a href="/product/4" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton4">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem4"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://cdn.rbt.ru/images/gen/item_image/image/8507/23/850668_r7634.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Ноутбук Lenovo</h5>
                           <p class="card-text">Ноутбук Lenovo</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;7&#39;,&#39;4&#39;)">В корзину</a>
                              <a href="/product/7" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton7">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem7"></div>
                        </div>
                     </div>
                  

               </div>
               <!--Блок популярные магазины-->
               <div class="col-12" style="margin-top: 30px;">
                  <h4>
                     Популярные магазины
                  </h4>
               </div>

               <div class="col-12 d-flex flex-wrap mt-3">
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/beru.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Яндекс Маркет</h5>
                           <p class="card-text">Одежда, обувь, бытовая техника</p>
                           <a href="/showcase/1" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/lamoda.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Lamoda</h5>
                           <p class="card-text">Одежда, обувь, аксессуары</p>
                           <a href="/showcase/2" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/aliexpress.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">AliExpress</h5>
                           <p class="card-text">Любые товары</p>
                           <a href="/showcase/4" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
               </div>
            </div>

         </div>
      </div>
   </section>

   <script src="https://code.jquery.com/jquery-3.6.0.min.js"
           integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

   <!-- JavaScript Bundle with Popper -->
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
           integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
           crossorigin="anonymous"></script>
   <script>
      /**
       * связано с статическим контентом
       */
      const popular_show_btn = $('#popular_show_btn');
      const popular_show_content = $('#popular_show_content');
      /**
       * динамический контент
       */
      const dinamic_show_content = $('#dinamic_content');
      const dinamic_head = $('#dinamic_head');
      const dinamic_inner_content = $('#dinamic_content_inner');
      /**
       * поиск
       */
      const search_input = $('#search_input');
      const search_btn = $('#search_btn');
      /**
       *  вход в систему и модальное окно входа в систему
       */
      const user_modal = $('#user_modal');
      const user_open_modal_btn = $('#user_open_modal_btn');
      const user_signin_form = $('#user_signin_form');
      const username_input = $('#username_input');
      const password_input = $('#password_input');
      const username_checker = $('#username_checker');
      const password_checker = $('#password_checker');
      const loginModal = $('#loginModal');
      const user_open_modal_reg = $('#user_open_modal_reg');

      $(document).ready(function () {

         /**
          * обработчик
          * проверка корректности отпавленной формы
          */
         $(user_signin_form).on('submit', function (e) {
            username_checker.html('');
            password_checker.html('');
            let username = username_input.val();
            let password = password_input.val();
            if (username === "" || username === " ") {
               username_checker.html('Поле username не должно быть пустым');
               e.preventDefault();
            } else if (password === "" || password === " ") {
               password_checker.html('Поле password не должно быть пустым')
               e.preventDefault();
            }
         })

         /**
          * обработчик
          * открытие модального окна входа в систему
          */
         $(user_open_modal_btn).on('click', function (e) {
            e.preventDefault();
            user_modal.modal('show');
         })
         $(user_open_modal_reg).on('click', function (e) {
            e.preventDefault();
            loginModal.modal('show');
         })

         /**
          * обработчик
          * обработка поиска
          */
         $(search_btn).on('click', function (e) {
            e.preventDefault();
            toggleClassesContent($(this));
            toggleClassesNavBar(null);
            let valueSearch = search_input.val();
            search_input.val('');

            /**
             * обрабочтик
             * проверка на пустое значение поиска
             */
            if (valueSearch === '') {
               dinamic_head.html('');
               dinamic_head.html('Все товары')
            } else {
               dinamic_head.html('');
               dinamic_head.html('Результат запроса "' + valueSearch + '"');
            }
         })

         /**
          * обработчик
          * обработчик на кнопке "популярное" в навбар
          */
         $(popular_show_btn).on('click', function (e) {
            e.preventDefault();
            toggleClassesContent($(this));
            toggleClassesNavBar($(this));
         })

         /**
          * обработчик
          * обработчик на все кнопки в навбар кроме "популярное"
          */
         $('.link-dark').on('click', function (e) {
            e.preventDefault();
            /**
             * переключение стилей кнопок навбара и контейнера с контентом
             */
            toggleClassesContent($(this));
            toggleClassesNavBar($(this));

            /**
             * перезапись категории в заголовок
             */
            let category = $(this).html();
            dinamic_head.html("");
            dinamic_head.html(category);
            /** перезапись динамического контента
             *  товары по категории
             */
            searchByCategory($(this));
         })


      })

      /**
       * отправляет GET запрос на /home/category/id = категории
       * генерирует html из массива итемов на странице
       */
      async function searchByCategory(e) {
         const categoryId = $(e).attr("id");
         const response = await fetch("/category/" + categoryId);
         if (response.ok) {
            let items = await response.json();
            /**
             * Добавляем итемы по категориям на страницу
             * */
            let itemsByCategoryHTML = "";
            for (let i = 0; i < items.length; i++) {
               itemsByCategoryHTML += '<div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">\n' +
                  '                       <img src="' + items[i].images[0] + '" class="card-img-top" alt="popular_item" style="height: 180px;">' +
                  '                           <div class="card-body">\n' +
                  '                                <h5 class="card-title">' + items[i].name + '</h5>' +
                  '                                <p class="card-text">' + items[i].description + '</p>' +
                  '                                <div class="d-flex">\n' +
                  '                                    <a href="#" class="btn btn-danger" style="width: 150px;">В корзину</a>' +
                  '                                    <a href="/product/' + items[i].id + '" class="btn btn-primary" style="margin-left: 10px;">Смотреть</a>' +
                  '                                </div>' +
                  '                           </div>' +
                  '                   </div>';
            }
            dinamic_inner_content.html("");
            dinamic_inner_content.html(itemsByCategoryHTML);
         }
      }

      /**
       * функция переключения классов контейнера с контентом
       */
      function toggleClassesContent(e) {
         if ($(e).is(popular_show_btn)) {
            popular_show_content.addClass('show');
            dinamic_show_content.removeClass('show');
            dinamic_inner_content.html("");
         } else {
            popular_show_content.removeClass('show');
            dinamic_show_content.addClass('show');
         }
      }

      /**
       * функция переключения кнопок в навбар
       */
      function toggleClassesNavBar(e) {
         $('.active').removeClass('active').addClass('link-dark');
         $(e).removeClass('link-dark');
         $(e).addClass('active');
      }

      async function addCartItem(itemId, shopId) {
         // let quant = document.getElementById("itemQuant").value;
         let url = new URL("http://localhost:8888/api/cart/add")
         const response = await fetch(url, {
            method: 'POST',
            headers: {
               "Accept": "application/json",
               "Content-Type": "application/json; charset=utf-8",
            },
            body: JSON.stringify({
               quantity: 1,
               item: {
                  id: itemId
               },
               shop: {
                  id: shopId
               },
            })
         })
      }

      $(async function () {
         await favoriteItem()
      })

      async function favoriteItem() {
         let items = document.getElementsByName("favItems")
         for (let i = 0; i < items.length; i++) {
            let itemDivID = items[i].id;
            let itemId = itemDivID.substr(itemDivID.indexOf("m") + 1, itemDivID.length - itemDivID.indexOf("m") + 1)
            await favoriteButtonItem(itemId);
         }
      }

   </script>
   <script type="text/javascript" src="/js/favoriteHome.js"></script>
   <script type="text/javascript" src="js/registration.js"></script>
   <script type="text/javascript" src="js/signin.js"></script>
   <script type="text/javascript" src="js/twoFactorAuth.js"></script>
</body>
</html>
], template might not exist or might not be accessible by any of the configured Template Resolvers
	at org.thymeleaf.engine.TemplateManager.resolveTemplate(TemplateManager.java:869)
	at org.thymeleaf.engine.TemplateManager.parseAndProcess(TemplateManager.java:607)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1098)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1072)
	at org.thymeleaf.spring5.view.ThymeleafView.renderFragment(ThymeleafView.java:366)
	at org.thymeleaf.spring5.view.ThymeleafView.render(ThymeleafView.java:190)
	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1397)
	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1142)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1081)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:655)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:327)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:121)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:115)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:105)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:218)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:212)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:110)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:80)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:211)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:183)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:358)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:271)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:94)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1726)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:829)
2021-11-03 13:41:11,662 ERROR org.thymeleaf.TemplateEngine [http-nio-80-exec-6] [THYMELEAF][http-nio-80-exec-6] Exception processing template "<!DOCTYPE html>
 <html>
 <head>
   [...]t type="text/javascript" src="js/twoFactorAuth.js"></script>
 </body>
 </html>
 ": Error resolving template [<!DOCTYPE html>
<html>
<head>
   <meta charset="UTF-8">
   <title>Главная</title>
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
         integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

   <!-- Не переносите подтягивание jQuery вниз файла, иначе он не сможет его прочитать в header-е, который встраивается
        в начало этой странице -->
   <script src="https://code.jquery.com/jquery-3.6.0.min.js"
           integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
</head>
<body>
   
   
   <!-- модалка для входа юзеру -->
   <div class="modal fade" id="user_modal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
         <div class="modal-content">
            <div class="modal-header">
               <h5 class="modal-title">Войдите в систему</h5>
               <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="user_signin_form" action="/login" method="post">
               <div class="modal-body">
                  <div class="mb-3">
                     <label for="username_input" class="form-label">Введите email:</label>
                     <input id="username_input" type="text" name="j_username" class="form-control"
                            placeholder="Username">
                     <div id="username_checker" class="form-text" style="color:#a40000;"></div>
                  </div>
                  <div class="mb-3">
                     <label for="password_input" class="form-label">Введите пароль:</label>
                     <input id="password_input" type="password" name="j_password" class="form-control"
                            placeholder="Password">
                     <div id="password_checker" class="form-text" style="color:#a40000;"></div>
                  </div>
                  <div class="mb-3">
                     <label for="verification_code_input" class="form-label">
                        Введите код с телефона (если используете 2FA):
                     </label>
                     <input id="verification_code_input" type="text" name="code" class="form-control"
                            placeholder="Verification code">
                  </div>
                  <div class="form-check">
                     <input class="form-check-input" type="checkbox" name="remember-me" id="flexCheckChecked"
                            checked>
                     <label class="form-check-label" for="flexCheckChecked">
                        Запомнить пароль
                     </label>
                  </div>
                  <br>
                  <p align="center">или войдите с помощью:</p>
                  <div class="form-group" align="center">
                     <div class="col-md-3">
                        <a class="btn btn-outline-dark" href="/oauth2/authorization/google" role="button"
                           style="text-transform:none">
                           <img width="20px" style="margin-bottom:3px; margin-right:10px; margin-left:30px"
                                src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/53/Google_%22G%22_Logo.svg/512px-Google_%22G%22_Logo.svg.png"/>
                           Login with google
                        </a>
                     </div>
                  </div>
                  <div class="form-group" align="center">
                     <div class="col-md-3">
                        <a class="btn btn-outline-dark" href="/oauth2/authorization/github" role="button"
                           style="text-transform:none" w>
                           <img width="20px" style="margin-bottom:3px; margin-right:10px; margin-left:30px"
                                src="https://wodensoft.co.uk/wp-content/uploads/2020/05/Github.png"/>
                           Login with github
                        </a>
                     </div>
                  </div>
                  <hr>
                  <p align="center">если вы у нас впервые:</p>
               </div>

               <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Отмена</button>
                  <button type="button" id="user_signin_btn" class="btn btn-primary"
                          onclick="{event.preventDefault(); signin()}">
                     Войти
                  </button>
               </div>
            </form>
         </div>
      </div>
   </div>

   <!-- Модалка для регистрации -->
   <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
         <div class="modal-content" style="width:750px;">
            <div class="modal-body">
               <div class="box">
                  <div class="form loginBox">
                     <b></b>
                     <b></b>

                     <form>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="usernameSave">Имя пользователя</label>
                              <input class="form-control" type="text" value="" id="usernameSave" required
                                     minlength="4"
                                     placeholder="Введите имя пользователя">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="emailSave">Адрес электронной почты</label>
                              <input class="form-control" type="email" value="" id="emailSave"
                                     pattern="^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}"
                                     title="в формате user@example.com" required
                                     placeholder="Введите адрес электронной почты">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="passwordSave">Пароль</label>
                              <input class="form-control" type="password" value="" id="passwordSave" required
                                     minlength="6"
                                     placeholder="Введите пароль">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="phoneSave">Номер телефона</label>
                              <input class="form-control" type="text" value="" id="phoneSave" required
                                     minlength="11" pattern="[0-9]+"
                                     title="указать цифрами" placeholder="Введите номер телефона">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="first_nameSave">Имя</label>
                              <input class="form-control" type="text" value="" id="first_nameSave"
                                     placeholder="Введите имя">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="last_nameSave">Фамилия</label>
                              <input class="form-control" type="text" value="" id="last_nameSave"
                                     placeholder="Введите фамилию">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="ageSave">Возраст</label>
                              <input class="form-control" type="number" value="" id="ageSave"
                                     placeholder="Введите возраст">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-2">
                              <label class="form-label" for="countrySave">Страна</label>
                              <input class="form-control" type="text" value="" id="countrySave"
                                     placeholder="Введите страну">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="citySave">Город</label>
                              <input class="form-control" type="text" value="" id="citySave"
                                     placeholder="Введите город">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="cityIndexSave">Индекс города</label>
                              <input class="form-control" type="text" value="" id="cityIndexSave"
                                     placeholder="Введите индекс города">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-2">
                              <label class="form-label" for="streetSave">Улица</label>
                              <input class="form-control" type="text" value="" id="streetSave"
                                     placeholder="Введите улицу">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="houseSave">Номер дома</label>
                              <input class="form-control" type="text" value="" id="houseSave"
                                     placeholder="Введите номер дома">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="birthdaySave">Дата рождения</label>
                              <input class="form-control" type="date" value="" id="birthdaySave">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="genderSave">Выберите пол:</label>
                              <br>
                              <select class="form-select" size="3" id="genderSave" name="gender" required="">
                                 <option id="ManSave" value="MALE">Мужчина</option>
                                 <option id="WomanSave" value="FEMALE">Женщина</option>
                                 <option id="NoGenderSave" value="UNKNOWN">Не определен</option>
                              </select>
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <input type="button" class="btn btn-primary" value="Зарегистрироваться"
                                     onclick="{event.preventDefault(); saveUser()}"/>
                           </div>
                        </div>
                     </form>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>

   <!--HEADER-->
   <div>
      <!--HEADER-->
      <header class="bg-dark text-white" style="height: 44px;">
         <div class="container" style="height: 44px;">
            <div class="d-flex align-items-center justify-content-center justify-content-lg-start"
                 style="height: 44px;">
               <a href="/" class="d-flex align-items-center mb-lg-0 text-white text-decoration-none">
                  <h5 style="margin: 0;">LOGO</h5>
               </a>
               <!--NavBar(HEADER)-->
               <ul class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0 ms-5">
                  <li><a href="/shops" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Магазины</font></font></a></li>
                  <li><a href="#" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Товары</font></font></a></li>
                  <li></li>
                  <li><a href="#" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Ещё...</font></font></a></li>
                  <li></li>
                  <li></li>
               </ul>




               <div class="text-end">


                  <button type="button" id="user_open_modal_btn"
                          class="btn btn-outline-light me-2">Войти
                  </button>
                  <button type="button" id="user_open_modal_reg" class="btn btn-warning">
                     Зарегистрироваться
                  </button>

                  <script>
                     $(document).ready(function () {
                        if (window.location.href !== 'http://localhost:8888/') {
                           $('#user_open_modal_btn').hide();
                        }
                     })
                     $(document).ready(function () {
                        if (window.location.href !== 'http://localhost:8888/') {
                           $('#user_open_modal_reg').hide();
                        }
                     })
                  </script>

                  <!--ссылка и информация пользователя при аутентификации-->
                  
               </div>
            </div>
         </div>
         <nav class="navbar fixed-bottom navbar-light bg-light">
            <a class="navbar-brand" href="/feedback">Обратная связь</a>
         </nav>
      </header>
   </div>

   <!--Main zone-->
   <section class="d-flex">
      <!--Sidebar-->
      <div class="bg-light" style="width: 350px; min-height: 100vh; padding-top: 30px; padding-bottom: 200px">
         <div class="container-fluid">
            <div class="row">
               <div class="col-12 d-flex align-items-center">
                  <h5>Категории</h5>
               </div>

               <div class="col-12 d-flex justify-content-center">
                  <hr style="width: 100%; margin: 0;">
               </div>
               <!--Категории-->
               <div class="col-12 mt-4">
                  <ul class="nav nav-pills flex-column mb-auto">
                     <li class="nav-item">
                        <a id="popular_show_btn" href="#" class="nav-link active" aria-current="page">
                           Популярное
                           </font></font></a>
                     </li>

                     
                        <li class="nav-item">
                           <a id="9" href="#"
                              class="nav-link link-dark" aria-current="page">Автомобили</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="3" href="#"
                              class="nav-link link-dark" aria-current="page">Аксессуары</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="5" href="#"
                              class="nav-link link-dark" aria-current="page">Бытовая техника</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="6" href="#"
                              class="nav-link link-dark" aria-current="page">Детские товары</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="7" href="#"
                              class="nav-link link-dark" aria-current="page">Компьютеры</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="4" href="#"
                              class="nav-link link-dark" aria-current="page">Мебель</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="8" href="#"
                              class="nav-link link-dark" aria-current="page">Мобильные телефоны</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="2" href="#"
                              class="nav-link link-dark" aria-current="page">Обувь</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="1" href="#"
                              class="nav-link link-dark" aria-current="page">Одежда</a>
                        </li>
                     
                  </ul>
               </div>
            </div>
         </div>
      </div>

      <!--Main Body-->
      <div class="container-fluid" style="padding-top: 30px; padding-left: 35px; padding-bottom: 40px;">
         <div class="row">
            <div class="col-12">
               <form style="width: 650px;" class="d-flex">
                  <input id="search_input" type="search" class="form-control" name="search"
                         placeholder="Поиск по наименованию:">
                  <button id="search_btn" type="button" class="btn btn-success" style="width: 150px;">Поиск</button>
               </form>
            </div>

            <!-- QR and enable 2FA -->
            

         <!--Контейнер для динамического контента (js)-->
         <div class="collapse" id="dinamic_content">
            <div class="col-12" style="margin-top: 30px;">
               <h4 id="dinamic_head"></h4>
            </div>
            <!--сюда генерируются товары-->
            <div class="col-12 d-flex flex-wrap mt-3" id="dinamic_content_inner">

               </div>
            </div>

            <!--Контейнер для статического контента (при загрузке страницы)-->
            <div class="collapse show" id="popular_show_content">
               <div class="col-12" style="margin-top: 30px;">
                  <h4>
                     Популярные товары
                  </h4>
               </div>
               <!--Блок популярные товары-->
               <div class="col-12 d-flex flex-wrap mt-3">
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://pe-shop.ru/pictures/product/big/6045_big.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Антисептик для рук</h5>
                           <p class="card-text">Антисептик для рук</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;5&#39;,&#39;1&#39;)">В корзину</a>
                              <a href="/product/5" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton5">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem5"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.ikea.com/ru/ru/images/products/klappa-myagkaya-igrushka-myach-raznocvetnyy__0873096_pe682670_s5.jpg?f=xxs" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Мягкая игрушка</h5>
                           <p class="card-text">Мягкая игрушка</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;10&#39;,&#39;2&#39;)">В корзину</a>
                              <a href="/product/10" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton10">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem10"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.ikea.com/ru/ru/images/products/gulligast-gulligest-mobil__0923957_pe788456_s5.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Мобиль</h5>
                           <p class="card-text">Мобиль</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;11&#39;,&#39;3&#39;)">В корзину</a>
                              <a href="/product/11" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton11">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem11"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.opticmall.ru/assets/images/products/3908/2132-622-17.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Очки RAY BAN</h5>
                           <p class="card-text">Очки RAY BAN</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;4&#39;,&#39;2&#39;)">В корзину</a>
                              <a href="/product/4" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton4">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem4"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://cdn.rbt.ru/images/gen/item_image/image/8507/23/850668_r7634.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Ноутбук Lenovo</h5>
                           <p class="card-text">Ноутбук Lenovo</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;7&#39;,&#39;4&#39;)">В корзину</a>
                              <a href="/product/7" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton7">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem7"></div>
                        </div>
                     </div>
                  

               </div>
               <!--Блок популярные магазины-->
               <div class="col-12" style="margin-top: 30px;">
                  <h4>
                     Популярные магазины
                  </h4>
               </div>

               <div class="col-12 d-flex flex-wrap mt-3">
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/beru.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Яндекс Маркет</h5>
                           <p class="card-text">Одежда, обувь, бытовая техника</p>
                           <a href="/showcase/1" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/lamoda.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Lamoda</h5>
                           <p class="card-text">Одежда, обувь, аксессуары</p>
                           <a href="/showcase/2" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/aliexpress.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">AliExpress</h5>
                           <p class="card-text">Любые товары</p>
                           <a href="/showcase/4" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
               </div>
            </div>

         </div>
      </div>
   </section>

   <script src="https://code.jquery.com/jquery-3.6.0.min.js"
           integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

   <!-- JavaScript Bundle with Popper -->
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
           integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
           crossorigin="anonymous"></script>
   <script>
      /**
       * связано с статическим контентом
       */
      const popular_show_btn = $('#popular_show_btn');
      const popular_show_content = $('#popular_show_content');
      /**
       * динамический контент
       */
      const dinamic_show_content = $('#dinamic_content');
      const dinamic_head = $('#dinamic_head');
      const dinamic_inner_content = $('#dinamic_content_inner');
      /**
       * поиск
       */
      const search_input = $('#search_input');
      const search_btn = $('#search_btn');
      /**
       *  вход в систему и модальное окно входа в систему
       */
      const user_modal = $('#user_modal');
      const user_open_modal_btn = $('#user_open_modal_btn');
      const user_signin_form = $('#user_signin_form');
      const username_input = $('#username_input');
      const password_input = $('#password_input');
      const username_checker = $('#username_checker');
      const password_checker = $('#password_checker');
      const loginModal = $('#loginModal');
      const user_open_modal_reg = $('#user_open_modal_reg');

      $(document).ready(function () {

         /**
          * обработчик
          * проверка корректности отпавленной формы
          */
         $(user_signin_form).on('submit', function (e) {
            username_checker.html('');
            password_checker.html('');
            let username = username_input.val();
            let password = password_input.val();
            if (username === "" || username === " ") {
               username_checker.html('Поле username не должно быть пустым');
               e.preventDefault();
            } else if (password === "" || password === " ") {
               password_checker.html('Поле password не должно быть пустым')
               e.preventDefault();
            }
         })

         /**
          * обработчик
          * открытие модального окна входа в систему
          */
         $(user_open_modal_btn).on('click', function (e) {
            e.preventDefault();
            user_modal.modal('show');
         })
         $(user_open_modal_reg).on('click', function (e) {
            e.preventDefault();
            loginModal.modal('show');
         })

         /**
          * обработчик
          * обработка поиска
          */
         $(search_btn).on('click', function (e) {
            e.preventDefault();
            toggleClassesContent($(this));
            toggleClassesNavBar(null);
            let valueSearch = search_input.val();
            search_input.val('');

            /**
             * обрабочтик
             * проверка на пустое значение поиска
             */
            if (valueSearch === '') {
               dinamic_head.html('');
               dinamic_head.html('Все товары')
            } else {
               dinamic_head.html('');
               dinamic_head.html('Результат запроса "' + valueSearch + '"');
            }
         })

         /**
          * обработчик
          * обработчик на кнопке "популярное" в навбар
          */
         $(popular_show_btn).on('click', function (e) {
            e.preventDefault();
            toggleClassesContent($(this));
            toggleClassesNavBar($(this));
         })

         /**
          * обработчик
          * обработчик на все кнопки в навбар кроме "популярное"
          */
         $('.link-dark').on('click', function (e) {
            e.preventDefault();
            /**
             * переключение стилей кнопок навбара и контейнера с контентом
             */
            toggleClassesContent($(this));
            toggleClassesNavBar($(this));

            /**
             * перезапись категории в заголовок
             */
            let category = $(this).html();
            dinamic_head.html("");
            dinamic_head.html(category);
            /** перезапись динамического контента
             *  товары по категории
             */
            searchByCategory($(this));
         })


      })

      /**
       * отправляет GET запрос на /home/category/id = категории
       * генерирует html из массива итемов на странице
       */
      async function searchByCategory(e) {
         const categoryId = $(e).attr("id");
         const response = await fetch("/category/" + categoryId);
         if (response.ok) {
            let items = await response.json();
            /**
             * Добавляем итемы по категориям на страницу
             * */
            let itemsByCategoryHTML = "";
            for (let i = 0; i < items.length; i++) {
               itemsByCategoryHTML += '<div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">\n' +
                  '                       <img src="' + items[i].images[0] + '" class="card-img-top" alt="popular_item" style="height: 180px;">' +
                  '                           <div class="card-body">\n' +
                  '                                <h5 class="card-title">' + items[i].name + '</h5>' +
                  '                                <p class="card-text">' + items[i].description + '</p>' +
                  '                                <div class="d-flex">\n' +
                  '                                    <a href="#" class="btn btn-danger" style="width: 150px;">В корзину</a>' +
                  '                                    <a href="/product/' + items[i].id + '" class="btn btn-primary" style="margin-left: 10px;">Смотреть</a>' +
                  '                                </div>' +
                  '                           </div>' +
                  '                   </div>';
            }
            dinamic_inner_content.html("");
            dinamic_inner_content.html(itemsByCategoryHTML);
         }
      }

      /**
       * функция переключения классов контейнера с контентом
       */
      function toggleClassesContent(e) {
         if ($(e).is(popular_show_btn)) {
            popular_show_content.addClass('show');
            dinamic_show_content.removeClass('show');
            dinamic_inner_content.html("");
         } else {
            popular_show_content.removeClass('show');
            dinamic_show_content.addClass('show');
         }
      }

      /**
       * функция переключения кнопок в навбар
       */
      function toggleClassesNavBar(e) {
         $('.active').removeClass('active').addClass('link-dark');
         $(e).removeClass('link-dark');
         $(e).addClass('active');
      }

      async function addCartItem(itemId, shopId) {
         // let quant = document.getElementById("itemQuant").value;
         let url = new URL("http://localhost:8888/api/cart/add")
         const response = await fetch(url, {
            method: 'POST',
            headers: {
               "Accept": "application/json",
               "Content-Type": "application/json; charset=utf-8",
            },
            body: JSON.stringify({
               quantity: 1,
               item: {
                  id: itemId
               },
               shop: {
                  id: shopId
               },
            })
         })
      }

      $(async function () {
         await favoriteItem()
      })

      async function favoriteItem() {
         let items = document.getElementsByName("favItems")
         for (let i = 0; i < items.length; i++) {
            let itemDivID = items[i].id;
            let itemId = itemDivID.substr(itemDivID.indexOf("m") + 1, itemDivID.length - itemDivID.indexOf("m") + 1)
            await favoriteButtonItem(itemId);
         }
      }

   </script>
   <script type="text/javascript" src="/js/favoriteHome.js"></script>
   <script type="text/javascript" src="js/registration.js"></script>
   <script type="text/javascript" src="js/signin.js"></script>
   <script type="text/javascript" src="js/twoFactorAuth.js"></script>
</body>
</html>
], template might not exist or might not be accessible by any of the configured Template Resolvers
org.thymeleaf.exceptions.TemplateInputException: Error resolving template [<!DOCTYPE html>
<html>
<head>
   <meta charset="UTF-8">
   <title>Главная</title>
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
         integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

   <!-- Не переносите подтягивание jQuery вниз файла, иначе он не сможет его прочитать в header-е, который встраивается
        в начало этой странице -->
   <script src="https://code.jquery.com/jquery-3.6.0.min.js"
           integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
</head>
<body>
   
   
   <!-- модалка для входа юзеру -->
   <div class="modal fade" id="user_modal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
         <div class="modal-content">
            <div class="modal-header">
               <h5 class="modal-title">Войдите в систему</h5>
               <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="user_signin_form" action="/login" method="post">
               <div class="modal-body">
                  <div class="mb-3">
                     <label for="username_input" class="form-label">Введите email:</label>
                     <input id="username_input" type="text" name="j_username" class="form-control"
                            placeholder="Username">
                     <div id="username_checker" class="form-text" style="color:#a40000;"></div>
                  </div>
                  <div class="mb-3">
                     <label for="password_input" class="form-label">Введите пароль:</label>
                     <input id="password_input" type="password" name="j_password" class="form-control"
                            placeholder="Password">
                     <div id="password_checker" class="form-text" style="color:#a40000;"></div>
                  </div>
                  <div class="mb-3">
                     <label for="verification_code_input" class="form-label">
                        Введите код с телефона (если используете 2FA):
                     </label>
                     <input id="verification_code_input" type="text" name="code" class="form-control"
                            placeholder="Verification code">
                  </div>
                  <div class="form-check">
                     <input class="form-check-input" type="checkbox" name="remember-me" id="flexCheckChecked"
                            checked>
                     <label class="form-check-label" for="flexCheckChecked">
                        Запомнить пароль
                     </label>
                  </div>
                  <br>
                  <p align="center">или войдите с помощью:</p>
                  <div class="form-group" align="center">
                     <div class="col-md-3">
                        <a class="btn btn-outline-dark" href="/oauth2/authorization/google" role="button"
                           style="text-transform:none">
                           <img width="20px" style="margin-bottom:3px; margin-right:10px; margin-left:30px"
                                src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/53/Google_%22G%22_Logo.svg/512px-Google_%22G%22_Logo.svg.png"/>
                           Login with google
                        </a>
                     </div>
                  </div>
                  <div class="form-group" align="center">
                     <div class="col-md-3">
                        <a class="btn btn-outline-dark" href="/oauth2/authorization/github" role="button"
                           style="text-transform:none" w>
                           <img width="20px" style="margin-bottom:3px; margin-right:10px; margin-left:30px"
                                src="https://wodensoft.co.uk/wp-content/uploads/2020/05/Github.png"/>
                           Login with github
                        </a>
                     </div>
                  </div>
                  <hr>
                  <p align="center">если вы у нас впервые:</p>
               </div>

               <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Отмена</button>
                  <button type="button" id="user_signin_btn" class="btn btn-primary"
                          onclick="{event.preventDefault(); signin()}">
                     Войти
                  </button>
               </div>
            </form>
         </div>
      </div>
   </div>

   <!-- Модалка для регистрации -->
   <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
         <div class="modal-content" style="width:750px;">
            <div class="modal-body">
               <div class="box">
                  <div class="form loginBox">
                     <b></b>
                     <b></b>

                     <form>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="usernameSave">Имя пользователя</label>
                              <input class="form-control" type="text" value="" id="usernameSave" required
                                     minlength="4"
                                     placeholder="Введите имя пользователя">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="emailSave">Адрес электронной почты</label>
                              <input class="form-control" type="email" value="" id="emailSave"
                                     pattern="^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}"
                                     title="в формате user@example.com" required
                                     placeholder="Введите адрес электронной почты">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="passwordSave">Пароль</label>
                              <input class="form-control" type="password" value="" id="passwordSave" required
                                     minlength="6"
                                     placeholder="Введите пароль">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="phoneSave">Номер телефона</label>
                              <input class="form-control" type="text" value="" id="phoneSave" required
                                     minlength="11" pattern="[0-9]+"
                                     title="указать цифрами" placeholder="Введите номер телефона">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="first_nameSave">Имя</label>
                              <input class="form-control" type="text" value="" id="first_nameSave"
                                     placeholder="Введите имя">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="last_nameSave">Фамилия</label>
                              <input class="form-control" type="text" value="" id="last_nameSave"
                                     placeholder="Введите фамилию">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="ageSave">Возраст</label>
                              <input class="form-control" type="number" value="" id="ageSave"
                                     placeholder="Введите возраст">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-2">
                              <label class="form-label" for="countrySave">Страна</label>
                              <input class="form-control" type="text" value="" id="countrySave"
                                     placeholder="Введите страну">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="citySave">Город</label>
                              <input class="form-control" type="text" value="" id="citySave"
                                     placeholder="Введите город">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="cityIndexSave">Индекс города</label>
                              <input class="form-control" type="text" value="" id="cityIndexSave"
                                     placeholder="Введите индекс города">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-2">
                              <label class="form-label" for="streetSave">Улица</label>
                              <input class="form-control" type="text" value="" id="streetSave"
                                     placeholder="Введите улицу">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="houseSave">Номер дома</label>
                              <input class="form-control" type="text" value="" id="houseSave"
                                     placeholder="Введите номер дома">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="birthdaySave">Дата рождения</label>
                              <input class="form-control" type="date" value="" id="birthdaySave">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="genderSave">Выберите пол:</label>
                              <br>
                              <select class="form-select" size="3" id="genderSave" name="gender" required="">
                                 <option id="ManSave" value="MALE">Мужчина</option>
                                 <option id="WomanSave" value="FEMALE">Женщина</option>
                                 <option id="NoGenderSave" value="UNKNOWN">Не определен</option>
                              </select>
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <input type="button" class="btn btn-primary" value="Зарегистрироваться"
                                     onclick="{event.preventDefault(); saveUser()}"/>
                           </div>
                        </div>
                     </form>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>

   <!--HEADER-->
   <div>
      <!--HEADER-->
      <header class="bg-dark text-white" style="height: 44px;">
         <div class="container" style="height: 44px;">
            <div class="d-flex align-items-center justify-content-center justify-content-lg-start"
                 style="height: 44px;">
               <a href="/" class="d-flex align-items-center mb-lg-0 text-white text-decoration-none">
                  <h5 style="margin: 0;">LOGO</h5>
               </a>
               <!--NavBar(HEADER)-->
               <ul class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0 ms-5">
                  <li><a href="/shops" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Магазины</font></font></a></li>
                  <li><a href="#" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Товары</font></font></a></li>
                  <li></li>
                  <li><a href="#" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Ещё...</font></font></a></li>
                  <li></li>
                  <li></li>
               </ul>




               <div class="text-end">


                  <button type="button" id="user_open_modal_btn"
                          class="btn btn-outline-light me-2">Войти
                  </button>
                  <button type="button" id="user_open_modal_reg" class="btn btn-warning">
                     Зарегистрироваться
                  </button>

                  <script>
                     $(document).ready(function () {
                        if (window.location.href !== 'http://localhost:8888/') {
                           $('#user_open_modal_btn').hide();
                        }
                     })
                     $(document).ready(function () {
                        if (window.location.href !== 'http://localhost:8888/') {
                           $('#user_open_modal_reg').hide();
                        }
                     })
                  </script>

                  <!--ссылка и информация пользователя при аутентификации-->
                  
               </div>
            </div>
         </div>
         <nav class="navbar fixed-bottom navbar-light bg-light">
            <a class="navbar-brand" href="/feedback">Обратная связь</a>
         </nav>
      </header>
   </div>

   <!--Main zone-->
   <section class="d-flex">
      <!--Sidebar-->
      <div class="bg-light" style="width: 350px; min-height: 100vh; padding-top: 30px; padding-bottom: 200px">
         <div class="container-fluid">
            <div class="row">
               <div class="col-12 d-flex align-items-center">
                  <h5>Категории</h5>
               </div>

               <div class="col-12 d-flex justify-content-center">
                  <hr style="width: 100%; margin: 0;">
               </div>
               <!--Категории-->
               <div class="col-12 mt-4">
                  <ul class="nav nav-pills flex-column mb-auto">
                     <li class="nav-item">
                        <a id="popular_show_btn" href="#" class="nav-link active" aria-current="page">
                           Популярное
                           </font></font></a>
                     </li>

                     
                        <li class="nav-item">
                           <a id="9" href="#"
                              class="nav-link link-dark" aria-current="page">Автомобили</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="3" href="#"
                              class="nav-link link-dark" aria-current="page">Аксессуары</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="5" href="#"
                              class="nav-link link-dark" aria-current="page">Бытовая техника</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="6" href="#"
                              class="nav-link link-dark" aria-current="page">Детские товары</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="7" href="#"
                              class="nav-link link-dark" aria-current="page">Компьютеры</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="4" href="#"
                              class="nav-link link-dark" aria-current="page">Мебель</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="8" href="#"
                              class="nav-link link-dark" aria-current="page">Мобильные телефоны</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="2" href="#"
                              class="nav-link link-dark" aria-current="page">Обувь</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="1" href="#"
                              class="nav-link link-dark" aria-current="page">Одежда</a>
                        </li>
                     
                  </ul>
               </div>
            </div>
         </div>
      </div>

      <!--Main Body-->
      <div class="container-fluid" style="padding-top: 30px; padding-left: 35px; padding-bottom: 40px;">
         <div class="row">
            <div class="col-12">
               <form style="width: 650px;" class="d-flex">
                  <input id="search_input" type="search" class="form-control" name="search"
                         placeholder="Поиск по наименованию:">
                  <button id="search_btn" type="button" class="btn btn-success" style="width: 150px;">Поиск</button>
               </form>
            </div>

            <!-- QR and enable 2FA -->
            

         <!--Контейнер для динамического контента (js)-->
         <div class="collapse" id="dinamic_content">
            <div class="col-12" style="margin-top: 30px;">
               <h4 id="dinamic_head"></h4>
            </div>
            <!--сюда генерируются товары-->
            <div class="col-12 d-flex flex-wrap mt-3" id="dinamic_content_inner">

               </div>
            </div>

            <!--Контейнер для статического контента (при загрузке страницы)-->
            <div class="collapse show" id="popular_show_content">
               <div class="col-12" style="margin-top: 30px;">
                  <h4>
                     Популярные товары
                  </h4>
               </div>
               <!--Блок популярные товары-->
               <div class="col-12 d-flex flex-wrap mt-3">
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://pe-shop.ru/pictures/product/big/6045_big.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Антисептик для рук</h5>
                           <p class="card-text">Антисептик для рук</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;5&#39;,&#39;1&#39;)">В корзину</a>
                              <a href="/product/5" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton5">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem5"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.ikea.com/ru/ru/images/products/klappa-myagkaya-igrushka-myach-raznocvetnyy__0873096_pe682670_s5.jpg?f=xxs" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Мягкая игрушка</h5>
                           <p class="card-text">Мягкая игрушка</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;10&#39;,&#39;2&#39;)">В корзину</a>
                              <a href="/product/10" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton10">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem10"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.ikea.com/ru/ru/images/products/gulligast-gulligest-mobil__0923957_pe788456_s5.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Мобиль</h5>
                           <p class="card-text">Мобиль</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;11&#39;,&#39;3&#39;)">В корзину</a>
                              <a href="/product/11" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton11">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem11"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.opticmall.ru/assets/images/products/3908/2132-622-17.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Очки RAY BAN</h5>
                           <p class="card-text">Очки RAY BAN</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;4&#39;,&#39;2&#39;)">В корзину</a>
                              <a href="/product/4" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton4">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem4"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://cdn.rbt.ru/images/gen/item_image/image/8507/23/850668_r7634.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Ноутбук Lenovo</h5>
                           <p class="card-text">Ноутбук Lenovo</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;7&#39;,&#39;4&#39;)">В корзину</a>
                              <a href="/product/7" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton7">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem7"></div>
                        </div>
                     </div>
                  

               </div>
               <!--Блок популярные магазины-->
               <div class="col-12" style="margin-top: 30px;">
                  <h4>
                     Популярные магазины
                  </h4>
               </div>

               <div class="col-12 d-flex flex-wrap mt-3">
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/beru.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Яндекс Маркет</h5>
                           <p class="card-text">Одежда, обувь, бытовая техника</p>
                           <a href="/showcase/1" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/lamoda.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Lamoda</h5>
                           <p class="card-text">Одежда, обувь, аксессуары</p>
                           <a href="/showcase/2" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/aliexpress.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">AliExpress</h5>
                           <p class="card-text">Любые товары</p>
                           <a href="/showcase/4" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
               </div>
            </div>

         </div>
      </div>
   </section>

   <script src="https://code.jquery.com/jquery-3.6.0.min.js"
           integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

   <!-- JavaScript Bundle with Popper -->
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
           integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
           crossorigin="anonymous"></script>
   <script>
      /**
       * связано с статическим контентом
       */
      const popular_show_btn = $('#popular_show_btn');
      const popular_show_content = $('#popular_show_content');
      /**
       * динамический контент
       */
      const dinamic_show_content = $('#dinamic_content');
      const dinamic_head = $('#dinamic_head');
      const dinamic_inner_content = $('#dinamic_content_inner');
      /**
       * поиск
       */
      const search_input = $('#search_input');
      const search_btn = $('#search_btn');
      /**
       *  вход в систему и модальное окно входа в систему
       */
      const user_modal = $('#user_modal');
      const user_open_modal_btn = $('#user_open_modal_btn');
      const user_signin_form = $('#user_signin_form');
      const username_input = $('#username_input');
      const password_input = $('#password_input');
      const username_checker = $('#username_checker');
      const password_checker = $('#password_checker');
      const loginModal = $('#loginModal');
      const user_open_modal_reg = $('#user_open_modal_reg');

      $(document).ready(function () {

         /**
          * обработчик
          * проверка корректности отпавленной формы
          */
         $(user_signin_form).on('submit', function (e) {
            username_checker.html('');
            password_checker.html('');
            let username = username_input.val();
            let password = password_input.val();
            if (username === "" || username === " ") {
               username_checker.html('Поле username не должно быть пустым');
               e.preventDefault();
            } else if (password === "" || password === " ") {
               password_checker.html('Поле password не должно быть пустым')
               e.preventDefault();
            }
         })

         /**
          * обработчик
          * открытие модального окна входа в систему
          */
         $(user_open_modal_btn).on('click', function (e) {
            e.preventDefault();
            user_modal.modal('show');
         })
         $(user_open_modal_reg).on('click', function (e) {
            e.preventDefault();
            loginModal.modal('show');
         })

         /**
          * обработчик
          * обработка поиска
          */
         $(search_btn).on('click', function (e) {
            e.preventDefault();
            toggleClassesContent($(this));
            toggleClassesNavBar(null);
            let valueSearch = search_input.val();
            search_input.val('');

            /**
             * обрабочтик
             * проверка на пустое значение поиска
             */
            if (valueSearch === '') {
               dinamic_head.html('');
               dinamic_head.html('Все товары')
            } else {
               dinamic_head.html('');
               dinamic_head.html('Результат запроса "' + valueSearch + '"');
            }
         })

         /**
          * обработчик
          * обработчик на кнопке "популярное" в навбар
          */
         $(popular_show_btn).on('click', function (e) {
            e.preventDefault();
            toggleClassesContent($(this));
            toggleClassesNavBar($(this));
         })

         /**
          * обработчик
          * обработчик на все кнопки в навбар кроме "популярное"
          */
         $('.link-dark').on('click', function (e) {
            e.preventDefault();
            /**
             * переключение стилей кнопок навбара и контейнера с контентом
             */
            toggleClassesContent($(this));
            toggleClassesNavBar($(this));

            /**
             * перезапись категории в заголовок
             */
            let category = $(this).html();
            dinamic_head.html("");
            dinamic_head.html(category);
            /** перезапись динамического контента
             *  товары по категории
             */
            searchByCategory($(this));
         })


      })

      /**
       * отправляет GET запрос на /home/category/id = категории
       * генерирует html из массива итемов на странице
       */
      async function searchByCategory(e) {
         const categoryId = $(e).attr("id");
         const response = await fetch("/category/" + categoryId);
         if (response.ok) {
            let items = await response.json();
            /**
             * Добавляем итемы по категориям на страницу
             * */
            let itemsByCategoryHTML = "";
            for (let i = 0; i < items.length; i++) {
               itemsByCategoryHTML += '<div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">\n' +
                  '                       <img src="' + items[i].images[0] + '" class="card-img-top" alt="popular_item" style="height: 180px;">' +
                  '                           <div class="card-body">\n' +
                  '                                <h5 class="card-title">' + items[i].name + '</h5>' +
                  '                                <p class="card-text">' + items[i].description + '</p>' +
                  '                                <div class="d-flex">\n' +
                  '                                    <a href="#" class="btn btn-danger" style="width: 150px;">В корзину</a>' +
                  '                                    <a href="/product/' + items[i].id + '" class="btn btn-primary" style="margin-left: 10px;">Смотреть</a>' +
                  '                                </div>' +
                  '                           </div>' +
                  '                   </div>';
            }
            dinamic_inner_content.html("");
            dinamic_inner_content.html(itemsByCategoryHTML);
         }
      }

      /**
       * функция переключения классов контейнера с контентом
       */
      function toggleClassesContent(e) {
         if ($(e).is(popular_show_btn)) {
            popular_show_content.addClass('show');
            dinamic_show_content.removeClass('show');
            dinamic_inner_content.html("");
         } else {
            popular_show_content.removeClass('show');
            dinamic_show_content.addClass('show');
         }
      }

      /**
       * функция переключения кнопок в навбар
       */
      function toggleClassesNavBar(e) {
         $('.active').removeClass('active').addClass('link-dark');
         $(e).removeClass('link-dark');
         $(e).addClass('active');
      }

      async function addCartItem(itemId, shopId) {
         // let quant = document.getElementById("itemQuant").value;
         let url = new URL("http://localhost:8888/api/cart/add")
         const response = await fetch(url, {
            method: 'POST',
            headers: {
               "Accept": "application/json",
               "Content-Type": "application/json; charset=utf-8",
            },
            body: JSON.stringify({
               quantity: 1,
               item: {
                  id: itemId
               },
               shop: {
                  id: shopId
               },
            })
         })
      }

      $(async function () {
         await favoriteItem()
      })

      async function favoriteItem() {
         let items = document.getElementsByName("favItems")
         for (let i = 0; i < items.length; i++) {
            let itemDivID = items[i].id;
            let itemId = itemDivID.substr(itemDivID.indexOf("m") + 1, itemDivID.length - itemDivID.indexOf("m") + 1)
            await favoriteButtonItem(itemId);
         }
      }

   </script>
   <script type="text/javascript" src="/js/favoriteHome.js"></script>
   <script type="text/javascript" src="js/registration.js"></script>
   <script type="text/javascript" src="js/signin.js"></script>
   <script type="text/javascript" src="js/twoFactorAuth.js"></script>
</body>
</html>
], template might not exist or might not be accessible by any of the configured Template Resolvers
	at org.thymeleaf.engine.TemplateManager.resolveTemplate(TemplateManager.java:869)
	at org.thymeleaf.engine.TemplateManager.parseAndProcess(TemplateManager.java:607)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1098)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1072)
	at org.thymeleaf.spring5.view.ThymeleafView.renderFragment(ThymeleafView.java:366)
	at org.thymeleaf.spring5.view.ThymeleafView.render(ThymeleafView.java:190)
	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1397)
	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1142)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1081)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:655)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:327)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:121)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:115)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:105)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:218)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:212)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:110)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:80)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:211)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:183)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:358)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:271)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:94)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1726)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:829)
2021-11-03 13:41:11,670 ERROR org.apache.juli.logging.DirectJDKLog [http-nio-80-exec-6] Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is org.thymeleaf.exceptions.TemplateInputException: Error resolving template [<!DOCTYPE html>
<html>
<head>
   <meta charset="UTF-8">
   <title>Главная</title>
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
         integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

   <!-- Не переносите подтягивание jQuery вниз файла, иначе он не сможет его прочитать в header-е, который встраивается
        в начало этой странице -->
   <script src="https://code.jquery.com/jquery-3.6.0.min.js"
           integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
</head>
<body>
   
   
   <!-- модалка для входа юзеру -->
   <div class="modal fade" id="user_modal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
         <div class="modal-content">
            <div class="modal-header">
               <h5 class="modal-title">Войдите в систему</h5>
               <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="user_signin_form" action="/login" method="post">
               <div class="modal-body">
                  <div class="mb-3">
                     <label for="username_input" class="form-label">Введите email:</label>
                     <input id="username_input" type="text" name="j_username" class="form-control"
                            placeholder="Username">
                     <div id="username_checker" class="form-text" style="color:#a40000;"></div>
                  </div>
                  <div class="mb-3">
                     <label for="password_input" class="form-label">Введите пароль:</label>
                     <input id="password_input" type="password" name="j_password" class="form-control"
                            placeholder="Password">
                     <div id="password_checker" class="form-text" style="color:#a40000;"></div>
                  </div>
                  <div class="mb-3">
                     <label for="verification_code_input" class="form-label">
                        Введите код с телефона (если используете 2FA):
                     </label>
                     <input id="verification_code_input" type="text" name="code" class="form-control"
                            placeholder="Verification code">
                  </div>
                  <div class="form-check">
                     <input class="form-check-input" type="checkbox" name="remember-me" id="flexCheckChecked"
                            checked>
                     <label class="form-check-label" for="flexCheckChecked">
                        Запомнить пароль
                     </label>
                  </div>
                  <br>
                  <p align="center">или войдите с помощью:</p>
                  <div class="form-group" align="center">
                     <div class="col-md-3">
                        <a class="btn btn-outline-dark" href="/oauth2/authorization/google" role="button"
                           style="text-transform:none">
                           <img width="20px" style="margin-bottom:3px; margin-right:10px; margin-left:30px"
                                src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/53/Google_%22G%22_Logo.svg/512px-Google_%22G%22_Logo.svg.png"/>
                           Login with google
                        </a>
                     </div>
                  </div>
                  <div class="form-group" align="center">
                     <div class="col-md-3">
                        <a class="btn btn-outline-dark" href="/oauth2/authorization/github" role="button"
                           style="text-transform:none" w>
                           <img width="20px" style="margin-bottom:3px; margin-right:10px; margin-left:30px"
                                src="https://wodensoft.co.uk/wp-content/uploads/2020/05/Github.png"/>
                           Login with github
                        </a>
                     </div>
                  </div>
                  <hr>
                  <p align="center">если вы у нас впервые:</p>
               </div>

               <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Отмена</button>
                  <button type="button" id="user_signin_btn" class="btn btn-primary"
                          onclick="{event.preventDefault(); signin()}">
                     Войти
                  </button>
               </div>
            </form>
         </div>
      </div>
   </div>

   <!-- Модалка для регистрации -->
   <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
         <div class="modal-content" style="width:750px;">
            <div class="modal-body">
               <div class="box">
                  <div class="form loginBox">
                     <b></b>
                     <b></b>

                     <form>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="usernameSave">Имя пользователя</label>
                              <input class="form-control" type="text" value="" id="usernameSave" required
                                     minlength="4"
                                     placeholder="Введите имя пользователя">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="emailSave">Адрес электронной почты</label>
                              <input class="form-control" type="email" value="" id="emailSave"
                                     pattern="^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}"
                                     title="в формате user@example.com" required
                                     placeholder="Введите адрес электронной почты">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="passwordSave">Пароль</label>
                              <input class="form-control" type="password" value="" id="passwordSave" required
                                     minlength="6"
                                     placeholder="Введите пароль">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="phoneSave">Номер телефона</label>
                              <input class="form-control" type="text" value="" id="phoneSave" required
                                     minlength="11" pattern="[0-9]+"
                                     title="указать цифрами" placeholder="Введите номер телефона">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="first_nameSave">Имя</label>
                              <input class="form-control" type="text" value="" id="first_nameSave"
                                     placeholder="Введите имя">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="last_nameSave">Фамилия</label>
                              <input class="form-control" type="text" value="" id="last_nameSave"
                                     placeholder="Введите фамилию">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="ageSave">Возраст</label>
                              <input class="form-control" type="number" value="" id="ageSave"
                                     placeholder="Введите возраст">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-2">
                              <label class="form-label" for="countrySave">Страна</label>
                              <input class="form-control" type="text" value="" id="countrySave"
                                     placeholder="Введите страну">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="citySave">Город</label>
                              <input class="form-control" type="text" value="" id="citySave"
                                     placeholder="Введите город">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="cityIndexSave">Индекс города</label>
                              <input class="form-control" type="text" value="" id="cityIndexSave"
                                     placeholder="Введите индекс города">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-2">
                              <label class="form-label" for="streetSave">Улица</label>
                              <input class="form-control" type="text" value="" id="streetSave"
                                     placeholder="Введите улицу">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="houseSave">Номер дома</label>
                              <input class="form-control" type="text" value="" id="houseSave"
                                     placeholder="Введите номер дома">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="birthdaySave">Дата рождения</label>
                              <input class="form-control" type="date" value="" id="birthdaySave">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="genderSave">Выберите пол:</label>
                              <br>
                              <select class="form-select" size="3" id="genderSave" name="gender" required="">
                                 <option id="ManSave" value="MALE">Мужчина</option>
                                 <option id="WomanSave" value="FEMALE">Женщина</option>
                                 <option id="NoGenderSave" value="UNKNOWN">Не определен</option>
                              </select>
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <input type="button" class="btn btn-primary" value="Зарегистрироваться"
                                     onclick="{event.preventDefault(); saveUser()}"/>
                           </div>
                        </div>
                     </form>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>

   <!--HEADER-->
   <div>
      <!--HEADER-->
      <header class="bg-dark text-white" style="height: 44px;">
         <div class="container" style="height: 44px;">
            <div class="d-flex align-items-center justify-content-center justify-content-lg-start"
                 style="height: 44px;">
               <a href="/" class="d-flex align-items-center mb-lg-0 text-white text-decoration-none">
                  <h5 style="margin: 0;">LOGO</h5>
               </a>
               <!--NavBar(HEADER)-->
               <ul class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0 ms-5">
                  <li><a href="/shops" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Магазины</font></font></a></li>
                  <li><a href="#" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Товары</font></font></a></li>
                  <li></li>
                  <li><a href="#" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Ещё...</font></font></a></li>
                  <li></li>
                  <li></li>
               </ul>




               <div class="text-end">


                  <button type="button" id="user_open_modal_btn"
                          class="btn btn-outline-light me-2">Войти
                  </button>
                  <button type="button" id="user_open_modal_reg" class="btn btn-warning">
                     Зарегистрироваться
                  </button>

                  <script>
                     $(document).ready(function () {
                        if (window.location.href !== 'http://localhost:8888/') {
                           $('#user_open_modal_btn').hide();
                        }
                     })
                     $(document).ready(function () {
                        if (window.location.href !== 'http://localhost:8888/') {
                           $('#user_open_modal_reg').hide();
                        }
                     })
                  </script>

                  <!--ссылка и информация пользователя при аутентификации-->
                  
               </div>
            </div>
         </div>
         <nav class="navbar fixed-bottom navbar-light bg-light">
            <a class="navbar-brand" href="/feedback">Обратная связь</a>
         </nav>
      </header>
   </div>

   <!--Main zone-->
   <section class="d-flex">
      <!--Sidebar-->
      <div class="bg-light" style="width: 350px; min-height: 100vh; padding-top: 30px; padding-bottom: 200px">
         <div class="container-fluid">
            <div class="row">
               <div class="col-12 d-flex align-items-center">
                  <h5>Категории</h5>
               </div>

               <div class="col-12 d-flex justify-content-center">
                  <hr style="width: 100%; margin: 0;">
               </div>
               <!--Категории-->
               <div class="col-12 mt-4">
                  <ul class="nav nav-pills flex-column mb-auto">
                     <li class="nav-item">
                        <a id="popular_show_btn" href="#" class="nav-link active" aria-current="page">
                           Популярное
                           </font></font></a>
                     </li>

                     
                        <li class="nav-item">
                           <a id="9" href="#"
                              class="nav-link link-dark" aria-current="page">Автомобили</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="3" href="#"
                              class="nav-link link-dark" aria-current="page">Аксессуары</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="5" href="#"
                              class="nav-link link-dark" aria-current="page">Бытовая техника</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="6" href="#"
                              class="nav-link link-dark" aria-current="page">Детские товары</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="7" href="#"
                              class="nav-link link-dark" aria-current="page">Компьютеры</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="4" href="#"
                              class="nav-link link-dark" aria-current="page">Мебель</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="8" href="#"
                              class="nav-link link-dark" aria-current="page">Мобильные телефоны</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="2" href="#"
                              class="nav-link link-dark" aria-current="page">Обувь</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="1" href="#"
                              class="nav-link link-dark" aria-current="page">Одежда</a>
                        </li>
                     
                  </ul>
               </div>
            </div>
         </div>
      </div>

      <!--Main Body-->
      <div class="container-fluid" style="padding-top: 30px; padding-left: 35px; padding-bottom: 40px;">
         <div class="row">
            <div class="col-12">
               <form style="width: 650px;" class="d-flex">
                  <input id="search_input" type="search" class="form-control" name="search"
                         placeholder="Поиск по наименованию:">
                  <button id="search_btn" type="button" class="btn btn-success" style="width: 150px;">Поиск</button>
               </form>
            </div>

            <!-- QR and enable 2FA -->
            

         <!--Контейнер для динамического контента (js)-->
         <div class="collapse" id="dinamic_content">
            <div class="col-12" style="margin-top: 30px;">
               <h4 id="dinamic_head"></h4>
            </div>
            <!--сюда генерируются товары-->
            <div class="col-12 d-flex flex-wrap mt-3" id="dinamic_content_inner">

               </div>
            </div>

            <!--Контейнер для статического контента (при загрузке страницы)-->
            <div class="collapse show" id="popular_show_content">
               <div class="col-12" style="margin-top: 30px;">
                  <h4>
                     Популярные товары
                  </h4>
               </div>
               <!--Блок популярные товары-->
               <div class="col-12 d-flex flex-wrap mt-3">
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://pe-shop.ru/pictures/product/big/6045_big.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Антисептик для рук</h5>
                           <p class="card-text">Антисептик для рук</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;5&#39;,&#39;1&#39;)">В корзину</a>
                              <a href="/product/5" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton5">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem5"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.ikea.com/ru/ru/images/products/klappa-myagkaya-igrushka-myach-raznocvetnyy__0873096_pe682670_s5.jpg?f=xxs" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Мягкая игрушка</h5>
                           <p class="card-text">Мягкая игрушка</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;10&#39;,&#39;2&#39;)">В корзину</a>
                              <a href="/product/10" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton10">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem10"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.ikea.com/ru/ru/images/products/gulligast-gulligest-mobil__0923957_pe788456_s5.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Мобиль</h5>
                           <p class="card-text">Мобиль</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;11&#39;,&#39;3&#39;)">В корзину</a>
                              <a href="/product/11" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton11">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem11"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.opticmall.ru/assets/images/products/3908/2132-622-17.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Очки RAY BAN</h5>
                           <p class="card-text">Очки RAY BAN</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;4&#39;,&#39;2&#39;)">В корзину</a>
                              <a href="/product/4" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton4">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem4"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://cdn.rbt.ru/images/gen/item_image/image/8507/23/850668_r7634.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Ноутбук Lenovo</h5>
                           <p class="card-text">Ноутбук Lenovo</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;7&#39;,&#39;4&#39;)">В корзину</a>
                              <a href="/product/7" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton7">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem7"></div>
                        </div>
                     </div>
                  

               </div>
               <!--Блок популярные магазины-->
               <div class="col-12" style="margin-top: 30px;">
                  <h4>
                     Популярные магазины
                  </h4>
               </div>

               <div class="col-12 d-flex flex-wrap mt-3">
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/beru.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Яндекс Маркет</h5>
                           <p class="card-text">Одежда, обувь, бытовая техника</p>
                           <a href="/showcase/1" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/lamoda.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Lamoda</h5>
                           <p class="card-text">Одежда, обувь, аксессуары</p>
                           <a href="/showcase/2" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/aliexpress.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">AliExpress</h5>
                           <p class="card-text">Любые товары</p>
                           <a href="/showcase/4" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
               </div>
            </div>

         </div>
      </div>
   </section>

   <script src="https://code.jquery.com/jquery-3.6.0.min.js"
           integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

   <!-- JavaScript Bundle with Popper -->
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
           integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
           crossorigin="anonymous"></script>
   <script>
      /**
       * связано с статическим контентом
       */
      const popular_show_btn = $('#popular_show_btn');
      const popular_show_content = $('#popular_show_content');
      /**
       * динамический контент
       */
      const dinamic_show_content = $('#dinamic_content');
      const dinamic_head = $('#dinamic_head');
      const dinamic_inner_content = $('#dinamic_content_inner');
      /**
       * поиск
       */
      const search_input = $('#search_input');
      const search_btn = $('#search_btn');
      /**
       *  вход в систему и модальное окно входа в систему
       */
      const user_modal = $('#user_modal');
      const user_open_modal_btn = $('#user_open_modal_btn');
      const user_signin_form = $('#user_signin_form');
      const username_input = $('#username_input');
      const password_input = $('#password_input');
      const username_checker = $('#username_checker');
      const password_checker = $('#password_checker');
      const loginModal = $('#loginModal');
      const user_open_modal_reg = $('#user_open_modal_reg');

      $(document).ready(function () {

         /**
          * обработчик
          * проверка корректности отпавленной формы
          */
         $(user_signin_form).on('submit', function (e) {
            username_checker.html('');
            password_checker.html('');
            let username = username_input.val();
            let password = password_input.val();
            if (username === "" || username === " ") {
               username_checker.html('Поле username не должно быть пустым');
               e.preventDefault();
            } else if (password === "" || password === " ") {
               password_checker.html('Поле password не должно быть пустым')
               e.preventDefault();
            }
         })

         /**
          * обработчик
          * открытие модального окна входа в систему
          */
         $(user_open_modal_btn).on('click', function (e) {
            e.preventDefault();
            user_modal.modal('show');
         })
         $(user_open_modal_reg).on('click', function (e) {
            e.preventDefault();
            loginModal.modal('show');
         })

         /**
          * обработчик
          * обработка поиска
          */
         $(search_btn).on('click', function (e) {
            e.preventDefault();
            toggleClassesContent($(this));
            toggleClassesNavBar(null);
            let valueSearch = search_input.val();
            search_input.val('');

            /**
             * обрабочтик
             * проверка на пустое значение поиска
             */
            if (valueSearch === '') {
               dinamic_head.html('');
               dinamic_head.html('Все товары')
            } else {
               dinamic_head.html('');
               dinamic_head.html('Результат запроса "' + valueSearch + '"');
            }
         })

         /**
          * обработчик
          * обработчик на кнопке "популярное" в навбар
          */
         $(popular_show_btn).on('click', function (e) {
            e.preventDefault();
            toggleClassesContent($(this));
            toggleClassesNavBar($(this));
         })

         /**
          * обработчик
          * обработчик на все кнопки в навбар кроме "популярное"
          */
         $('.link-dark').on('click', function (e) {
            e.preventDefault();
            /**
             * переключение стилей кнопок навбара и контейнера с контентом
             */
            toggleClassesContent($(this));
            toggleClassesNavBar($(this));

            /**
             * перезапись категории в заголовок
             */
            let category = $(this).html();
            dinamic_head.html("");
            dinamic_head.html(category);
            /** перезапись динамического контента
             *  товары по категории
             */
            searchByCategory($(this));
         })


      })

      /**
       * отправляет GET запрос на /home/category/id = категории
       * генерирует html из массива итемов на странице
       */
      async function searchByCategory(e) {
         const categoryId = $(e).attr("id");
         const response = await fetch("/category/" + categoryId);
         if (response.ok) {
            let items = await response.json();
            /**
             * Добавляем итемы по категориям на страницу
             * */
            let itemsByCategoryHTML = "";
            for (let i = 0; i < items.length; i++) {
               itemsByCategoryHTML += '<div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">\n' +
                  '                       <img src="' + items[i].images[0] + '" class="card-img-top" alt="popular_item" style="height: 180px;">' +
                  '                           <div class="card-body">\n' +
                  '                                <h5 class="card-title">' + items[i].name + '</h5>' +
                  '                                <p class="card-text">' + items[i].description + '</p>' +
                  '                                <div class="d-flex">\n' +
                  '                                    <a href="#" class="btn btn-danger" style="width: 150px;">В корзину</a>' +
                  '                                    <a href="/product/' + items[i].id + '" class="btn btn-primary" style="margin-left: 10px;">Смотреть</a>' +
                  '                                </div>' +
                  '                           </div>' +
                  '                   </div>';
            }
            dinamic_inner_content.html("");
            dinamic_inner_content.html(itemsByCategoryHTML);
         }
      }

      /**
       * функция переключения классов контейнера с контентом
       */
      function toggleClassesContent(e) {
         if ($(e).is(popular_show_btn)) {
            popular_show_content.addClass('show');
            dinamic_show_content.removeClass('show');
            dinamic_inner_content.html("");
         } else {
            popular_show_content.removeClass('show');
            dinamic_show_content.addClass('show');
         }
      }

      /**
       * функция переключения кнопок в навбар
       */
      function toggleClassesNavBar(e) {
         $('.active').removeClass('active').addClass('link-dark');
         $(e).removeClass('link-dark');
         $(e).addClass('active');
      }

      async function addCartItem(itemId, shopId) {
         // let quant = document.getElementById("itemQuant").value;
         let url = new URL("http://localhost:8888/api/cart/add")
         const response = await fetch(url, {
            method: 'POST',
            headers: {
               "Accept": "application/json",
               "Content-Type": "application/json; charset=utf-8",
            },
            body: JSON.stringify({
               quantity: 1,
               item: {
                  id: itemId
               },
               shop: {
                  id: shopId
               },
            })
         })
      }

      $(async function () {
         await favoriteItem()
      })

      async function favoriteItem() {
         let items = document.getElementsByName("favItems")
         for (let i = 0; i < items.length; i++) {
            let itemDivID = items[i].id;
            let itemId = itemDivID.substr(itemDivID.indexOf("m") + 1, itemDivID.length - itemDivID.indexOf("m") + 1)
            await favoriteButtonItem(itemId);
         }
      }

   </script>
   <script type="text/javascript" src="/js/favoriteHome.js"></script>
   <script type="text/javascript" src="js/registration.js"></script>
   <script type="text/javascript" src="js/signin.js"></script>
   <script type="text/javascript" src="js/twoFactorAuth.js"></script>
</body>
</html>
], template might not exist or might not be accessible by any of the configured Template Resolvers] with root cause
org.thymeleaf.exceptions.TemplateInputException: Error resolving template [<!DOCTYPE html>
<html>
<head>
   <meta charset="UTF-8">
   <title>Главная</title>
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
         integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

   <!-- Не переносите подтягивание jQuery вниз файла, иначе он не сможет его прочитать в header-е, который встраивается
        в начало этой странице -->
   <script src="https://code.jquery.com/jquery-3.6.0.min.js"
           integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
</head>
<body>
   
   
   <!-- модалка для входа юзеру -->
   <div class="modal fade" id="user_modal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
         <div class="modal-content">
            <div class="modal-header">
               <h5 class="modal-title">Войдите в систему</h5>
               <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="user_signin_form" action="/login" method="post">
               <div class="modal-body">
                  <div class="mb-3">
                     <label for="username_input" class="form-label">Введите email:</label>
                     <input id="username_input" type="text" name="j_username" class="form-control"
                            placeholder="Username">
                     <div id="username_checker" class="form-text" style="color:#a40000;"></div>
                  </div>
                  <div class="mb-3">
                     <label for="password_input" class="form-label">Введите пароль:</label>
                     <input id="password_input" type="password" name="j_password" class="form-control"
                            placeholder="Password">
                     <div id="password_checker" class="form-text" style="color:#a40000;"></div>
                  </div>
                  <div class="mb-3">
                     <label for="verification_code_input" class="form-label">
                        Введите код с телефона (если используете 2FA):
                     </label>
                     <input id="verification_code_input" type="text" name="code" class="form-control"
                            placeholder="Verification code">
                  </div>
                  <div class="form-check">
                     <input class="form-check-input" type="checkbox" name="remember-me" id="flexCheckChecked"
                            checked>
                     <label class="form-check-label" for="flexCheckChecked">
                        Запомнить пароль
                     </label>
                  </div>
                  <br>
                  <p align="center">или войдите с помощью:</p>
                  <div class="form-group" align="center">
                     <div class="col-md-3">
                        <a class="btn btn-outline-dark" href="/oauth2/authorization/google" role="button"
                           style="text-transform:none">
                           <img width="20px" style="margin-bottom:3px; margin-right:10px; margin-left:30px"
                                src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/53/Google_%22G%22_Logo.svg/512px-Google_%22G%22_Logo.svg.png"/>
                           Login with google
                        </a>
                     </div>
                  </div>
                  <div class="form-group" align="center">
                     <div class="col-md-3">
                        <a class="btn btn-outline-dark" href="/oauth2/authorization/github" role="button"
                           style="text-transform:none" w>
                           <img width="20px" style="margin-bottom:3px; margin-right:10px; margin-left:30px"
                                src="https://wodensoft.co.uk/wp-content/uploads/2020/05/Github.png"/>
                           Login with github
                        </a>
                     </div>
                  </div>
                  <hr>
                  <p align="center">если вы у нас впервые:</p>
               </div>

               <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Отмена</button>
                  <button type="button" id="user_signin_btn" class="btn btn-primary"
                          onclick="{event.preventDefault(); signin()}">
                     Войти
                  </button>
               </div>
            </form>
         </div>
      </div>
   </div>

   <!-- Модалка для регистрации -->
   <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
         <div class="modal-content" style="width:750px;">
            <div class="modal-body">
               <div class="box">
                  <div class="form loginBox">
                     <b></b>
                     <b></b>

                     <form>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="usernameSave">Имя пользователя</label>
                              <input class="form-control" type="text" value="" id="usernameSave" required
                                     minlength="4"
                                     placeholder="Введите имя пользователя">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="emailSave">Адрес электронной почты</label>
                              <input class="form-control" type="email" value="" id="emailSave"
                                     pattern="^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}"
                                     title="в формате user@example.com" required
                                     placeholder="Введите адрес электронной почты">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="passwordSave">Пароль</label>
                              <input class="form-control" type="password" value="" id="passwordSave" required
                                     minlength="6"
                                     placeholder="Введите пароль">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="phoneSave">Номер телефона</label>
                              <input class="form-control" type="text" value="" id="phoneSave" required
                                     minlength="11" pattern="[0-9]+"
                                     title="указать цифрами" placeholder="Введите номер телефона">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="first_nameSave">Имя</label>
                              <input class="form-control" type="text" value="" id="first_nameSave"
                                     placeholder="Введите имя">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="last_nameSave">Фамилия</label>
                              <input class="form-control" type="text" value="" id="last_nameSave"
                                     placeholder="Введите фамилию">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="ageSave">Возраст</label>
                              <input class="form-control" type="number" value="" id="ageSave"
                                     placeholder="Введите возраст">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-2">
                              <label class="form-label" for="countrySave">Страна</label>
                              <input class="form-control" type="text" value="" id="countrySave"
                                     placeholder="Введите страну">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="citySave">Город</label>
                              <input class="form-control" type="text" value="" id="citySave"
                                     placeholder="Введите город">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="cityIndexSave">Индекс города</label>
                              <input class="form-control" type="text" value="" id="cityIndexSave"
                                     placeholder="Введите индекс города">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-2">
                              <label class="form-label" for="streetSave">Улица</label>
                              <input class="form-control" type="text" value="" id="streetSave"
                                     placeholder="Введите улицу">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="houseSave">Номер дома</label>
                              <input class="form-control" type="text" value="" id="houseSave"
                                     placeholder="Введите номер дома">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="birthdaySave">Дата рождения</label>
                              <input class="form-control" type="date" value="" id="birthdaySave">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="genderSave">Выберите пол:</label>
                              <br>
                              <select class="form-select" size="3" id="genderSave" name="gender" required="">
                                 <option id="ManSave" value="MALE">Мужчина</option>
                                 <option id="WomanSave" value="FEMALE">Женщина</option>
                                 <option id="NoGenderSave" value="UNKNOWN">Не определен</option>
                              </select>
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <input type="button" class="btn btn-primary" value="Зарегистрироваться"
                                     onclick="{event.preventDefault(); saveUser()}"/>
                           </div>
                        </div>
                     </form>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>

   <!--HEADER-->
   <div>
      <!--HEADER-->
      <header class="bg-dark text-white" style="height: 44px;">
         <div class="container" style="height: 44px;">
            <div class="d-flex align-items-center justify-content-center justify-content-lg-start"
                 style="height: 44px;">
               <a href="/" class="d-flex align-items-center mb-lg-0 text-white text-decoration-none">
                  <h5 style="margin: 0;">LOGO</h5>
               </a>
               <!--NavBar(HEADER)-->
               <ul class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0 ms-5">
                  <li><a href="/shops" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Магазины</font></font></a></li>
                  <li><a href="#" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Товары</font></font></a></li>
                  <li></li>
                  <li><a href="#" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Ещё...</font></font></a></li>
                  <li></li>
                  <li></li>
               </ul>




               <div class="text-end">


                  <button type="button" id="user_open_modal_btn"
                          class="btn btn-outline-light me-2">Войти
                  </button>
                  <button type="button" id="user_open_modal_reg" class="btn btn-warning">
                     Зарегистрироваться
                  </button>

                  <script>
                     $(document).ready(function () {
                        if (window.location.href !== 'http://localhost:8888/') {
                           $('#user_open_modal_btn').hide();
                        }
                     })
                     $(document).ready(function () {
                        if (window.location.href !== 'http://localhost:8888/') {
                           $('#user_open_modal_reg').hide();
                        }
                     })
                  </script>

                  <!--ссылка и информация пользователя при аутентификации-->
                  
               </div>
            </div>
         </div>
         <nav class="navbar fixed-bottom navbar-light bg-light">
            <a class="navbar-brand" href="/feedback">Обратная связь</a>
         </nav>
      </header>
   </div>

   <!--Main zone-->
   <section class="d-flex">
      <!--Sidebar-->
      <div class="bg-light" style="width: 350px; min-height: 100vh; padding-top: 30px; padding-bottom: 200px">
         <div class="container-fluid">
            <div class="row">
               <div class="col-12 d-flex align-items-center">
                  <h5>Категории</h5>
               </div>

               <div class="col-12 d-flex justify-content-center">
                  <hr style="width: 100%; margin: 0;">
               </div>
               <!--Категории-->
               <div class="col-12 mt-4">
                  <ul class="nav nav-pills flex-column mb-auto">
                     <li class="nav-item">
                        <a id="popular_show_btn" href="#" class="nav-link active" aria-current="page">
                           Популярное
                           </font></font></a>
                     </li>

                     
                        <li class="nav-item">
                           <a id="9" href="#"
                              class="nav-link link-dark" aria-current="page">Автомобили</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="3" href="#"
                              class="nav-link link-dark" aria-current="page">Аксессуары</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="5" href="#"
                              class="nav-link link-dark" aria-current="page">Бытовая техника</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="6" href="#"
                              class="nav-link link-dark" aria-current="page">Детские товары</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="7" href="#"
                              class="nav-link link-dark" aria-current="page">Компьютеры</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="4" href="#"
                              class="nav-link link-dark" aria-current="page">Мебель</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="8" href="#"
                              class="nav-link link-dark" aria-current="page">Мобильные телефоны</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="2" href="#"
                              class="nav-link link-dark" aria-current="page">Обувь</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="1" href="#"
                              class="nav-link link-dark" aria-current="page">Одежда</a>
                        </li>
                     
                  </ul>
               </div>
            </div>
         </div>
      </div>

      <!--Main Body-->
      <div class="container-fluid" style="padding-top: 30px; padding-left: 35px; padding-bottom: 40px;">
         <div class="row">
            <div class="col-12">
               <form style="width: 650px;" class="d-flex">
                  <input id="search_input" type="search" class="form-control" name="search"
                         placeholder="Поиск по наименованию:">
                  <button id="search_btn" type="button" class="btn btn-success" style="width: 150px;">Поиск</button>
               </form>
            </div>

            <!-- QR and enable 2FA -->
            

         <!--Контейнер для динамического контента (js)-->
         <div class="collapse" id="dinamic_content">
            <div class="col-12" style="margin-top: 30px;">
               <h4 id="dinamic_head"></h4>
            </div>
            <!--сюда генерируются товары-->
            <div class="col-12 d-flex flex-wrap mt-3" id="dinamic_content_inner">

               </div>
            </div>

            <!--Контейнер для статического контента (при загрузке страницы)-->
            <div class="collapse show" id="popular_show_content">
               <div class="col-12" style="margin-top: 30px;">
                  <h4>
                     Популярные товары
                  </h4>
               </div>
               <!--Блок популярные товары-->
               <div class="col-12 d-flex flex-wrap mt-3">
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://pe-shop.ru/pictures/product/big/6045_big.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Антисептик для рук</h5>
                           <p class="card-text">Антисептик для рук</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;5&#39;,&#39;1&#39;)">В корзину</a>
                              <a href="/product/5" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton5">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem5"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.ikea.com/ru/ru/images/products/klappa-myagkaya-igrushka-myach-raznocvetnyy__0873096_pe682670_s5.jpg?f=xxs" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Мягкая игрушка</h5>
                           <p class="card-text">Мягкая игрушка</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;10&#39;,&#39;2&#39;)">В корзину</a>
                              <a href="/product/10" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton10">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem10"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.ikea.com/ru/ru/images/products/gulligast-gulligest-mobil__0923957_pe788456_s5.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Мобиль</h5>
                           <p class="card-text">Мобиль</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;11&#39;,&#39;3&#39;)">В корзину</a>
                              <a href="/product/11" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton11">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem11"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.opticmall.ru/assets/images/products/3908/2132-622-17.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Очки RAY BAN</h5>
                           <p class="card-text">Очки RAY BAN</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;4&#39;,&#39;2&#39;)">В корзину</a>
                              <a href="/product/4" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton4">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem4"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://cdn.rbt.ru/images/gen/item_image/image/8507/23/850668_r7634.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Ноутбук Lenovo</h5>
                           <p class="card-text">Ноутбук Lenovo</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;7&#39;,&#39;4&#39;)">В корзину</a>
                              <a href="/product/7" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton7">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem7"></div>
                        </div>
                     </div>
                  

               </div>
               <!--Блок популярные магазины-->
               <div class="col-12" style="margin-top: 30px;">
                  <h4>
                     Популярные магазины
                  </h4>
               </div>

               <div class="col-12 d-flex flex-wrap mt-3">
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/beru.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Яндекс Маркет</h5>
                           <p class="card-text">Одежда, обувь, бытовая техника</p>
                           <a href="/showcase/1" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/lamoda.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Lamoda</h5>
                           <p class="card-text">Одежда, обувь, аксессуары</p>
                           <a href="/showcase/2" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/aliexpress.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">AliExpress</h5>
                           <p class="card-text">Любые товары</p>
                           <a href="/showcase/4" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
               </div>
            </div>

         </div>
      </div>
   </section>

   <script src="https://code.jquery.com/jquery-3.6.0.min.js"
           integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

   <!-- JavaScript Bundle with Popper -->
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
           integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
           crossorigin="anonymous"></script>
   <script>
      /**
       * связано с статическим контентом
       */
      const popular_show_btn = $('#popular_show_btn');
      const popular_show_content = $('#popular_show_content');
      /**
       * динамический контент
       */
      const dinamic_show_content = $('#dinamic_content');
      const dinamic_head = $('#dinamic_head');
      const dinamic_inner_content = $('#dinamic_content_inner');
      /**
       * поиск
       */
      const search_input = $('#search_input');
      const search_btn = $('#search_btn');
      /**
       *  вход в систему и модальное окно входа в систему
       */
      const user_modal = $('#user_modal');
      const user_open_modal_btn = $('#user_open_modal_btn');
      const user_signin_form = $('#user_signin_form');
      const username_input = $('#username_input');
      const password_input = $('#password_input');
      const username_checker = $('#username_checker');
      const password_checker = $('#password_checker');
      const loginModal = $('#loginModal');
      const user_open_modal_reg = $('#user_open_modal_reg');

      $(document).ready(function () {

         /**
          * обработчик
          * проверка корректности отпавленной формы
          */
         $(user_signin_form).on('submit', function (e) {
            username_checker.html('');
            password_checker.html('');
            let username = username_input.val();
            let password = password_input.val();
            if (username === "" || username === " ") {
               username_checker.html('Поле username не должно быть пустым');
               e.preventDefault();
            } else if (password === "" || password === " ") {
               password_checker.html('Поле password не должно быть пустым')
               e.preventDefault();
            }
         })

         /**
          * обработчик
          * открытие модального окна входа в систему
          */
         $(user_open_modal_btn).on('click', function (e) {
            e.preventDefault();
            user_modal.modal('show');
         })
         $(user_open_modal_reg).on('click', function (e) {
            e.preventDefault();
            loginModal.modal('show');
         })

         /**
          * обработчик
          * обработка поиска
          */
         $(search_btn).on('click', function (e) {
            e.preventDefault();
            toggleClassesContent($(this));
            toggleClassesNavBar(null);
            let valueSearch = search_input.val();
            search_input.val('');

            /**
             * обрабочтик
             * проверка на пустое значение поиска
             */
            if (valueSearch === '') {
               dinamic_head.html('');
               dinamic_head.html('Все товары')
            } else {
               dinamic_head.html('');
               dinamic_head.html('Результат запроса "' + valueSearch + '"');
            }
         })

         /**
          * обработчик
          * обработчик на кнопке "популярное" в навбар
          */
         $(popular_show_btn).on('click', function (e) {
            e.preventDefault();
            toggleClassesContent($(this));
            toggleClassesNavBar($(this));
         })

         /**
          * обработчик
          * обработчик на все кнопки в навбар кроме "популярное"
          */
         $('.link-dark').on('click', function (e) {
            e.preventDefault();
            /**
             * переключение стилей кнопок навбара и контейнера с контентом
             */
            toggleClassesContent($(this));
            toggleClassesNavBar($(this));

            /**
             * перезапись категории в заголовок
             */
            let category = $(this).html();
            dinamic_head.html("");
            dinamic_head.html(category);
            /** перезапись динамического контента
             *  товары по категории
             */
            searchByCategory($(this));
         })


      })

      /**
       * отправляет GET запрос на /home/category/id = категории
       * генерирует html из массива итемов на странице
       */
      async function searchByCategory(e) {
         const categoryId = $(e).attr("id");
         const response = await fetch("/category/" + categoryId);
         if (response.ok) {
            let items = await response.json();
            /**
             * Добавляем итемы по категориям на страницу
             * */
            let itemsByCategoryHTML = "";
            for (let i = 0; i < items.length; i++) {
               itemsByCategoryHTML += '<div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">\n' +
                  '                       <img src="' + items[i].images[0] + '" class="card-img-top" alt="popular_item" style="height: 180px;">' +
                  '                           <div class="card-body">\n' +
                  '                                <h5 class="card-title">' + items[i].name + '</h5>' +
                  '                                <p class="card-text">' + items[i].description + '</p>' +
                  '                                <div class="d-flex">\n' +
                  '                                    <a href="#" class="btn btn-danger" style="width: 150px;">В корзину</a>' +
                  '                                    <a href="/product/' + items[i].id + '" class="btn btn-primary" style="margin-left: 10px;">Смотреть</a>' +
                  '                                </div>' +
                  '                           </div>' +
                  '                   </div>';
            }
            dinamic_inner_content.html("");
            dinamic_inner_content.html(itemsByCategoryHTML);
         }
      }

      /**
       * функция переключения классов контейнера с контентом
       */
      function toggleClassesContent(e) {
         if ($(e).is(popular_show_btn)) {
            popular_show_content.addClass('show');
            dinamic_show_content.removeClass('show');
            dinamic_inner_content.html("");
         } else {
            popular_show_content.removeClass('show');
            dinamic_show_content.addClass('show');
         }
      }

      /**
       * функция переключения кнопок в навбар
       */
      function toggleClassesNavBar(e) {
         $('.active').removeClass('active').addClass('link-dark');
         $(e).removeClass('link-dark');
         $(e).addClass('active');
      }

      async function addCartItem(itemId, shopId) {
         // let quant = document.getElementById("itemQuant").value;
         let url = new URL("http://localhost:8888/api/cart/add")
         const response = await fetch(url, {
            method: 'POST',
            headers: {
               "Accept": "application/json",
               "Content-Type": "application/json; charset=utf-8",
            },
            body: JSON.stringify({
               quantity: 1,
               item: {
                  id: itemId
               },
               shop: {
                  id: shopId
               },
            })
         })
      }

      $(async function () {
         await favoriteItem()
      })

      async function favoriteItem() {
         let items = document.getElementsByName("favItems")
         for (let i = 0; i < items.length; i++) {
            let itemDivID = items[i].id;
            let itemId = itemDivID.substr(itemDivID.indexOf("m") + 1, itemDivID.length - itemDivID.indexOf("m") + 1)
            await favoriteButtonItem(itemId);
         }
      }

   </script>
   <script type="text/javascript" src="/js/favoriteHome.js"></script>
   <script type="text/javascript" src="js/registration.js"></script>
   <script type="text/javascript" src="js/signin.js"></script>
   <script type="text/javascript" src="js/twoFactorAuth.js"></script>
</body>
</html>
], template might not exist or might not be accessible by any of the configured Template Resolvers
	at org.thymeleaf.engine.TemplateManager.resolveTemplate(TemplateManager.java:869)
	at org.thymeleaf.engine.TemplateManager.parseAndProcess(TemplateManager.java:607)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1098)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1072)
	at org.thymeleaf.spring5.view.ThymeleafView.renderFragment(ThymeleafView.java:366)
	at org.thymeleaf.spring5.view.ThymeleafView.render(ThymeleafView.java:190)
	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1397)
	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1142)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1081)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:655)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:327)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:121)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:115)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:105)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:218)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:212)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:110)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:80)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:211)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:183)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:358)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:271)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:94)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1726)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:829)
2021-11-03 13:41:11,873 ERROR org.thymeleaf.TemplateEngine [http-nio-80-exec-7] [THYMELEAF][http-nio-80-exec-7] Exception processing template "<!DOCTYPE html>
 <html>
 <head>
   [...]t type="text/javascript" src="js/twoFactorAuth.js"></script>
 </body>
 </html>
 ": Error resolving template [<!DOCTYPE html>
<html>
<head>
   <meta charset="UTF-8">
   <title>Главная</title>
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
         integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

   <!-- Не переносите подтягивание jQuery вниз файла, иначе он не сможет его прочитать в header-е, который встраивается
        в начало этой странице -->
   <script src="https://code.jquery.com/jquery-3.6.0.min.js"
           integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
</head>
<body>
   
   
   <!-- модалка для входа юзеру -->
   <div class="modal fade" id="user_modal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
         <div class="modal-content">
            <div class="modal-header">
               <h5 class="modal-title">Войдите в систему</h5>
               <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="user_signin_form" action="/login" method="post">
               <div class="modal-body">
                  <div class="mb-3">
                     <label for="username_input" class="form-label">Введите email:</label>
                     <input id="username_input" type="text" name="j_username" class="form-control"
                            placeholder="Username">
                     <div id="username_checker" class="form-text" style="color:#a40000;"></div>
                  </div>
                  <div class="mb-3">
                     <label for="password_input" class="form-label">Введите пароль:</label>
                     <input id="password_input" type="password" name="j_password" class="form-control"
                            placeholder="Password">
                     <div id="password_checker" class="form-text" style="color:#a40000;"></div>
                  </div>
                  <div class="mb-3">
                     <label for="verification_code_input" class="form-label">
                        Введите код с телефона (если используете 2FA):
                     </label>
                     <input id="verification_code_input" type="text" name="code" class="form-control"
                            placeholder="Verification code">
                  </div>
                  <div class="form-check">
                     <input class="form-check-input" type="checkbox" name="remember-me" id="flexCheckChecked"
                            checked>
                     <label class="form-check-label" for="flexCheckChecked">
                        Запомнить пароль
                     </label>
                  </div>
                  <br>
                  <p align="center">или войдите с помощью:</p>
                  <div class="form-group" align="center">
                     <div class="col-md-3">
                        <a class="btn btn-outline-dark" href="/oauth2/authorization/google" role="button"
                           style="text-transform:none">
                           <img width="20px" style="margin-bottom:3px; margin-right:10px; margin-left:30px"
                                src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/53/Google_%22G%22_Logo.svg/512px-Google_%22G%22_Logo.svg.png"/>
                           Login with google
                        </a>
                     </div>
                  </div>
                  <div class="form-group" align="center">
                     <div class="col-md-3">
                        <a class="btn btn-outline-dark" href="/oauth2/authorization/github" role="button"
                           style="text-transform:none" w>
                           <img width="20px" style="margin-bottom:3px; margin-right:10px; margin-left:30px"
                                src="https://wodensoft.co.uk/wp-content/uploads/2020/05/Github.png"/>
                           Login with github
                        </a>
                     </div>
                  </div>
                  <hr>
                  <p align="center">если вы у нас впервые:</p>
               </div>

               <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Отмена</button>
                  <button type="button" id="user_signin_btn" class="btn btn-primary"
                          onclick="{event.preventDefault(); signin()}">
                     Войти
                  </button>
               </div>
            </form>
         </div>
      </div>
   </div>

   <!-- Модалка для регистрации -->
   <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
         <div class="modal-content" style="width:750px;">
            <div class="modal-body">
               <div class="box">
                  <div class="form loginBox">
                     <b></b>
                     <b></b>

                     <form>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="usernameSave">Имя пользователя</label>
                              <input class="form-control" type="text" value="" id="usernameSave" required
                                     minlength="4"
                                     placeholder="Введите имя пользователя">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="emailSave">Адрес электронной почты</label>
                              <input class="form-control" type="email" value="" id="emailSave"
                                     pattern="^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}"
                                     title="в формате user@example.com" required
                                     placeholder="Введите адрес электронной почты">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="passwordSave">Пароль</label>
                              <input class="form-control" type="password" value="" id="passwordSave" required
                                     minlength="6"
                                     placeholder="Введите пароль">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="phoneSave">Номер телефона</label>
                              <input class="form-control" type="text" value="" id="phoneSave" required
                                     minlength="11" pattern="[0-9]+"
                                     title="указать цифрами" placeholder="Введите номер телефона">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="first_nameSave">Имя</label>
                              <input class="form-control" type="text" value="" id="first_nameSave"
                                     placeholder="Введите имя">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="last_nameSave">Фамилия</label>
                              <input class="form-control" type="text" value="" id="last_nameSave"
                                     placeholder="Введите фамилию">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="ageSave">Возраст</label>
                              <input class="form-control" type="number" value="" id="ageSave"
                                     placeholder="Введите возраст">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-2">
                              <label class="form-label" for="countrySave">Страна</label>
                              <input class="form-control" type="text" value="" id="countrySave"
                                     placeholder="Введите страну">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="citySave">Город</label>
                              <input class="form-control" type="text" value="" id="citySave"
                                     placeholder="Введите город">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="cityIndexSave">Индекс города</label>
                              <input class="form-control" type="text" value="" id="cityIndexSave"
                                     placeholder="Введите индекс города">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-2">
                              <label class="form-label" for="streetSave">Улица</label>
                              <input class="form-control" type="text" value="" id="streetSave"
                                     placeholder="Введите улицу">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="houseSave">Номер дома</label>
                              <input class="form-control" type="text" value="" id="houseSave"
                                     placeholder="Введите номер дома">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="birthdaySave">Дата рождения</label>
                              <input class="form-control" type="date" value="" id="birthdaySave">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="genderSave">Выберите пол:</label>
                              <br>
                              <select class="form-select" size="3" id="genderSave" name="gender" required="">
                                 <option id="ManSave" value="MALE">Мужчина</option>
                                 <option id="WomanSave" value="FEMALE">Женщина</option>
                                 <option id="NoGenderSave" value="UNKNOWN">Не определен</option>
                              </select>
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <input type="button" class="btn btn-primary" value="Зарегистрироваться"
                                     onclick="{event.preventDefault(); saveUser()}"/>
                           </div>
                        </div>
                     </form>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>

   <!--HEADER-->
   <div>
      <!--HEADER-->
      <header class="bg-dark text-white" style="height: 44px;">
         <div class="container" style="height: 44px;">
            <div class="d-flex align-items-center justify-content-center justify-content-lg-start"
                 style="height: 44px;">
               <a href="/" class="d-flex align-items-center mb-lg-0 text-white text-decoration-none">
                  <h5 style="margin: 0;">LOGO</h5>
               </a>
               <!--NavBar(HEADER)-->
               <ul class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0 ms-5">
                  <li><a href="/shops" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Магазины</font></font></a></li>
                  <li><a href="#" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Товары</font></font></a></li>
                  <li></li>
                  <li><a href="#" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Ещё...</font></font></a></li>
                  <li></li>
                  <li></li>
               </ul>




               <div class="text-end">


                  <button type="button" id="user_open_modal_btn"
                          class="btn btn-outline-light me-2">Войти
                  </button>
                  <button type="button" id="user_open_modal_reg" class="btn btn-warning">
                     Зарегистрироваться
                  </button>

                  <script>
                     $(document).ready(function () {
                        if (window.location.href !== 'http://localhost:8888/') {
                           $('#user_open_modal_btn').hide();
                        }
                     })
                     $(document).ready(function () {
                        if (window.location.href !== 'http://localhost:8888/') {
                           $('#user_open_modal_reg').hide();
                        }
                     })
                  </script>

                  <!--ссылка и информация пользователя при аутентификации-->
                  
               </div>
            </div>
         </div>
         <nav class="navbar fixed-bottom navbar-light bg-light">
            <a class="navbar-brand" href="/feedback">Обратная связь</a>
         </nav>
      </header>
   </div>

   <!--Main zone-->
   <section class="d-flex">
      <!--Sidebar-->
      <div class="bg-light" style="width: 350px; min-height: 100vh; padding-top: 30px; padding-bottom: 200px">
         <div class="container-fluid">
            <div class="row">
               <div class="col-12 d-flex align-items-center">
                  <h5>Категории</h5>
               </div>

               <div class="col-12 d-flex justify-content-center">
                  <hr style="width: 100%; margin: 0;">
               </div>
               <!--Категории-->
               <div class="col-12 mt-4">
                  <ul class="nav nav-pills flex-column mb-auto">
                     <li class="nav-item">
                        <a id="popular_show_btn" href="#" class="nav-link active" aria-current="page">
                           Популярное
                           </font></font></a>
                     </li>

                     
                        <li class="nav-item">
                           <a id="9" href="#"
                              class="nav-link link-dark" aria-current="page">Автомобили</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="3" href="#"
                              class="nav-link link-dark" aria-current="page">Аксессуары</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="5" href="#"
                              class="nav-link link-dark" aria-current="page">Бытовая техника</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="6" href="#"
                              class="nav-link link-dark" aria-current="page">Детские товары</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="7" href="#"
                              class="nav-link link-dark" aria-current="page">Компьютеры</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="4" href="#"
                              class="nav-link link-dark" aria-current="page">Мебель</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="8" href="#"
                              class="nav-link link-dark" aria-current="page">Мобильные телефоны</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="2" href="#"
                              class="nav-link link-dark" aria-current="page">Обувь</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="1" href="#"
                              class="nav-link link-dark" aria-current="page">Одежда</a>
                        </li>
                     
                  </ul>
               </div>
            </div>
         </div>
      </div>

      <!--Main Body-->
      <div class="container-fluid" style="padding-top: 30px; padding-left: 35px; padding-bottom: 40px;">
         <div class="row">
            <div class="col-12">
               <form style="width: 650px;" class="d-flex">
                  <input id="search_input" type="search" class="form-control" name="search"
                         placeholder="Поиск по наименованию:">
                  <button id="search_btn" type="button" class="btn btn-success" style="width: 150px;">Поиск</button>
               </form>
            </div>

            <!-- QR and enable 2FA -->
            

         <!--Контейнер для динамического контента (js)-->
         <div class="collapse" id="dinamic_content">
            <div class="col-12" style="margin-top: 30px;">
               <h4 id="dinamic_head"></h4>
            </div>
            <!--сюда генерируются товары-->
            <div class="col-12 d-flex flex-wrap mt-3" id="dinamic_content_inner">

               </div>
            </div>

            <!--Контейнер для статического контента (при загрузке страницы)-->
            <div class="collapse show" id="popular_show_content">
               <div class="col-12" style="margin-top: 30px;">
                  <h4>
                     Популярные товары
                  </h4>
               </div>
               <!--Блок популярные товары-->
               <div class="col-12 d-flex flex-wrap mt-3">
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://pe-shop.ru/pictures/product/big/6045_big.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Антисептик для рук</h5>
                           <p class="card-text">Антисептик для рук</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;5&#39;,&#39;1&#39;)">В корзину</a>
                              <a href="/product/5" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton5">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem5"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.ikea.com/ru/ru/images/products/klappa-myagkaya-igrushka-myach-raznocvetnyy__0873096_pe682670_s5.jpg?f=xxs" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Мягкая игрушка</h5>
                           <p class="card-text">Мягкая игрушка</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;10&#39;,&#39;2&#39;)">В корзину</a>
                              <a href="/product/10" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton10">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem10"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.ikea.com/ru/ru/images/products/gulligast-gulligest-mobil__0923957_pe788456_s5.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Мобиль</h5>
                           <p class="card-text">Мобиль</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;11&#39;,&#39;3&#39;)">В корзину</a>
                              <a href="/product/11" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton11">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem11"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.opticmall.ru/assets/images/products/3908/2132-622-17.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Очки RAY BAN</h5>
                           <p class="card-text">Очки RAY BAN</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;4&#39;,&#39;2&#39;)">В корзину</a>
                              <a href="/product/4" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton4">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem4"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://cdn.rbt.ru/images/gen/item_image/image/8507/23/850668_r7634.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Ноутбук Lenovo</h5>
                           <p class="card-text">Ноутбук Lenovo</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;7&#39;,&#39;4&#39;)">В корзину</a>
                              <a href="/product/7" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton7">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem7"></div>
                        </div>
                     </div>
                  

               </div>
               <!--Блок популярные магазины-->
               <div class="col-12" style="margin-top: 30px;">
                  <h4>
                     Популярные магазины
                  </h4>
               </div>

               <div class="col-12 d-flex flex-wrap mt-3">
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/beru.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Яндекс Маркет</h5>
                           <p class="card-text">Одежда, обувь, бытовая техника</p>
                           <a href="/showcase/1" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/lamoda.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Lamoda</h5>
                           <p class="card-text">Одежда, обувь, аксессуары</p>
                           <a href="/showcase/2" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/aliexpress.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">AliExpress</h5>
                           <p class="card-text">Любые товары</p>
                           <a href="/showcase/4" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
               </div>
            </div>

         </div>
      </div>
   </section>

   <script src="https://code.jquery.com/jquery-3.6.0.min.js"
           integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

   <!-- JavaScript Bundle with Popper -->
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
           integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
           crossorigin="anonymous"></script>
   <script>
      /**
       * связано с статическим контентом
       */
      const popular_show_btn = $('#popular_show_btn');
      const popular_show_content = $('#popular_show_content');
      /**
       * динамический контент
       */
      const dinamic_show_content = $('#dinamic_content');
      const dinamic_head = $('#dinamic_head');
      const dinamic_inner_content = $('#dinamic_content_inner');
      /**
       * поиск
       */
      const search_input = $('#search_input');
      const search_btn = $('#search_btn');
      /**
       *  вход в систему и модальное окно входа в систему
       */
      const user_modal = $('#user_modal');
      const user_open_modal_btn = $('#user_open_modal_btn');
      const user_signin_form = $('#user_signin_form');
      const username_input = $('#username_input');
      const password_input = $('#password_input');
      const username_checker = $('#username_checker');
      const password_checker = $('#password_checker');
      const loginModal = $('#loginModal');
      const user_open_modal_reg = $('#user_open_modal_reg');

      $(document).ready(function () {

         /**
          * обработчик
          * проверка корректности отпавленной формы
          */
         $(user_signin_form).on('submit', function (e) {
            username_checker.html('');
            password_checker.html('');
            let username = username_input.val();
            let password = password_input.val();
            if (username === "" || username === " ") {
               username_checker.html('Поле username не должно быть пустым');
               e.preventDefault();
            } else if (password === "" || password === " ") {
               password_checker.html('Поле password не должно быть пустым')
               e.preventDefault();
            }
         })

         /**
          * обработчик
          * открытие модального окна входа в систему
          */
         $(user_open_modal_btn).on('click', function (e) {
            e.preventDefault();
            user_modal.modal('show');
         })
         $(user_open_modal_reg).on('click', function (e) {
            e.preventDefault();
            loginModal.modal('show');
         })

         /**
          * обработчик
          * обработка поиска
          */
         $(search_btn).on('click', function (e) {
            e.preventDefault();
            toggleClassesContent($(this));
            toggleClassesNavBar(null);
            let valueSearch = search_input.val();
            search_input.val('');

            /**
             * обрабочтик
             * проверка на пустое значение поиска
             */
            if (valueSearch === '') {
               dinamic_head.html('');
               dinamic_head.html('Все товары')
            } else {
               dinamic_head.html('');
               dinamic_head.html('Результат запроса "' + valueSearch + '"');
            }
         })

         /**
          * обработчик
          * обработчик на кнопке "популярное" в навбар
          */
         $(popular_show_btn).on('click', function (e) {
            e.preventDefault();
            toggleClassesContent($(this));
            toggleClassesNavBar($(this));
         })

         /**
          * обработчик
          * обработчик на все кнопки в навбар кроме "популярное"
          */
         $('.link-dark').on('click', function (e) {
            e.preventDefault();
            /**
             * переключение стилей кнопок навбара и контейнера с контентом
             */
            toggleClassesContent($(this));
            toggleClassesNavBar($(this));

            /**
             * перезапись категории в заголовок
             */
            let category = $(this).html();
            dinamic_head.html("");
            dinamic_head.html(category);
            /** перезапись динамического контента
             *  товары по категории
             */
            searchByCategory($(this));
         })


      })

      /**
       * отправляет GET запрос на /home/category/id = категории
       * генерирует html из массива итемов на странице
       */
      async function searchByCategory(e) {
         const categoryId = $(e).attr("id");
         const response = await fetch("/category/" + categoryId);
         if (response.ok) {
            let items = await response.json();
            /**
             * Добавляем итемы по категориям на страницу
             * */
            let itemsByCategoryHTML = "";
            for (let i = 0; i < items.length; i++) {
               itemsByCategoryHTML += '<div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">\n' +
                  '                       <img src="' + items[i].images[0] + '" class="card-img-top" alt="popular_item" style="height: 180px;">' +
                  '                           <div class="card-body">\n' +
                  '                                <h5 class="card-title">' + items[i].name + '</h5>' +
                  '                                <p class="card-text">' + items[i].description + '</p>' +
                  '                                <div class="d-flex">\n' +
                  '                                    <a href="#" class="btn btn-danger" style="width: 150px;">В корзину</a>' +
                  '                                    <a href="/product/' + items[i].id + '" class="btn btn-primary" style="margin-left: 10px;">Смотреть</a>' +
                  '                                </div>' +
                  '                           </div>' +
                  '                   </div>';
            }
            dinamic_inner_content.html("");
            dinamic_inner_content.html(itemsByCategoryHTML);
         }
      }

      /**
       * функция переключения классов контейнера с контентом
       */
      function toggleClassesContent(e) {
         if ($(e).is(popular_show_btn)) {
            popular_show_content.addClass('show');
            dinamic_show_content.removeClass('show');
            dinamic_inner_content.html("");
         } else {
            popular_show_content.removeClass('show');
            dinamic_show_content.addClass('show');
         }
      }

      /**
       * функция переключения кнопок в навбар
       */
      function toggleClassesNavBar(e) {
         $('.active').removeClass('active').addClass('link-dark');
         $(e).removeClass('link-dark');
         $(e).addClass('active');
      }

      async function addCartItem(itemId, shopId) {
         // let quant = document.getElementById("itemQuant").value;
         let url = new URL("http://localhost:8888/api/cart/add")
         const response = await fetch(url, {
            method: 'POST',
            headers: {
               "Accept": "application/json",
               "Content-Type": "application/json; charset=utf-8",
            },
            body: JSON.stringify({
               quantity: 1,
               item: {
                  id: itemId
               },
               shop: {
                  id: shopId
               },
            })
         })
      }

      $(async function () {
         await favoriteItem()
      })

      async function favoriteItem() {
         let items = document.getElementsByName("favItems")
         for (let i = 0; i < items.length; i++) {
            let itemDivID = items[i].id;
            let itemId = itemDivID.substr(itemDivID.indexOf("m") + 1, itemDivID.length - itemDivID.indexOf("m") + 1)
            await favoriteButtonItem(itemId);
         }
      }

   </script>
   <script type="text/javascript" src="/js/favoriteHome.js"></script>
   <script type="text/javascript" src="js/registration.js"></script>
   <script type="text/javascript" src="js/signin.js"></script>
   <script type="text/javascript" src="js/twoFactorAuth.js"></script>
</body>
</html>
], template might not exist or might not be accessible by any of the configured Template Resolvers
org.thymeleaf.exceptions.TemplateInputException: Error resolving template [<!DOCTYPE html>
<html>
<head>
   <meta charset="UTF-8">
   <title>Главная</title>
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
         integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

   <!-- Не переносите подтягивание jQuery вниз файла, иначе он не сможет его прочитать в header-е, который встраивается
        в начало этой странице -->
   <script src="https://code.jquery.com/jquery-3.6.0.min.js"
           integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
</head>
<body>
   
   
   <!-- модалка для входа юзеру -->
   <div class="modal fade" id="user_modal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
         <div class="modal-content">
            <div class="modal-header">
               <h5 class="modal-title">Войдите в систему</h5>
               <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="user_signin_form" action="/login" method="post">
               <div class="modal-body">
                  <div class="mb-3">
                     <label for="username_input" class="form-label">Введите email:</label>
                     <input id="username_input" type="text" name="j_username" class="form-control"
                            placeholder="Username">
                     <div id="username_checker" class="form-text" style="color:#a40000;"></div>
                  </div>
                  <div class="mb-3">
                     <label for="password_input" class="form-label">Введите пароль:</label>
                     <input id="password_input" type="password" name="j_password" class="form-control"
                            placeholder="Password">
                     <div id="password_checker" class="form-text" style="color:#a40000;"></div>
                  </div>
                  <div class="mb-3">
                     <label for="verification_code_input" class="form-label">
                        Введите код с телефона (если используете 2FA):
                     </label>
                     <input id="verification_code_input" type="text" name="code" class="form-control"
                            placeholder="Verification code">
                  </div>
                  <div class="form-check">
                     <input class="form-check-input" type="checkbox" name="remember-me" id="flexCheckChecked"
                            checked>
                     <label class="form-check-label" for="flexCheckChecked">
                        Запомнить пароль
                     </label>
                  </div>
                  <br>
                  <p align="center">или войдите с помощью:</p>
                  <div class="form-group" align="center">
                     <div class="col-md-3">
                        <a class="btn btn-outline-dark" href="/oauth2/authorization/google" role="button"
                           style="text-transform:none">
                           <img width="20px" style="margin-bottom:3px; margin-right:10px; margin-left:30px"
                                src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/53/Google_%22G%22_Logo.svg/512px-Google_%22G%22_Logo.svg.png"/>
                           Login with google
                        </a>
                     </div>
                  </div>
                  <div class="form-group" align="center">
                     <div class="col-md-3">
                        <a class="btn btn-outline-dark" href="/oauth2/authorization/github" role="button"
                           style="text-transform:none" w>
                           <img width="20px" style="margin-bottom:3px; margin-right:10px; margin-left:30px"
                                src="https://wodensoft.co.uk/wp-content/uploads/2020/05/Github.png"/>
                           Login with github
                        </a>
                     </div>
                  </div>
                  <hr>
                  <p align="center">если вы у нас впервые:</p>
               </div>

               <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Отмена</button>
                  <button type="button" id="user_signin_btn" class="btn btn-primary"
                          onclick="{event.preventDefault(); signin()}">
                     Войти
                  </button>
               </div>
            </form>
         </div>
      </div>
   </div>

   <!-- Модалка для регистрации -->
   <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
         <div class="modal-content" style="width:750px;">
            <div class="modal-body">
               <div class="box">
                  <div class="form loginBox">
                     <b></b>
                     <b></b>

                     <form>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="usernameSave">Имя пользователя</label>
                              <input class="form-control" type="text" value="" id="usernameSave" required
                                     minlength="4"
                                     placeholder="Введите имя пользователя">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="emailSave">Адрес электронной почты</label>
                              <input class="form-control" type="email" value="" id="emailSave"
                                     pattern="^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}"
                                     title="в формате user@example.com" required
                                     placeholder="Введите адрес электронной почты">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="passwordSave">Пароль</label>
                              <input class="form-control" type="password" value="" id="passwordSave" required
                                     minlength="6"
                                     placeholder="Введите пароль">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="phoneSave">Номер телефона</label>
                              <input class="form-control" type="text" value="" id="phoneSave" required
                                     minlength="11" pattern="[0-9]+"
                                     title="указать цифрами" placeholder="Введите номер телефона">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="first_nameSave">Имя</label>
                              <input class="form-control" type="text" value="" id="first_nameSave"
                                     placeholder="Введите имя">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="last_nameSave">Фамилия</label>
                              <input class="form-control" type="text" value="" id="last_nameSave"
                                     placeholder="Введите фамилию">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="ageSave">Возраст</label>
                              <input class="form-control" type="number" value="" id="ageSave"
                                     placeholder="Введите возраст">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-2">
                              <label class="form-label" for="countrySave">Страна</label>
                              <input class="form-control" type="text" value="" id="countrySave"
                                     placeholder="Введите страну">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="citySave">Город</label>
                              <input class="form-control" type="text" value="" id="citySave"
                                     placeholder="Введите город">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="cityIndexSave">Индекс города</label>
                              <input class="form-control" type="text" value="" id="cityIndexSave"
                                     placeholder="Введите индекс города">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-2">
                              <label class="form-label" for="streetSave">Улица</label>
                              <input class="form-control" type="text" value="" id="streetSave"
                                     placeholder="Введите улицу">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="houseSave">Номер дома</label>
                              <input class="form-control" type="text" value="" id="houseSave"
                                     placeholder="Введите номер дома">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="birthdaySave">Дата рождения</label>
                              <input class="form-control" type="date" value="" id="birthdaySave">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="genderSave">Выберите пол:</label>
                              <br>
                              <select class="form-select" size="3" id="genderSave" name="gender" required="">
                                 <option id="ManSave" value="MALE">Мужчина</option>
                                 <option id="WomanSave" value="FEMALE">Женщина</option>
                                 <option id="NoGenderSave" value="UNKNOWN">Не определен</option>
                              </select>
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <input type="button" class="btn btn-primary" value="Зарегистрироваться"
                                     onclick="{event.preventDefault(); saveUser()}"/>
                           </div>
                        </div>
                     </form>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>

   <!--HEADER-->
   <div>
      <!--HEADER-->
      <header class="bg-dark text-white" style="height: 44px;">
         <div class="container" style="height: 44px;">
            <div class="d-flex align-items-center justify-content-center justify-content-lg-start"
                 style="height: 44px;">
               <a href="/" class="d-flex align-items-center mb-lg-0 text-white text-decoration-none">
                  <h5 style="margin: 0;">LOGO</h5>
               </a>
               <!--NavBar(HEADER)-->
               <ul class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0 ms-5">
                  <li><a href="/shops" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Магазины</font></font></a></li>
                  <li><a href="#" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Товары</font></font></a></li>
                  <li></li>
                  <li><a href="#" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Ещё...</font></font></a></li>
                  <li></li>
                  <li></li>
               </ul>




               <div class="text-end">


                  <button type="button" id="user_open_modal_btn"
                          class="btn btn-outline-light me-2">Войти
                  </button>
                  <button type="button" id="user_open_modal_reg" class="btn btn-warning">
                     Зарегистрироваться
                  </button>

                  <script>
                     $(document).ready(function () {
                        if (window.location.href !== 'http://localhost:8888/') {
                           $('#user_open_modal_btn').hide();
                        }
                     })
                     $(document).ready(function () {
                        if (window.location.href !== 'http://localhost:8888/') {
                           $('#user_open_modal_reg').hide();
                        }
                     })
                  </script>

                  <!--ссылка и информация пользователя при аутентификации-->
                  
               </div>
            </div>
         </div>
         <nav class="navbar fixed-bottom navbar-light bg-light">
            <a class="navbar-brand" href="/feedback">Обратная связь</a>
         </nav>
      </header>
   </div>

   <!--Main zone-->
   <section class="d-flex">
      <!--Sidebar-->
      <div class="bg-light" style="width: 350px; min-height: 100vh; padding-top: 30px; padding-bottom: 200px">
         <div class="container-fluid">
            <div class="row">
               <div class="col-12 d-flex align-items-center">
                  <h5>Категории</h5>
               </div>

               <div class="col-12 d-flex justify-content-center">
                  <hr style="width: 100%; margin: 0;">
               </div>
               <!--Категории-->
               <div class="col-12 mt-4">
                  <ul class="nav nav-pills flex-column mb-auto">
                     <li class="nav-item">
                        <a id="popular_show_btn" href="#" class="nav-link active" aria-current="page">
                           Популярное
                           </font></font></a>
                     </li>

                     
                        <li class="nav-item">
                           <a id="9" href="#"
                              class="nav-link link-dark" aria-current="page">Автомобили</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="3" href="#"
                              class="nav-link link-dark" aria-current="page">Аксессуары</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="5" href="#"
                              class="nav-link link-dark" aria-current="page">Бытовая техника</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="6" href="#"
                              class="nav-link link-dark" aria-current="page">Детские товары</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="7" href="#"
                              class="nav-link link-dark" aria-current="page">Компьютеры</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="4" href="#"
                              class="nav-link link-dark" aria-current="page">Мебель</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="8" href="#"
                              class="nav-link link-dark" aria-current="page">Мобильные телефоны</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="2" href="#"
                              class="nav-link link-dark" aria-current="page">Обувь</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="1" href="#"
                              class="nav-link link-dark" aria-current="page">Одежда</a>
                        </li>
                     
                  </ul>
               </div>
            </div>
         </div>
      </div>

      <!--Main Body-->
      <div class="container-fluid" style="padding-top: 30px; padding-left: 35px; padding-bottom: 40px;">
         <div class="row">
            <div class="col-12">
               <form style="width: 650px;" class="d-flex">
                  <input id="search_input" type="search" class="form-control" name="search"
                         placeholder="Поиск по наименованию:">
                  <button id="search_btn" type="button" class="btn btn-success" style="width: 150px;">Поиск</button>
               </form>
            </div>

            <!-- QR and enable 2FA -->
            

         <!--Контейнер для динамического контента (js)-->
         <div class="collapse" id="dinamic_content">
            <div class="col-12" style="margin-top: 30px;">
               <h4 id="dinamic_head"></h4>
            </div>
            <!--сюда генерируются товары-->
            <div class="col-12 d-flex flex-wrap mt-3" id="dinamic_content_inner">

               </div>
            </div>

            <!--Контейнер для статического контента (при загрузке страницы)-->
            <div class="collapse show" id="popular_show_content">
               <div class="col-12" style="margin-top: 30px;">
                  <h4>
                     Популярные товары
                  </h4>
               </div>
               <!--Блок популярные товары-->
               <div class="col-12 d-flex flex-wrap mt-3">
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://pe-shop.ru/pictures/product/big/6045_big.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Антисептик для рук</h5>
                           <p class="card-text">Антисептик для рук</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;5&#39;,&#39;1&#39;)">В корзину</a>
                              <a href="/product/5" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton5">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem5"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.ikea.com/ru/ru/images/products/klappa-myagkaya-igrushka-myach-raznocvetnyy__0873096_pe682670_s5.jpg?f=xxs" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Мягкая игрушка</h5>
                           <p class="card-text">Мягкая игрушка</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;10&#39;,&#39;2&#39;)">В корзину</a>
                              <a href="/product/10" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton10">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem10"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.ikea.com/ru/ru/images/products/gulligast-gulligest-mobil__0923957_pe788456_s5.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Мобиль</h5>
                           <p class="card-text">Мобиль</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;11&#39;,&#39;3&#39;)">В корзину</a>
                              <a href="/product/11" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton11">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem11"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.opticmall.ru/assets/images/products/3908/2132-622-17.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Очки RAY BAN</h5>
                           <p class="card-text">Очки RAY BAN</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;4&#39;,&#39;2&#39;)">В корзину</a>
                              <a href="/product/4" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton4">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem4"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://cdn.rbt.ru/images/gen/item_image/image/8507/23/850668_r7634.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Ноутбук Lenovo</h5>
                           <p class="card-text">Ноутбук Lenovo</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;7&#39;,&#39;4&#39;)">В корзину</a>
                              <a href="/product/7" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton7">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem7"></div>
                        </div>
                     </div>
                  

               </div>
               <!--Блок популярные магазины-->
               <div class="col-12" style="margin-top: 30px;">
                  <h4>
                     Популярные магазины
                  </h4>
               </div>

               <div class="col-12 d-flex flex-wrap mt-3">
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/beru.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Яндекс Маркет</h5>
                           <p class="card-text">Одежда, обувь, бытовая техника</p>
                           <a href="/showcase/1" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/lamoda.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Lamoda</h5>
                           <p class="card-text">Одежда, обувь, аксессуары</p>
                           <a href="/showcase/2" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/aliexpress.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">AliExpress</h5>
                           <p class="card-text">Любые товары</p>
                           <a href="/showcase/4" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
               </div>
            </div>

         </div>
      </div>
   </section>

   <script src="https://code.jquery.com/jquery-3.6.0.min.js"
           integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

   <!-- JavaScript Bundle with Popper -->
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
           integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
           crossorigin="anonymous"></script>
   <script>
      /**
       * связано с статическим контентом
       */
      const popular_show_btn = $('#popular_show_btn');
      const popular_show_content = $('#popular_show_content');
      /**
       * динамический контент
       */
      const dinamic_show_content = $('#dinamic_content');
      const dinamic_head = $('#dinamic_head');
      const dinamic_inner_content = $('#dinamic_content_inner');
      /**
       * поиск
       */
      const search_input = $('#search_input');
      const search_btn = $('#search_btn');
      /**
       *  вход в систему и модальное окно входа в систему
       */
      const user_modal = $('#user_modal');
      const user_open_modal_btn = $('#user_open_modal_btn');
      const user_signin_form = $('#user_signin_form');
      const username_input = $('#username_input');
      const password_input = $('#password_input');
      const username_checker = $('#username_checker');
      const password_checker = $('#password_checker');
      const loginModal = $('#loginModal');
      const user_open_modal_reg = $('#user_open_modal_reg');

      $(document).ready(function () {

         /**
          * обработчик
          * проверка корректности отпавленной формы
          */
         $(user_signin_form).on('submit', function (e) {
            username_checker.html('');
            password_checker.html('');
            let username = username_input.val();
            let password = password_input.val();
            if (username === "" || username === " ") {
               username_checker.html('Поле username не должно быть пустым');
               e.preventDefault();
            } else if (password === "" || password === " ") {
               password_checker.html('Поле password не должно быть пустым')
               e.preventDefault();
            }
         })

         /**
          * обработчик
          * открытие модального окна входа в систему
          */
         $(user_open_modal_btn).on('click', function (e) {
            e.preventDefault();
            user_modal.modal('show');
         })
         $(user_open_modal_reg).on('click', function (e) {
            e.preventDefault();
            loginModal.modal('show');
         })

         /**
          * обработчик
          * обработка поиска
          */
         $(search_btn).on('click', function (e) {
            e.preventDefault();
            toggleClassesContent($(this));
            toggleClassesNavBar(null);
            let valueSearch = search_input.val();
            search_input.val('');

            /**
             * обрабочтик
             * проверка на пустое значение поиска
             */
            if (valueSearch === '') {
               dinamic_head.html('');
               dinamic_head.html('Все товары')
            } else {
               dinamic_head.html('');
               dinamic_head.html('Результат запроса "' + valueSearch + '"');
            }
         })

         /**
          * обработчик
          * обработчик на кнопке "популярное" в навбар
          */
         $(popular_show_btn).on('click', function (e) {
            e.preventDefault();
            toggleClassesContent($(this));
            toggleClassesNavBar($(this));
         })

         /**
          * обработчик
          * обработчик на все кнопки в навбар кроме "популярное"
          */
         $('.link-dark').on('click', function (e) {
            e.preventDefault();
            /**
             * переключение стилей кнопок навбара и контейнера с контентом
             */
            toggleClassesContent($(this));
            toggleClassesNavBar($(this));

            /**
             * перезапись категории в заголовок
             */
            let category = $(this).html();
            dinamic_head.html("");
            dinamic_head.html(category);
            /** перезапись динамического контента
             *  товары по категории
             */
            searchByCategory($(this));
         })


      })

      /**
       * отправляет GET запрос на /home/category/id = категории
       * генерирует html из массива итемов на странице
       */
      async function searchByCategory(e) {
         const categoryId = $(e).attr("id");
         const response = await fetch("/category/" + categoryId);
         if (response.ok) {
            let items = await response.json();
            /**
             * Добавляем итемы по категориям на страницу
             * */
            let itemsByCategoryHTML = "";
            for (let i = 0; i < items.length; i++) {
               itemsByCategoryHTML += '<div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">\n' +
                  '                       <img src="' + items[i].images[0] + '" class="card-img-top" alt="popular_item" style="height: 180px;">' +
                  '                           <div class="card-body">\n' +
                  '                                <h5 class="card-title">' + items[i].name + '</h5>' +
                  '                                <p class="card-text">' + items[i].description + '</p>' +
                  '                                <div class="d-flex">\n' +
                  '                                    <a href="#" class="btn btn-danger" style="width: 150px;">В корзину</a>' +
                  '                                    <a href="/product/' + items[i].id + '" class="btn btn-primary" style="margin-left: 10px;">Смотреть</a>' +
                  '                                </div>' +
                  '                           </div>' +
                  '                   </div>';
            }
            dinamic_inner_content.html("");
            dinamic_inner_content.html(itemsByCategoryHTML);
         }
      }

      /**
       * функция переключения классов контейнера с контентом
       */
      function toggleClassesContent(e) {
         if ($(e).is(popular_show_btn)) {
            popular_show_content.addClass('show');
            dinamic_show_content.removeClass('show');
            dinamic_inner_content.html("");
         } else {
            popular_show_content.removeClass('show');
            dinamic_show_content.addClass('show');
         }
      }

      /**
       * функция переключения кнопок в навбар
       */
      function toggleClassesNavBar(e) {
         $('.active').removeClass('active').addClass('link-dark');
         $(e).removeClass('link-dark');
         $(e).addClass('active');
      }

      async function addCartItem(itemId, shopId) {
         // let quant = document.getElementById("itemQuant").value;
         let url = new URL("http://localhost:8888/api/cart/add")
         const response = await fetch(url, {
            method: 'POST',
            headers: {
               "Accept": "application/json",
               "Content-Type": "application/json; charset=utf-8",
            },
            body: JSON.stringify({
               quantity: 1,
               item: {
                  id: itemId
               },
               shop: {
                  id: shopId
               },
            })
         })
      }

      $(async function () {
         await favoriteItem()
      })

      async function favoriteItem() {
         let items = document.getElementsByName("favItems")
         for (let i = 0; i < items.length; i++) {
            let itemDivID = items[i].id;
            let itemId = itemDivID.substr(itemDivID.indexOf("m") + 1, itemDivID.length - itemDivID.indexOf("m") + 1)
            await favoriteButtonItem(itemId);
         }
      }

   </script>
   <script type="text/javascript" src="/js/favoriteHome.js"></script>
   <script type="text/javascript" src="js/registration.js"></script>
   <script type="text/javascript" src="js/signin.js"></script>
   <script type="text/javascript" src="js/twoFactorAuth.js"></script>
</body>
</html>
], template might not exist or might not be accessible by any of the configured Template Resolvers
	at org.thymeleaf.engine.TemplateManager.resolveTemplate(TemplateManager.java:869)
	at org.thymeleaf.engine.TemplateManager.parseAndProcess(TemplateManager.java:607)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1098)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1072)
	at org.thymeleaf.spring5.view.ThymeleafView.renderFragment(ThymeleafView.java:366)
	at org.thymeleaf.spring5.view.ThymeleafView.render(ThymeleafView.java:190)
	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1397)
	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1142)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1081)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:655)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:327)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:121)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:115)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:105)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:218)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:212)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:110)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:80)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:211)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:183)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:358)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:271)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:94)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1726)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:829)
2021-11-03 13:41:11,878 ERROR org.apache.juli.logging.DirectJDKLog [http-nio-80-exec-7] Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is org.thymeleaf.exceptions.TemplateInputException: Error resolving template [<!DOCTYPE html>
<html>
<head>
   <meta charset="UTF-8">
   <title>Главная</title>
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
         integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

   <!-- Не переносите подтягивание jQuery вниз файла, иначе он не сможет его прочитать в header-е, который встраивается
        в начало этой странице -->
   <script src="https://code.jquery.com/jquery-3.6.0.min.js"
           integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
</head>
<body>
   
   
   <!-- модалка для входа юзеру -->
   <div class="modal fade" id="user_modal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
         <div class="modal-content">
            <div class="modal-header">
               <h5 class="modal-title">Войдите в систему</h5>
               <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="user_signin_form" action="/login" method="post">
               <div class="modal-body">
                  <div class="mb-3">
                     <label for="username_input" class="form-label">Введите email:</label>
                     <input id="username_input" type="text" name="j_username" class="form-control"
                            placeholder="Username">
                     <div id="username_checker" class="form-text" style="color:#a40000;"></div>
                  </div>
                  <div class="mb-3">
                     <label for="password_input" class="form-label">Введите пароль:</label>
                     <input id="password_input" type="password" name="j_password" class="form-control"
                            placeholder="Password">
                     <div id="password_checker" class="form-text" style="color:#a40000;"></div>
                  </div>
                  <div class="mb-3">
                     <label for="verification_code_input" class="form-label">
                        Введите код с телефона (если используете 2FA):
                     </label>
                     <input id="verification_code_input" type="text" name="code" class="form-control"
                            placeholder="Verification code">
                  </div>
                  <div class="form-check">
                     <input class="form-check-input" type="checkbox" name="remember-me" id="flexCheckChecked"
                            checked>
                     <label class="form-check-label" for="flexCheckChecked">
                        Запомнить пароль
                     </label>
                  </div>
                  <br>
                  <p align="center">или войдите с помощью:</p>
                  <div class="form-group" align="center">
                     <div class="col-md-3">
                        <a class="btn btn-outline-dark" href="/oauth2/authorization/google" role="button"
                           style="text-transform:none">
                           <img width="20px" style="margin-bottom:3px; margin-right:10px; margin-left:30px"
                                src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/53/Google_%22G%22_Logo.svg/512px-Google_%22G%22_Logo.svg.png"/>
                           Login with google
                        </a>
                     </div>
                  </div>
                  <div class="form-group" align="center">
                     <div class="col-md-3">
                        <a class="btn btn-outline-dark" href="/oauth2/authorization/github" role="button"
                           style="text-transform:none" w>
                           <img width="20px" style="margin-bottom:3px; margin-right:10px; margin-left:30px"
                                src="https://wodensoft.co.uk/wp-content/uploads/2020/05/Github.png"/>
                           Login with github
                        </a>
                     </div>
                  </div>
                  <hr>
                  <p align="center">если вы у нас впервые:</p>
               </div>

               <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Отмена</button>
                  <button type="button" id="user_signin_btn" class="btn btn-primary"
                          onclick="{event.preventDefault(); signin()}">
                     Войти
                  </button>
               </div>
            </form>
         </div>
      </div>
   </div>

   <!-- Модалка для регистрации -->
   <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
         <div class="modal-content" style="width:750px;">
            <div class="modal-body">
               <div class="box">
                  <div class="form loginBox">
                     <b></b>
                     <b></b>

                     <form>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="usernameSave">Имя пользователя</label>
                              <input class="form-control" type="text" value="" id="usernameSave" required
                                     minlength="4"
                                     placeholder="Введите имя пользователя">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="emailSave">Адрес электронной почты</label>
                              <input class="form-control" type="email" value="" id="emailSave"
                                     pattern="^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}"
                                     title="в формате user@example.com" required
                                     placeholder="Введите адрес электронной почты">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="passwordSave">Пароль</label>
                              <input class="form-control" type="password" value="" id="passwordSave" required
                                     minlength="6"
                                     placeholder="Введите пароль">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="phoneSave">Номер телефона</label>
                              <input class="form-control" type="text" value="" id="phoneSave" required
                                     minlength="11" pattern="[0-9]+"
                                     title="указать цифрами" placeholder="Введите номер телефона">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="first_nameSave">Имя</label>
                              <input class="form-control" type="text" value="" id="first_nameSave"
                                     placeholder="Введите имя">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="last_nameSave">Фамилия</label>
                              <input class="form-control" type="text" value="" id="last_nameSave"
                                     placeholder="Введите фамилию">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="ageSave">Возраст</label>
                              <input class="form-control" type="number" value="" id="ageSave"
                                     placeholder="Введите возраст">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-2">
                              <label class="form-label" for="countrySave">Страна</label>
                              <input class="form-control" type="text" value="" id="countrySave"
                                     placeholder="Введите страну">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="citySave">Город</label>
                              <input class="form-control" type="text" value="" id="citySave"
                                     placeholder="Введите город">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="cityIndexSave">Индекс города</label>
                              <input class="form-control" type="text" value="" id="cityIndexSave"
                                     placeholder="Введите индекс города">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-2">
                              <label class="form-label" for="streetSave">Улица</label>
                              <input class="form-control" type="text" value="" id="streetSave"
                                     placeholder="Введите улицу">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="houseSave">Номер дома</label>
                              <input class="form-control" type="text" value="" id="houseSave"
                                     placeholder="Введите номер дома">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="birthdaySave">Дата рождения</label>
                              <input class="form-control" type="date" value="" id="birthdaySave">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="genderSave">Выберите пол:</label>
                              <br>
                              <select class="form-select" size="3" id="genderSave" name="gender" required="">
                                 <option id="ManSave" value="MALE">Мужчина</option>
                                 <option id="WomanSave" value="FEMALE">Женщина</option>
                                 <option id="NoGenderSave" value="UNKNOWN">Не определен</option>
                              </select>
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <input type="button" class="btn btn-primary" value="Зарегистрироваться"
                                     onclick="{event.preventDefault(); saveUser()}"/>
                           </div>
                        </div>
                     </form>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>

   <!--HEADER-->
   <div>
      <!--HEADER-->
      <header class="bg-dark text-white" style="height: 44px;">
         <div class="container" style="height: 44px;">
            <div class="d-flex align-items-center justify-content-center justify-content-lg-start"
                 style="height: 44px;">
               <a href="/" class="d-flex align-items-center mb-lg-0 text-white text-decoration-none">
                  <h5 style="margin: 0;">LOGO</h5>
               </a>
               <!--NavBar(HEADER)-->
               <ul class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0 ms-5">
                  <li><a href="/shops" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Магазины</font></font></a></li>
                  <li><a href="#" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Товары</font></font></a></li>
                  <li></li>
                  <li><a href="#" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Ещё...</font></font></a></li>
                  <li></li>
                  <li></li>
               </ul>




               <div class="text-end">


                  <button type="button" id="user_open_modal_btn"
                          class="btn btn-outline-light me-2">Войти
                  </button>
                  <button type="button" id="user_open_modal_reg" class="btn btn-warning">
                     Зарегистрироваться
                  </button>

                  <script>
                     $(document).ready(function () {
                        if (window.location.href !== 'http://localhost:8888/') {
                           $('#user_open_modal_btn').hide();
                        }
                     })
                     $(document).ready(function () {
                        if (window.location.href !== 'http://localhost:8888/') {
                           $('#user_open_modal_reg').hide();
                        }
                     })
                  </script>

                  <!--ссылка и информация пользователя при аутентификации-->
                  
               </div>
            </div>
         </div>
         <nav class="navbar fixed-bottom navbar-light bg-light">
            <a class="navbar-brand" href="/feedback">Обратная связь</a>
         </nav>
      </header>
   </div>

   <!--Main zone-->
   <section class="d-flex">
      <!--Sidebar-->
      <div class="bg-light" style="width: 350px; min-height: 100vh; padding-top: 30px; padding-bottom: 200px">
         <div class="container-fluid">
            <div class="row">
               <div class="col-12 d-flex align-items-center">
                  <h5>Категории</h5>
               </div>

               <div class="col-12 d-flex justify-content-center">
                  <hr style="width: 100%; margin: 0;">
               </div>
               <!--Категории-->
               <div class="col-12 mt-4">
                  <ul class="nav nav-pills flex-column mb-auto">
                     <li class="nav-item">
                        <a id="popular_show_btn" href="#" class="nav-link active" aria-current="page">
                           Популярное
                           </font></font></a>
                     </li>

                     
                        <li class="nav-item">
                           <a id="9" href="#"
                              class="nav-link link-dark" aria-current="page">Автомобили</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="3" href="#"
                              class="nav-link link-dark" aria-current="page">Аксессуары</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="5" href="#"
                              class="nav-link link-dark" aria-current="page">Бытовая техника</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="6" href="#"
                              class="nav-link link-dark" aria-current="page">Детские товары</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="7" href="#"
                              class="nav-link link-dark" aria-current="page">Компьютеры</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="4" href="#"
                              class="nav-link link-dark" aria-current="page">Мебель</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="8" href="#"
                              class="nav-link link-dark" aria-current="page">Мобильные телефоны</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="2" href="#"
                              class="nav-link link-dark" aria-current="page">Обувь</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="1" href="#"
                              class="nav-link link-dark" aria-current="page">Одежда</a>
                        </li>
                     
                  </ul>
               </div>
            </div>
         </div>
      </div>

      <!--Main Body-->
      <div class="container-fluid" style="padding-top: 30px; padding-left: 35px; padding-bottom: 40px;">
         <div class="row">
            <div class="col-12">
               <form style="width: 650px;" class="d-flex">
                  <input id="search_input" type="search" class="form-control" name="search"
                         placeholder="Поиск по наименованию:">
                  <button id="search_btn" type="button" class="btn btn-success" style="width: 150px;">Поиск</button>
               </form>
            </div>

            <!-- QR and enable 2FA -->
            

         <!--Контейнер для динамического контента (js)-->
         <div class="collapse" id="dinamic_content">
            <div class="col-12" style="margin-top: 30px;">
               <h4 id="dinamic_head"></h4>
            </div>
            <!--сюда генерируются товары-->
            <div class="col-12 d-flex flex-wrap mt-3" id="dinamic_content_inner">

               </div>
            </div>

            <!--Контейнер для статического контента (при загрузке страницы)-->
            <div class="collapse show" id="popular_show_content">
               <div class="col-12" style="margin-top: 30px;">
                  <h4>
                     Популярные товары
                  </h4>
               </div>
               <!--Блок популярные товары-->
               <div class="col-12 d-flex flex-wrap mt-3">
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://pe-shop.ru/pictures/product/big/6045_big.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Антисептик для рук</h5>
                           <p class="card-text">Антисептик для рук</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;5&#39;,&#39;1&#39;)">В корзину</a>
                              <a href="/product/5" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton5">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem5"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.ikea.com/ru/ru/images/products/klappa-myagkaya-igrushka-myach-raznocvetnyy__0873096_pe682670_s5.jpg?f=xxs" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Мягкая игрушка</h5>
                           <p class="card-text">Мягкая игрушка</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;10&#39;,&#39;2&#39;)">В корзину</a>
                              <a href="/product/10" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton10">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem10"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.ikea.com/ru/ru/images/products/gulligast-gulligest-mobil__0923957_pe788456_s5.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Мобиль</h5>
                           <p class="card-text">Мобиль</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;11&#39;,&#39;3&#39;)">В корзину</a>
                              <a href="/product/11" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton11">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem11"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.opticmall.ru/assets/images/products/3908/2132-622-17.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Очки RAY BAN</h5>
                           <p class="card-text">Очки RAY BAN</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;4&#39;,&#39;2&#39;)">В корзину</a>
                              <a href="/product/4" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton4">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem4"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://cdn.rbt.ru/images/gen/item_image/image/8507/23/850668_r7634.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Ноутбук Lenovo</h5>
                           <p class="card-text">Ноутбук Lenovo</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;7&#39;,&#39;4&#39;)">В корзину</a>
                              <a href="/product/7" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton7">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem7"></div>
                        </div>
                     </div>
                  

               </div>
               <!--Блок популярные магазины-->
               <div class="col-12" style="margin-top: 30px;">
                  <h4>
                     Популярные магазины
                  </h4>
               </div>

               <div class="col-12 d-flex flex-wrap mt-3">
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/beru.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Яндекс Маркет</h5>
                           <p class="card-text">Одежда, обувь, бытовая техника</p>
                           <a href="/showcase/1" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/lamoda.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Lamoda</h5>
                           <p class="card-text">Одежда, обувь, аксессуары</p>
                           <a href="/showcase/2" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/aliexpress.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">AliExpress</h5>
                           <p class="card-text">Любые товары</p>
                           <a href="/showcase/4" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
               </div>
            </div>

         </div>
      </div>
   </section>

   <script src="https://code.jquery.com/jquery-3.6.0.min.js"
           integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

   <!-- JavaScript Bundle with Popper -->
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
           integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
           crossorigin="anonymous"></script>
   <script>
      /**
       * связано с статическим контентом
       */
      const popular_show_btn = $('#popular_show_btn');
      const popular_show_content = $('#popular_show_content');
      /**
       * динамический контент
       */
      const dinamic_show_content = $('#dinamic_content');
      const dinamic_head = $('#dinamic_head');
      const dinamic_inner_content = $('#dinamic_content_inner');
      /**
       * поиск
       */
      const search_input = $('#search_input');
      const search_btn = $('#search_btn');
      /**
       *  вход в систему и модальное окно входа в систему
       */
      const user_modal = $('#user_modal');
      const user_open_modal_btn = $('#user_open_modal_btn');
      const user_signin_form = $('#user_signin_form');
      const username_input = $('#username_input');
      const password_input = $('#password_input');
      const username_checker = $('#username_checker');
      const password_checker = $('#password_checker');
      const loginModal = $('#loginModal');
      const user_open_modal_reg = $('#user_open_modal_reg');

      $(document).ready(function () {

         /**
          * обработчик
          * проверка корректности отпавленной формы
          */
         $(user_signin_form).on('submit', function (e) {
            username_checker.html('');
            password_checker.html('');
            let username = username_input.val();
            let password = password_input.val();
            if (username === "" || username === " ") {
               username_checker.html('Поле username не должно быть пустым');
               e.preventDefault();
            } else if (password === "" || password === " ") {
               password_checker.html('Поле password не должно быть пустым')
               e.preventDefault();
            }
         })

         /**
          * обработчик
          * открытие модального окна входа в систему
          */
         $(user_open_modal_btn).on('click', function (e) {
            e.preventDefault();
            user_modal.modal('show');
         })
         $(user_open_modal_reg).on('click', function (e) {
            e.preventDefault();
            loginModal.modal('show');
         })

         /**
          * обработчик
          * обработка поиска
          */
         $(search_btn).on('click', function (e) {
            e.preventDefault();
            toggleClassesContent($(this));
            toggleClassesNavBar(null);
            let valueSearch = search_input.val();
            search_input.val('');

            /**
             * обрабочтик
             * проверка на пустое значение поиска
             */
            if (valueSearch === '') {
               dinamic_head.html('');
               dinamic_head.html('Все товары')
            } else {
               dinamic_head.html('');
               dinamic_head.html('Результат запроса "' + valueSearch + '"');
            }
         })

         /**
          * обработчик
          * обработчик на кнопке "популярное" в навбар
          */
         $(popular_show_btn).on('click', function (e) {
            e.preventDefault();
            toggleClassesContent($(this));
            toggleClassesNavBar($(this));
         })

         /**
          * обработчик
          * обработчик на все кнопки в навбар кроме "популярное"
          */
         $('.link-dark').on('click', function (e) {
            e.preventDefault();
            /**
             * переключение стилей кнопок навбара и контейнера с контентом
             */
            toggleClassesContent($(this));
            toggleClassesNavBar($(this));

            /**
             * перезапись категории в заголовок
             */
            let category = $(this).html();
            dinamic_head.html("");
            dinamic_head.html(category);
            /** перезапись динамического контента
             *  товары по категории
             */
            searchByCategory($(this));
         })


      })

      /**
       * отправляет GET запрос на /home/category/id = категории
       * генерирует html из массива итемов на странице
       */
      async function searchByCategory(e) {
         const categoryId = $(e).attr("id");
         const response = await fetch("/category/" + categoryId);
         if (response.ok) {
            let items = await response.json();
            /**
             * Добавляем итемы по категориям на страницу
             * */
            let itemsByCategoryHTML = "";
            for (let i = 0; i < items.length; i++) {
               itemsByCategoryHTML += '<div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">\n' +
                  '                       <img src="' + items[i].images[0] + '" class="card-img-top" alt="popular_item" style="height: 180px;">' +
                  '                           <div class="card-body">\n' +
                  '                                <h5 class="card-title">' + items[i].name + '</h5>' +
                  '                                <p class="card-text">' + items[i].description + '</p>' +
                  '                                <div class="d-flex">\n' +
                  '                                    <a href="#" class="btn btn-danger" style="width: 150px;">В корзину</a>' +
                  '                                    <a href="/product/' + items[i].id + '" class="btn btn-primary" style="margin-left: 10px;">Смотреть</a>' +
                  '                                </div>' +
                  '                           </div>' +
                  '                   </div>';
            }
            dinamic_inner_content.html("");
            dinamic_inner_content.html(itemsByCategoryHTML);
         }
      }

      /**
       * функция переключения классов контейнера с контентом
       */
      function toggleClassesContent(e) {
         if ($(e).is(popular_show_btn)) {
            popular_show_content.addClass('show');
            dinamic_show_content.removeClass('show');
            dinamic_inner_content.html("");
         } else {
            popular_show_content.removeClass('show');
            dinamic_show_content.addClass('show');
         }
      }

      /**
       * функция переключения кнопок в навбар
       */
      function toggleClassesNavBar(e) {
         $('.active').removeClass('active').addClass('link-dark');
         $(e).removeClass('link-dark');
         $(e).addClass('active');
      }

      async function addCartItem(itemId, shopId) {
         // let quant = document.getElementById("itemQuant").value;
         let url = new URL("http://localhost:8888/api/cart/add")
         const response = await fetch(url, {
            method: 'POST',
            headers: {
               "Accept": "application/json",
               "Content-Type": "application/json; charset=utf-8",
            },
            body: JSON.stringify({
               quantity: 1,
               item: {
                  id: itemId
               },
               shop: {
                  id: shopId
               },
            })
         })
      }

      $(async function () {
         await favoriteItem()
      })

      async function favoriteItem() {
         let items = document.getElementsByName("favItems")
         for (let i = 0; i < items.length; i++) {
            let itemDivID = items[i].id;
            let itemId = itemDivID.substr(itemDivID.indexOf("m") + 1, itemDivID.length - itemDivID.indexOf("m") + 1)
            await favoriteButtonItem(itemId);
         }
      }

   </script>
   <script type="text/javascript" src="/js/favoriteHome.js"></script>
   <script type="text/javascript" src="js/registration.js"></script>
   <script type="text/javascript" src="js/signin.js"></script>
   <script type="text/javascript" src="js/twoFactorAuth.js"></script>
</body>
</html>
], template might not exist or might not be accessible by any of the configured Template Resolvers] with root cause
org.thymeleaf.exceptions.TemplateInputException: Error resolving template [<!DOCTYPE html>
<html>
<head>
   <meta charset="UTF-8">
   <title>Главная</title>
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
         integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

   <!-- Не переносите подтягивание jQuery вниз файла, иначе он не сможет его прочитать в header-е, который встраивается
        в начало этой странице -->
   <script src="https://code.jquery.com/jquery-3.6.0.min.js"
           integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
</head>
<body>
   
   
   <!-- модалка для входа юзеру -->
   <div class="modal fade" id="user_modal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
         <div class="modal-content">
            <div class="modal-header">
               <h5 class="modal-title">Войдите в систему</h5>
               <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="user_signin_form" action="/login" method="post">
               <div class="modal-body">
                  <div class="mb-3">
                     <label for="username_input" class="form-label">Введите email:</label>
                     <input id="username_input" type="text" name="j_username" class="form-control"
                            placeholder="Username">
                     <div id="username_checker" class="form-text" style="color:#a40000;"></div>
                  </div>
                  <div class="mb-3">
                     <label for="password_input" class="form-label">Введите пароль:</label>
                     <input id="password_input" type="password" name="j_password" class="form-control"
                            placeholder="Password">
                     <div id="password_checker" class="form-text" style="color:#a40000;"></div>
                  </div>
                  <div class="mb-3">
                     <label for="verification_code_input" class="form-label">
                        Введите код с телефона (если используете 2FA):
                     </label>
                     <input id="verification_code_input" type="text" name="code" class="form-control"
                            placeholder="Verification code">
                  </div>
                  <div class="form-check">
                     <input class="form-check-input" type="checkbox" name="remember-me" id="flexCheckChecked"
                            checked>
                     <label class="form-check-label" for="flexCheckChecked">
                        Запомнить пароль
                     </label>
                  </div>
                  <br>
                  <p align="center">или войдите с помощью:</p>
                  <div class="form-group" align="center">
                     <div class="col-md-3">
                        <a class="btn btn-outline-dark" href="/oauth2/authorization/google" role="button"
                           style="text-transform:none">
                           <img width="20px" style="margin-bottom:3px; margin-right:10px; margin-left:30px"
                                src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/53/Google_%22G%22_Logo.svg/512px-Google_%22G%22_Logo.svg.png"/>
                           Login with google
                        </a>
                     </div>
                  </div>
                  <div class="form-group" align="center">
                     <div class="col-md-3">
                        <a class="btn btn-outline-dark" href="/oauth2/authorization/github" role="button"
                           style="text-transform:none" w>
                           <img width="20px" style="margin-bottom:3px; margin-right:10px; margin-left:30px"
                                src="https://wodensoft.co.uk/wp-content/uploads/2020/05/Github.png"/>
                           Login with github
                        </a>
                     </div>
                  </div>
                  <hr>
                  <p align="center">если вы у нас впервые:</p>
               </div>

               <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Отмена</button>
                  <button type="button" id="user_signin_btn" class="btn btn-primary"
                          onclick="{event.preventDefault(); signin()}">
                     Войти
                  </button>
               </div>
            </form>
         </div>
      </div>
   </div>

   <!-- Модалка для регистрации -->
   <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
         <div class="modal-content" style="width:750px;">
            <div class="modal-body">
               <div class="box">
                  <div class="form loginBox">
                     <b></b>
                     <b></b>

                     <form>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="usernameSave">Имя пользователя</label>
                              <input class="form-control" type="text" value="" id="usernameSave" required
                                     minlength="4"
                                     placeholder="Введите имя пользователя">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="emailSave">Адрес электронной почты</label>
                              <input class="form-control" type="email" value="" id="emailSave"
                                     pattern="^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}"
                                     title="в формате user@example.com" required
                                     placeholder="Введите адрес электронной почты">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="passwordSave">Пароль</label>
                              <input class="form-control" type="password" value="" id="passwordSave" required
                                     minlength="6"
                                     placeholder="Введите пароль">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="phoneSave">Номер телефона</label>
                              <input class="form-control" type="text" value="" id="phoneSave" required
                                     minlength="11" pattern="[0-9]+"
                                     title="указать цифрами" placeholder="Введите номер телефона">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="first_nameSave">Имя</label>
                              <input class="form-control" type="text" value="" id="first_nameSave"
                                     placeholder="Введите имя">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="last_nameSave">Фамилия</label>
                              <input class="form-control" type="text" value="" id="last_nameSave"
                                     placeholder="Введите фамилию">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="ageSave">Возраст</label>
                              <input class="form-control" type="number" value="" id="ageSave"
                                     placeholder="Введите возраст">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-2">
                              <label class="form-label" for="countrySave">Страна</label>
                              <input class="form-control" type="text" value="" id="countrySave"
                                     placeholder="Введите страну">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="citySave">Город</label>
                              <input class="form-control" type="text" value="" id="citySave"
                                     placeholder="Введите город">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="cityIndexSave">Индекс города</label>
                              <input class="form-control" type="text" value="" id="cityIndexSave"
                                     placeholder="Введите индекс города">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-2">
                              <label class="form-label" for="streetSave">Улица</label>
                              <input class="form-control" type="text" value="" id="streetSave"
                                     placeholder="Введите улицу">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="houseSave">Номер дома</label>
                              <input class="form-control" type="text" value="" id="houseSave"
                                     placeholder="Введите номер дома">
                           </div>
                           <div class="form-group col-2">
                              <label class="form-label" for="birthdaySave">Дата рождения</label>
                              <input class="form-control" type="date" value="" id="birthdaySave">
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <label class="form-label" for="genderSave">Выберите пол:</label>
                              <br>
                              <select class="form-select" size="3" id="genderSave" name="gender" required="">
                                 <option id="ManSave" value="MALE">Мужчина</option>
                                 <option id="WomanSave" value="FEMALE">Женщина</option>
                                 <option id="NoGenderSave" value="UNKNOWN">Не определен</option>
                              </select>
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="form-group col-6">
                              <input type="button" class="btn btn-primary" value="Зарегистрироваться"
                                     onclick="{event.preventDefault(); saveUser()}"/>
                           </div>
                        </div>
                     </form>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>

   <!--HEADER-->
   <div>
      <!--HEADER-->
      <header class="bg-dark text-white" style="height: 44px;">
         <div class="container" style="height: 44px;">
            <div class="d-flex align-items-center justify-content-center justify-content-lg-start"
                 style="height: 44px;">
               <a href="/" class="d-flex align-items-center mb-lg-0 text-white text-decoration-none">
                  <h5 style="margin: 0;">LOGO</h5>
               </a>
               <!--NavBar(HEADER)-->
               <ul class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0 ms-5">
                  <li><a href="/shops" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Магазины</font></font></a></li>
                  <li><a href="#" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Товары</font></font></a></li>
                  <li></li>
                  <li><a href="#" class="nav-link px-2 text-white"><font style="vertical-align: inherit;"><font
                        style="vertical-align: inherit;">Ещё...</font></font></a></li>
                  <li></li>
                  <li></li>
               </ul>




               <div class="text-end">


                  <button type="button" id="user_open_modal_btn"
                          class="btn btn-outline-light me-2">Войти
                  </button>
                  <button type="button" id="user_open_modal_reg" class="btn btn-warning">
                     Зарегистрироваться
                  </button>

                  <script>
                     $(document).ready(function () {
                        if (window.location.href !== 'http://localhost:8888/') {
                           $('#user_open_modal_btn').hide();
                        }
                     })
                     $(document).ready(function () {
                        if (window.location.href !== 'http://localhost:8888/') {
                           $('#user_open_modal_reg').hide();
                        }
                     })
                  </script>

                  <!--ссылка и информация пользователя при аутентификации-->
                  
               </div>
            </div>
         </div>
         <nav class="navbar fixed-bottom navbar-light bg-light">
            <a class="navbar-brand" href="/feedback">Обратная связь</a>
         </nav>
      </header>
   </div>

   <!--Main zone-->
   <section class="d-flex">
      <!--Sidebar-->
      <div class="bg-light" style="width: 350px; min-height: 100vh; padding-top: 30px; padding-bottom: 200px">
         <div class="container-fluid">
            <div class="row">
               <div class="col-12 d-flex align-items-center">
                  <h5>Категории</h5>
               </div>

               <div class="col-12 d-flex justify-content-center">
                  <hr style="width: 100%; margin: 0;">
               </div>
               <!--Категории-->
               <div class="col-12 mt-4">
                  <ul class="nav nav-pills flex-column mb-auto">
                     <li class="nav-item">
                        <a id="popular_show_btn" href="#" class="nav-link active" aria-current="page">
                           Популярное
                           </font></font></a>
                     </li>

                     
                        <li class="nav-item">
                           <a id="9" href="#"
                              class="nav-link link-dark" aria-current="page">Автомобили</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="3" href="#"
                              class="nav-link link-dark" aria-current="page">Аксессуары</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="5" href="#"
                              class="nav-link link-dark" aria-current="page">Бытовая техника</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="6" href="#"
                              class="nav-link link-dark" aria-current="page">Детские товары</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="7" href="#"
                              class="nav-link link-dark" aria-current="page">Компьютеры</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="4" href="#"
                              class="nav-link link-dark" aria-current="page">Мебель</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="8" href="#"
                              class="nav-link link-dark" aria-current="page">Мобильные телефоны</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="2" href="#"
                              class="nav-link link-dark" aria-current="page">Обувь</a>
                        </li>
                     
                        <li class="nav-item">
                           <a id="1" href="#"
                              class="nav-link link-dark" aria-current="page">Одежда</a>
                        </li>
                     
                  </ul>
               </div>
            </div>
         </div>
      </div>

      <!--Main Body-->
      <div class="container-fluid" style="padding-top: 30px; padding-left: 35px; padding-bottom: 40px;">
         <div class="row">
            <div class="col-12">
               <form style="width: 650px;" class="d-flex">
                  <input id="search_input" type="search" class="form-control" name="search"
                         placeholder="Поиск по наименованию:">
                  <button id="search_btn" type="button" class="btn btn-success" style="width: 150px;">Поиск</button>
               </form>
            </div>

            <!-- QR and enable 2FA -->
            

         <!--Контейнер для динамического контента (js)-->
         <div class="collapse" id="dinamic_content">
            <div class="col-12" style="margin-top: 30px;">
               <h4 id="dinamic_head"></h4>
            </div>
            <!--сюда генерируются товары-->
            <div class="col-12 d-flex flex-wrap mt-3" id="dinamic_content_inner">

               </div>
            </div>

            <!--Контейнер для статического контента (при загрузке страницы)-->
            <div class="collapse show" id="popular_show_content">
               <div class="col-12" style="margin-top: 30px;">
                  <h4>
                     Популярные товары
                  </h4>
               </div>
               <!--Блок популярные товары-->
               <div class="col-12 d-flex flex-wrap mt-3">
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://pe-shop.ru/pictures/product/big/6045_big.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Антисептик для рук</h5>
                           <p class="card-text">Антисептик для рук</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;5&#39;,&#39;1&#39;)">В корзину</a>
                              <a href="/product/5" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton5">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem5"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.ikea.com/ru/ru/images/products/klappa-myagkaya-igrushka-myach-raznocvetnyy__0873096_pe682670_s5.jpg?f=xxs" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Мягкая игрушка</h5>
                           <p class="card-text">Мягкая игрушка</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;10&#39;,&#39;2&#39;)">В корзину</a>
                              <a href="/product/10" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton10">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem10"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.ikea.com/ru/ru/images/products/gulligast-gulligest-mobil__0923957_pe788456_s5.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Мобиль</h5>
                           <p class="card-text">Мобиль</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;11&#39;,&#39;3&#39;)">В корзину</a>
                              <a href="/product/11" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton11">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem11"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://www.opticmall.ru/assets/images/products/3908/2132-622-17.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Очки RAY BAN</h5>
                           <p class="card-text">Очки RAY BAN</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;4&#39;,&#39;2&#39;)">В корзину</a>
                              <a href="/product/4" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton4">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem4"></div>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">
                        <img src="https://cdn.rbt.ru/images/gen/item_image/image/8507/23/850668_r7634.jpg" class="card-img-top" alt="popular_item"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Ноутбук Lenovo</h5>
                           <p class="card-text">Ноутбук Lenovo</p>
                           <div class="d-flex">
                              <a href="#" class="btn btn-danger"
                                 style="width: 150px;" onclick="addCartItem(&#39;7&#39;,&#39;4&#39;)">В корзину</a>
                              <a href="/product/7" class="btn btn-primary"
                                 style="margin-left: 10px;">Смотреть</a>
                           </div>
                           <div class="mt-2 d-flex" id="favoriteButton7">
                              <!--                                    <button class="btn btn-info btn-block" th:attr="onclick=|addItemToFavorites('${item.id}')|">Добавить в избранное</button>-->
                           </div>
                           <div name="favItems" id="favItem7"></div>
                        </div>
                     </div>
                  

               </div>
               <!--Блок популярные магазины-->
               <div class="col-12" style="margin-top: 30px;">
                  <h4>
                     Популярные магазины
                  </h4>
               </div>

               <div class="col-12 d-flex flex-wrap mt-3">
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/beru.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Яндекс Маркет</h5>
                           <p class="card-text">Одежда, обувь, бытовая техника</p>
                           <a href="/showcase/1" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/lamoda.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">Lamoda</h5>
                           <p class="card-text">Одежда, обувь, аксессуары</p>
                           <a href="/showcase/2" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
                     <div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px; overflow: hidden;">
                        <img src="https://epicris.ru/wp-content/uploads/blackfriday/aliexpress.jpg" class="card-img-top" alt="popular_shop"
                             style="height: 180px;">
                        <div class="card-body">
                           <h5 class="card-title">AliExpress</h5>
                           <p class="card-text">Любые товары</p>
                           <a href="/showcase/4" class="btn btn-danger">Перейти в
                              магазин</a>
                        </div>
                     </div>
                  
               </div>
            </div>

         </div>
      </div>
   </section>

   <script src="https://code.jquery.com/jquery-3.6.0.min.js"
           integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

   <!-- JavaScript Bundle with Popper -->
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
           integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
           crossorigin="anonymous"></script>
   <script>
      /**
       * связано с статическим контентом
       */
      const popular_show_btn = $('#popular_show_btn');
      const popular_show_content = $('#popular_show_content');
      /**
       * динамический контент
       */
      const dinamic_show_content = $('#dinamic_content');
      const dinamic_head = $('#dinamic_head');
      const dinamic_inner_content = $('#dinamic_content_inner');
      /**
       * поиск
       */
      const search_input = $('#search_input');
      const search_btn = $('#search_btn');
      /**
       *  вход в систему и модальное окно входа в систему
       */
      const user_modal = $('#user_modal');
      const user_open_modal_btn = $('#user_open_modal_btn');
      const user_signin_form = $('#user_signin_form');
      const username_input = $('#username_input');
      const password_input = $('#password_input');
      const username_checker = $('#username_checker');
      const password_checker = $('#password_checker');
      const loginModal = $('#loginModal');
      const user_open_modal_reg = $('#user_open_modal_reg');

      $(document).ready(function () {

         /**
          * обработчик
          * проверка корректности отпавленной формы
          */
         $(user_signin_form).on('submit', function (e) {
            username_checker.html('');
            password_checker.html('');
            let username = username_input.val();
            let password = password_input.val();
            if (username === "" || username === " ") {
               username_checker.html('Поле username не должно быть пустым');
               e.preventDefault();
            } else if (password === "" || password === " ") {
               password_checker.html('Поле password не должно быть пустым')
               e.preventDefault();
            }
         })

         /**
          * обработчик
          * открытие модального окна входа в систему
          */
         $(user_open_modal_btn).on('click', function (e) {
            e.preventDefault();
            user_modal.modal('show');
         })
         $(user_open_modal_reg).on('click', function (e) {
            e.preventDefault();
            loginModal.modal('show');
         })

         /**
          * обработчик
          * обработка поиска
          */
         $(search_btn).on('click', function (e) {
            e.preventDefault();
            toggleClassesContent($(this));
            toggleClassesNavBar(null);
            let valueSearch = search_input.val();
            search_input.val('');

            /**
             * обрабочтик
             * проверка на пустое значение поиска
             */
            if (valueSearch === '') {
               dinamic_head.html('');
               dinamic_head.html('Все товары')
            } else {
               dinamic_head.html('');
               dinamic_head.html('Результат запроса "' + valueSearch + '"');
            }
         })

         /**
          * обработчик
          * обработчик на кнопке "популярное" в навбар
          */
         $(popular_show_btn).on('click', function (e) {
            e.preventDefault();
            toggleClassesContent($(this));
            toggleClassesNavBar($(this));
         })

         /**
          * обработчик
          * обработчик на все кнопки в навбар кроме "популярное"
          */
         $('.link-dark').on('click', function (e) {
            e.preventDefault();
            /**
             * переключение стилей кнопок навбара и контейнера с контентом
             */
            toggleClassesContent($(this));
            toggleClassesNavBar($(this));

            /**
             * перезапись категории в заголовок
             */
            let category = $(this).html();
            dinamic_head.html("");
            dinamic_head.html(category);
            /** перезапись динамического контента
             *  товары по категории
             */
            searchByCategory($(this));
         })


      })

      /**
       * отправляет GET запрос на /home/category/id = категории
       * генерирует html из массива итемов на странице
       */
      async function searchByCategory(e) {
         const categoryId = $(e).attr("id");
         const response = await fetch("/category/" + categoryId);
         if (response.ok) {
            let items = await response.json();
            /**
             * Добавляем итемы по категориям на страницу
             * */
            let itemsByCategoryHTML = "";
            for (let i = 0; i < items.length; i++) {
               itemsByCategoryHTML += '<div class="card" style="width: 18rem; margin-right: 15px; margin-top: 20px;">\n' +
                  '                       <img src="' + items[i].images[0] + '" class="card-img-top" alt="popular_item" style="height: 180px;">' +
                  '                           <div class="card-body">\n' +
                  '                                <h5 class="card-title">' + items[i].name + '</h5>' +
                  '                                <p class="card-text">' + items[i].description + '</p>' +
                  '                                <div class="d-flex">\n' +
                  '                                    <a href="#" class="btn btn-danger" style="width: 150px;">В корзину</a>' +
                  '                                    <a href="/product/' + items[i].id + '" class="btn btn-primary" style="margin-left: 10px;">Смотреть</a>' +
                  '                                </div>' +
                  '                           </div>' +
                  '                   </div>';
            }
            dinamic_inner_content.html("");
            dinamic_inner_content.html(itemsByCategoryHTML);
         }
      }

      /**
       * функция переключения классов контейнера с контентом
       */
      function toggleClassesContent(e) {
         if ($(e).is(popular_show_btn)) {
            popular_show_content.addClass('show');
            dinamic_show_content.removeClass('show');
            dinamic_inner_content.html("");
         } else {
            popular_show_content.removeClass('show');
            dinamic_show_content.addClass('show');
         }
      }

      /**
       * функция переключения кнопок в навбар
       */
      function toggleClassesNavBar(e) {
         $('.active').removeClass('active').addClass('link-dark');
         $(e).removeClass('link-dark');
         $(e).addClass('active');
      }

      async function addCartItem(itemId, shopId) {
         // let quant = document.getElementById("itemQuant").value;
         let url = new URL("http://localhost:8888/api/cart/add")
         const response = await fetch(url, {
            method: 'POST',
            headers: {
               "Accept": "application/json",
               "Content-Type": "application/json; charset=utf-8",
            },
            body: JSON.stringify({
               quantity: 1,
               item: {
                  id: itemId
               },
               shop: {
                  id: shopId
               },
            })
         })
      }

      $(async function () {
         await favoriteItem()
      })

      async function favoriteItem() {
         let items = document.getElementsByName("favItems")
         for (let i = 0; i < items.length; i++) {
            let itemDivID = items[i].id;
            let itemId = itemDivID.substr(itemDivID.indexOf("m") + 1, itemDivID.length - itemDivID.indexOf("m") + 1)
            await favoriteButtonItem(itemId);
         }
      }

   </script>
   <script type="text/javascript" src="/js/favoriteHome.js"></script>
   <script type="text/javascript" src="js/registration.js"></script>
   <script type="text/javascript" src="js/signin.js"></script>
   <script type="text/javascript" src="js/twoFactorAuth.js"></script>
</body>
</html>
], template might not exist or might not be accessible by any of the configured Template Resolvers
	at org.thymeleaf.engine.TemplateManager.resolveTemplate(TemplateManager.java:869)
	at org.thymeleaf.engine.TemplateManager.parseAndProcess(TemplateManager.java:607)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1098)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1072)
	at org.thymeleaf.spring5.view.ThymeleafView.renderFragment(ThymeleafView.java:366)
	at org.thymeleaf.spring5.view.ThymeleafView.render(ThymeleafView.java:190)
	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1397)
	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1142)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1081)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:655)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:327)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:121)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:115)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:105)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:218)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:212)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:110)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:80)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:211)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:183)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:358)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:271)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:94)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1726)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:829)
2021-11-03 13:41:12,237 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2021-11-03 13:41:12,243 INFO com.zaxxer.hikari.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2021-11-03 13:41:12,276 INFO com.zaxxer.hikari.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2021-11-03 13:41:45,038 INFO org.hibernate.validator.internal.util.Version [background-preinit] HV000001: Hibernate Validator 6.2.0.Final
2021-11-03 13:41:45,054 INFO org.springframework.boot.StartupInfoLogger [main] Starting Application using Java 11.0.11 on DESKTOP-MME1U5F with PID 12688 (C:\Users\HP-Note\IdeaProjects\JM-PP-3-1-3\target\classes started by HP-Note in C:\Users\HP-Note\IdeaProjects\JM-PP-3-1-3)
2021-11-03 13:41:45,054 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2021-11-03 13:41:45,632 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2021-11-03 13:41:45,648 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 10 ms. Found 0 JPA repository interfaces.
2021-11-03 13:41:45,917 INFO org.springframework.context.support.PostProcessorRegistrationDelegate$BeanPostProcessorChecker [main] Bean 'org.springframework.security.access.expression.method.DefaultMethodSecurityExpressionHandler@5961e92d' of type [org.springframework.security.access.expression.method.DefaultMethodSecurityExpressionHandler] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2021-11-03 13:41:45,921 INFO org.springframework.context.support.PostProcessorRegistrationDelegate$BeanPostProcessorChecker [main] Bean 'methodSecurityMetadataSource' of type [org.springframework.security.access.method.DelegatingMethodSecurityMetadataSource] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2021-11-03 13:41:46,078 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat initialized with port(s): 80 (http)
2021-11-03 13:41:46,094 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-80"]
2021-11-03 13:41:46,094 INFO org.apache.juli.logging.DirectJDKLog [main] Starting service [Tomcat]
2021-11-03 13:41:46,094 INFO org.apache.juli.logging.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/9.0.52]
2021-11-03 13:41:46,188 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2021-11-03 13:41:46,188 INFO org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 1103 ms
2021-11-03 13:41:46,306 INFO org.hibernate.jpa.internal.util.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2021-11-03 13:41:46,322 INFO org.hibernate.Version [main] HHH000412: Hibernate ORM core version 5.4.32.Final
2021-11-03 13:41:46,407 INFO org.hibernate.annotations.common.reflection.java.JavaReflectionManager [main] HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2021-11-03 13:41:46,456 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2021-11-03 13:41:46,636 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2021-11-03 13:41:46,652 INFO org.hibernate.dialect.Dialect [main] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL94Dialect
2021-11-03 13:41:47,172 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] SQL Warning Code: 0, SQLState: 00000
2021-11-03 13:41:47,172 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] удаление распространяется на объект ограничение fkrhfovtciq1l558cw6udg0h0d3 в отношении таблица user_roles
2021-11-03 13:41:47,172 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] SQL Warning Code: 0, SQLState: 00000
2021-11-03 13:41:47,172 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] удаление распространяется на объект ограничение fkhfh9dx7w3ubf1co1vdev94g3f в отношении таблица user_roles
2021-11-03 13:41:47,172 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] SQL Warning Code: 0, SQLState: 00000
2021-11-03 13:41:47,187 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] ограничение "fkrhfovtciq1l558cw6udg0h0d3" в таблице "user_roles" не существует, пропускается
2021-11-03 13:41:47,187 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] SQL Warning Code: 0, SQLState: 00000
2021-11-03 13:41:47,187 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] ограничение "fkhfh9dx7w3ubf1co1vdev94g3f" в таблице "user_roles" не существует, пропускается
2021-11-03 13:41:47,234 INFO org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator [main] HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2021-11-03 13:41:47,234 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2021-11-03 13:41:47,808 INFO org.springframework.boot.autoconfigure.web.servlet.WelcomePageHandlerMapping [main] Adding welcome page template: index
2021-11-03 13:41:48,027 INFO org.springframework.security.web.DefaultSecurityFilterChain [main] Will secure Ant [pattern='/admin'] with [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@37c45154, org.springframework.security.web.context.SecurityContextPersistenceFilter@2809e38a, org.springframework.security.web.header.HeaderWriterFilter@7602c65d, org.springframework.security.web.csrf.CsrfFilter@664083f6, org.springframework.security.web.authentication.logout.LogoutFilter@65f3f9e2, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@54eb2bf6, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@3b399f5a, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@65f96d58, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@55300b93, org.springframework.security.web.access.ExceptionTranslationFilter@5a23b9d1]
2021-11-03 13:41:48,043 INFO org.springframework.security.web.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@79982bcc, org.springframework.security.web.context.SecurityContextPersistenceFilter@1a48a582, org.springframework.security.web.header.HeaderWriterFilter@57abe94d, org.springframework.security.web.authentication.logout.LogoutFilter@627a890f, org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter@26c1f3eb, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@1221d607, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@4b45c8e4, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@16b2d182, org.springframework.security.web.session.SessionManagementFilter@5d957cf0, org.springframework.security.web.access.ExceptionTranslationFilter@135a8808, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@1e5e2e06]
2021-11-03 13:41:48,074 INFO org.apache.juli.logging.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-80"]
2021-11-03 13:41:48,090 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat started on port(s): 80 (http) with context path ''
2021-11-03 13:41:48,105 INFO org.springframework.boot.StartupInfoLogger [main] Started Application in 3.427 seconds (JVM running for 4.003)
2021-11-03 13:41:48,410 INFO org.apache.juli.logging.DirectJDKLog [http-nio-80-exec-1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2021-11-03 13:41:48,410 INFO org.springframework.web.servlet.FrameworkServlet [http-nio-80-exec-1] Initializing Servlet 'dispatcherServlet'
2021-11-03 13:41:48,411 INFO org.springframework.web.servlet.FrameworkServlet [http-nio-80-exec-1] Completed initialization in 1 ms
2021-11-03 13:43:18,672 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2021-11-03 13:43:18,672 INFO com.zaxxer.hikari.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2021-11-03 13:43:18,688 INFO com.zaxxer.hikari.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2021-11-03 13:43:24,659 INFO org.springframework.boot.StartupInfoLogger [main] Starting Application using Java 11.0.11 on DESKTOP-MME1U5F with PID 13608 (C:\Users\HP-Note\IdeaProjects\JM-PP-3-1-3\target\classes started by HP-Note in C:\Users\HP-Note\IdeaProjects\JM-PP-3-1-3)
2021-11-03 13:43:24,659 INFO org.hibernate.validator.internal.util.Version [background-preinit] HV000001: Hibernate Validator 6.2.0.Final
2021-11-03 13:43:24,659 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2021-11-03 13:43:25,231 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2021-11-03 13:43:25,246 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 10 ms. Found 0 JPA repository interfaces.
2021-11-03 13:43:25,521 INFO org.springframework.context.support.PostProcessorRegistrationDelegate$BeanPostProcessorChecker [main] Bean 'org.springframework.security.access.expression.method.DefaultMethodSecurityExpressionHandler@43c87306' of type [org.springframework.security.access.expression.method.DefaultMethodSecurityExpressionHandler] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2021-11-03 13:43:25,521 INFO org.springframework.context.support.PostProcessorRegistrationDelegate$BeanPostProcessorChecker [main] Bean 'methodSecurityMetadataSource' of type [org.springframework.security.access.method.DelegatingMethodSecurityMetadataSource] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2021-11-03 13:43:25,700 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat initialized with port(s): 80 (http)
2021-11-03 13:43:25,708 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-80"]
2021-11-03 13:43:25,708 INFO org.apache.juli.logging.DirectJDKLog [main] Starting service [Tomcat]
2021-11-03 13:43:25,708 INFO org.apache.juli.logging.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/9.0.52]
2021-11-03 13:43:25,774 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2021-11-03 13:43:25,774 INFO org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 1083 ms
2021-11-03 13:43:25,915 INFO org.hibernate.jpa.internal.util.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2021-11-03 13:43:25,946 INFO org.hibernate.Version [main] HHH000412: Hibernate ORM core version 5.4.32.Final
2021-11-03 13:43:26,009 INFO org.hibernate.annotations.common.reflection.java.JavaReflectionManager [main] HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2021-11-03 13:43:26,071 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2021-11-03 13:43:26,306 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2021-11-03 13:43:26,306 INFO org.hibernate.dialect.Dialect [main] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL94Dialect
2021-11-03 13:43:26,838 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] SQL Warning Code: 0, SQLState: 00000
2021-11-03 13:43:26,838 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] удаление распространяется на объект ограничение fkrhfovtciq1l558cw6udg0h0d3 в отношении таблица user_roles
2021-11-03 13:43:26,838 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] SQL Warning Code: 0, SQLState: 00000
2021-11-03 13:43:26,838 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] удаление распространяется на объект ограничение fkhfh9dx7w3ubf1co1vdev94g3f в отношении таблица user_roles
2021-11-03 13:43:26,838 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] SQL Warning Code: 0, SQLState: 00000
2021-11-03 13:43:26,838 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] ограничение "fkrhfovtciq1l558cw6udg0h0d3" в таблице "user_roles" не существует, пропускается
2021-11-03 13:43:26,838 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] SQL Warning Code: 0, SQLState: 00000
2021-11-03 13:43:26,838 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] ограничение "fkhfh9dx7w3ubf1co1vdev94g3f" в таблице "user_roles" не существует, пропускается
2021-11-03 13:43:26,885 INFO org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator [main] HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2021-11-03 13:43:26,901 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2021-11-03 13:43:27,439 INFO org.springframework.boot.autoconfigure.web.servlet.WelcomePageHandlerMapping [main] Adding welcome page template: index
2021-11-03 13:43:27,642 INFO org.springframework.security.web.DefaultSecurityFilterChain [main] Will secure Ant [pattern='/admin'] with [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@65f96d58, org.springframework.security.web.context.SecurityContextPersistenceFilter@5a23b9d1, org.springframework.security.web.header.HeaderWriterFilter@41e76252, org.springframework.security.web.csrf.CsrfFilter@1b868ef0, org.springframework.security.web.authentication.logout.LogoutFilter@78ab63b5, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@1e2c0292, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@3183a37c, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@5c261c74, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@48a61e38, org.springframework.security.web.access.ExceptionTranslationFilter@31e9d94f]
2021-11-03 13:43:27,658 INFO org.springframework.security.web.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@6b286640, org.springframework.security.web.context.SecurityContextPersistenceFilter@257708e, org.springframework.security.web.header.HeaderWriterFilter@73dd3a46, org.springframework.security.web.authentication.logout.LogoutFilter@6d01f2e5, org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter@14980819, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@18c26588, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@6167a456, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@294a12b5, org.springframework.security.web.session.SessionManagementFilter@71e89a26, org.springframework.security.web.access.ExceptionTranslationFilter@394950ad, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@167bae0b]
2021-11-03 13:43:27,705 INFO org.apache.juli.logging.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-80"]
2021-11-03 13:43:27,720 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat started on port(s): 80 (http) with context path ''
2021-11-03 13:43:27,720 INFO org.springframework.boot.StartupInfoLogger [main] Started Application in 3.447 seconds (JVM running for 4.012)
2021-11-03 13:43:28,050 INFO org.apache.juli.logging.DirectJDKLog [http-nio-80-exec-1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2021-11-03 13:43:28,050 INFO org.springframework.web.servlet.FrameworkServlet [http-nio-80-exec-1] Initializing Servlet 'dispatcherServlet'
2021-11-03 13:43:28,051 INFO org.springframework.web.servlet.FrameworkServlet [http-nio-80-exec-1] Completed initialization in 1 ms
2021-11-03 13:46:59,201 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2021-11-03 13:46:59,217 INFO com.zaxxer.hikari.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2021-11-03 13:46:59,217 INFO com.zaxxer.hikari.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2021-11-03 13:47:03,491 INFO org.hibernate.validator.internal.util.Version [background-preinit] HV000001: Hibernate Validator 6.2.0.Final
2021-11-03 13:47:03,491 INFO org.springframework.boot.StartupInfoLogger [main] Starting Application using Java 11.0.11 on DESKTOP-MME1U5F with PID 15036 (C:\Users\HP-Note\IdeaProjects\JM-PP-3-1-3\target\classes started by HP-Note in C:\Users\HP-Note\IdeaProjects\JM-PP-3-1-3)
2021-11-03 13:47:03,491 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2021-11-03 13:47:04,062 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2021-11-03 13:47:04,093 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 17 ms. Found 0 JPA repository interfaces.
2021-11-03 13:47:04,346 INFO org.springframework.context.support.PostProcessorRegistrationDelegate$BeanPostProcessorChecker [main] Bean 'org.springframework.security.access.expression.method.DefaultMethodSecurityExpressionHandler@554c4eaa' of type [org.springframework.security.access.expression.method.DefaultMethodSecurityExpressionHandler] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2021-11-03 13:47:04,362 INFO org.springframework.context.support.PostProcessorRegistrationDelegate$BeanPostProcessorChecker [main] Bean 'methodSecurityMetadataSource' of type [org.springframework.security.access.method.DelegatingMethodSecurityMetadataSource] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2021-11-03 13:47:04,529 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat initialized with port(s): 80 (http)
2021-11-03 13:47:04,529 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-80"]
2021-11-03 13:47:04,529 INFO org.apache.juli.logging.DirectJDKLog [main] Starting service [Tomcat]
2021-11-03 13:47:04,529 INFO org.apache.juli.logging.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/9.0.52]
2021-11-03 13:47:04,638 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2021-11-03 13:47:04,638 INFO org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 1116 ms
2021-11-03 13:47:04,763 INFO org.hibernate.jpa.internal.util.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2021-11-03 13:47:04,792 INFO org.hibernate.Version [main] HHH000412: Hibernate ORM core version 5.4.32.Final
2021-11-03 13:47:04,845 INFO org.hibernate.annotations.common.reflection.java.JavaReflectionManager [main] HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2021-11-03 13:47:04,925 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2021-11-03 13:47:05,066 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2021-11-03 13:47:05,066 INFO org.hibernate.dialect.Dialect [main] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL94Dialect
2021-11-03 13:47:05,605 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] SQL Warning Code: 0, SQLState: 00000
2021-11-03 13:47:05,605 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] удаление распространяется на объект ограничение fkrhfovtciq1l558cw6udg0h0d3 в отношении таблица user_roles
2021-11-03 13:47:05,605 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] SQL Warning Code: 0, SQLState: 00000
2021-11-03 13:47:05,605 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] удаление распространяется на объект ограничение fkhfh9dx7w3ubf1co1vdev94g3f в отношении таблица user_roles
2021-11-03 13:47:05,605 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] SQL Warning Code: 0, SQLState: 00000
2021-11-03 13:47:05,605 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] ограничение "fkrhfovtciq1l558cw6udg0h0d3" в таблице "user_roles" не существует, пропускается
2021-11-03 13:47:05,605 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] SQL Warning Code: 0, SQLState: 00000
2021-11-03 13:47:05,605 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] ограничение "fkhfh9dx7w3ubf1co1vdev94g3f" в таблице "user_roles" не существует, пропускается
2021-11-03 13:47:05,636 INFO org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator [main] HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2021-11-03 13:47:05,652 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2021-11-03 13:47:06,210 INFO org.springframework.boot.autoconfigure.web.servlet.WelcomePageHandlerMapping [main] Adding welcome page template: index
2021-11-03 13:47:06,413 INFO org.springframework.security.web.DefaultSecurityFilterChain [main] Will secure Ant [pattern='/admin'] with [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@55300b93, org.springframework.security.web.context.SecurityContextPersistenceFilter@b9c9bf5, org.springframework.security.web.header.HeaderWriterFilter@5a5c2889, org.springframework.security.web.csrf.CsrfFilter@5a8835c6, org.springframework.security.web.authentication.logout.LogoutFilter@394950ad, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@6d01f2e5, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@16f2d883, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@48a61e38, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@123426a9, org.springframework.security.web.access.ExceptionTranslationFilter@3962b216]
2021-11-03 13:47:06,444 INFO org.springframework.security.web.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@16b2d182, org.springframework.security.web.context.SecurityContextPersistenceFilter@1221d607, org.springframework.security.web.header.HeaderWriterFilter@51b11186, org.springframework.security.web.authentication.logout.LogoutFilter@7ef7faa9, org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter@79982bcc, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@4b45c8e4, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@3dc14f80, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@79f3f34c, org.springframework.security.web.session.SessionManagementFilter@1a48a582, org.springframework.security.web.access.ExceptionTranslationFilter@57abe94d, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@26c1f3eb]
2021-11-03 13:47:06,475 INFO org.apache.juli.logging.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-80"]
2021-11-03 13:47:06,494 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat started on port(s): 80 (http) with context path ''
2021-11-03 13:47:06,503 INFO org.springframework.boot.StartupInfoLogger [main] Started Application in 3.42 seconds (JVM running for 3.974)
2021-11-03 13:47:06,853 INFO org.apache.juli.logging.DirectJDKLog [http-nio-80-exec-1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2021-11-03 13:47:06,853 INFO org.springframework.web.servlet.FrameworkServlet [http-nio-80-exec-1] Initializing Servlet 'dispatcherServlet'
2021-11-03 13:47:06,854 INFO org.springframework.web.servlet.FrameworkServlet [http-nio-80-exec-1] Completed initialization in 1 ms
2021-11-03 13:48:20,307 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2021-11-03 13:48:20,307 INFO com.zaxxer.hikari.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2021-11-03 13:48:20,329 INFO com.zaxxer.hikari.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2021-11-03 13:48:23,204 INFO org.hibernate.validator.internal.util.Version [background-preinit] HV000001: Hibernate Validator 6.2.0.Final
2021-11-03 13:48:23,204 INFO org.springframework.boot.StartupInfoLogger [main] Starting Application using Java 11.0.11 on DESKTOP-MME1U5F with PID 13364 (C:\Users\HP-Note\IdeaProjects\JM-PP-3-1-3\target\classes started by HP-Note in C:\Users\HP-Note\IdeaProjects\JM-PP-3-1-3)
2021-11-03 13:48:23,204 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2021-11-03 13:48:23,783 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2021-11-03 13:48:23,799 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 10 ms. Found 0 JPA repository interfaces.
2021-11-03 13:48:24,041 INFO org.springframework.context.support.PostProcessorRegistrationDelegate$BeanPostProcessorChecker [main] Bean 'org.springframework.security.access.expression.method.DefaultMethodSecurityExpressionHandler@6dd1f638' of type [org.springframework.security.access.expression.method.DefaultMethodSecurityExpressionHandler] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2021-11-03 13:48:24,041 INFO org.springframework.context.support.PostProcessorRegistrationDelegate$BeanPostProcessorChecker [main] Bean 'methodSecurityMetadataSource' of type [org.springframework.security.access.method.DelegatingMethodSecurityMetadataSource] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2021-11-03 13:48:24,220 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat initialized with port(s): 80 (http)
2021-11-03 13:48:24,236 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-80"]
2021-11-03 13:48:24,236 INFO org.apache.juli.logging.DirectJDKLog [main] Starting service [Tomcat]
2021-11-03 13:48:24,236 INFO org.apache.juli.logging.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/9.0.52]
2021-11-03 13:48:24,314 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2021-11-03 13:48:24,314 INFO org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 1079 ms
2021-11-03 13:48:24,452 INFO org.hibernate.jpa.internal.util.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2021-11-03 13:48:24,483 INFO org.hibernate.Version [main] HHH000412: Hibernate ORM core version 5.4.32.Final
2021-11-03 13:48:24,561 INFO org.hibernate.annotations.common.reflection.java.JavaReflectionManager [main] HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2021-11-03 13:48:24,617 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2021-11-03 13:48:24,758 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2021-11-03 13:48:24,758 INFO org.hibernate.dialect.Dialect [main] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL94Dialect
2021-11-03 13:48:25,277 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] SQL Warning Code: 0, SQLState: 00000
2021-11-03 13:48:25,277 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] удаление распространяется на объект ограничение fkrhfovtciq1l558cw6udg0h0d3 в отношении таблица user_roles
2021-11-03 13:48:25,277 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] SQL Warning Code: 0, SQLState: 00000
2021-11-03 13:48:25,277 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] удаление распространяется на объект ограничение fkhfh9dx7w3ubf1co1vdev94g3f в отношении таблица user_roles
2021-11-03 13:48:25,277 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] SQL Warning Code: 0, SQLState: 00000
2021-11-03 13:48:25,277 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] ограничение "fkrhfovtciq1l558cw6udg0h0d3" в таблице "user_roles" не существует, пропускается
2021-11-03 13:48:25,277 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] SQL Warning Code: 0, SQLState: 00000
2021-11-03 13:48:25,292 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] ограничение "fkhfh9dx7w3ubf1co1vdev94g3f" в таблице "user_roles" не существует, пропускается
2021-11-03 13:48:25,324 INFO org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator [main] HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2021-11-03 13:48:25,324 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2021-11-03 13:48:25,863 INFO org.springframework.boot.autoconfigure.web.servlet.WelcomePageHandlerMapping [main] Adding welcome page template: index
2021-11-03 13:48:26,066 INFO org.springframework.security.web.DefaultSecurityFilterChain [main] Will secure Ant [pattern='/admin'] with [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@227fc322, org.springframework.security.web.context.SecurityContextPersistenceFilter@61d527ac, org.springframework.security.web.header.HeaderWriterFilter@c7a1db6, org.springframework.security.web.csrf.CsrfFilter@2dec57c5, org.springframework.security.web.authentication.logout.LogoutFilter@48a61e38, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@5d32f5db, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@380e3122, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@4e13af1b, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@63053b71, org.springframework.security.web.access.ExceptionTranslationFilter@664083f6]
2021-11-03 13:48:26,082 INFO org.springframework.security.web.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@48301bfe, org.springframework.security.web.context.SecurityContextPersistenceFilter@3083e6ef, org.springframework.security.web.header.HeaderWriterFilter@4353db40, org.springframework.security.web.authentication.logout.LogoutFilter@58c16efd, org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter@7054c068, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@6d57b264, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@782ed745, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@6dd1f239, org.springframework.security.web.session.SessionManagementFilter@3b1895e, org.springframework.security.web.access.ExceptionTranslationFilter@123426a9, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@1e4b70c6]
2021-11-03 13:48:26,113 INFO org.apache.juli.logging.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-80"]
2021-11-03 13:48:26,128 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat started on port(s): 80 (http) with context path ''
2021-11-03 13:48:26,144 INFO org.springframework.boot.StartupInfoLogger [main] Started Application in 3.322 seconds (JVM running for 3.896)
2021-11-03 13:48:26,538 INFO org.apache.juli.logging.DirectJDKLog [http-nio-80-exec-1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2021-11-03 13:48:26,538 INFO org.springframework.web.servlet.FrameworkServlet [http-nio-80-exec-1] Initializing Servlet 'dispatcherServlet'
2021-11-03 13:48:26,539 INFO org.springframework.web.servlet.FrameworkServlet [http-nio-80-exec-1] Completed initialization in 1 ms
2021-11-03 13:51:17,937 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2021-11-03 13:51:17,937 INFO com.zaxxer.hikari.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2021-11-03 13:51:17,953 INFO com.zaxxer.hikari.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2021-11-03 13:51:22,044 INFO org.hibernate.validator.internal.util.Version [background-preinit] HV000001: Hibernate Validator 6.2.0.Final
2021-11-03 13:51:22,044 INFO org.springframework.boot.StartupInfoLogger [main] Starting Application using Java 11.0.11 on DESKTOP-MME1U5F with PID 12600 (C:\Users\HP-Note\IdeaProjects\JM-PP-3-1-3\target\classes started by HP-Note in C:\Users\HP-Note\IdeaProjects\JM-PP-3-1-3)
2021-11-03 13:51:22,044 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2021-11-03 13:51:22,603 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2021-11-03 13:51:22,619 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 11 ms. Found 0 JPA repository interfaces.
2021-11-03 13:51:22,900 INFO org.springframework.context.support.PostProcessorRegistrationDelegate$BeanPostProcessorChecker [main] Bean 'org.springframework.security.access.expression.method.DefaultMethodSecurityExpressionHandler@410ae5ac' of type [org.springframework.security.access.expression.method.DefaultMethodSecurityExpressionHandler] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2021-11-03 13:51:22,900 INFO org.springframework.context.support.PostProcessorRegistrationDelegate$BeanPostProcessorChecker [main] Bean 'methodSecurityMetadataSource' of type [org.springframework.security.access.method.DelegatingMethodSecurityMetadataSource] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2021-11-03 13:51:23,087 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat initialized with port(s): 80 (http)
2021-11-03 13:51:23,103 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-80"]
2021-11-03 13:51:23,103 INFO org.apache.juli.logging.DirectJDKLog [main] Starting service [Tomcat]
2021-11-03 13:51:23,103 INFO org.apache.juli.logging.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/9.0.52]
2021-11-03 13:51:23,166 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2021-11-03 13:51:23,166 INFO org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 1075 ms
2021-11-03 13:51:23,306 INFO org.hibernate.jpa.internal.util.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2021-11-03 13:51:23,322 INFO org.hibernate.Version [main] HHH000412: Hibernate ORM core version 5.4.32.Final
2021-11-03 13:51:23,400 INFO org.hibernate.annotations.common.reflection.java.JavaReflectionManager [main] HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2021-11-03 13:51:23,478 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2021-11-03 13:51:23,634 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2021-11-03 13:51:23,634 INFO org.hibernate.dialect.Dialect [main] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL94Dialect
2021-11-03 13:51:24,120 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] SQL Warning Code: 0, SQLState: 00000
2021-11-03 13:51:24,120 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] удаление распространяется на объект ограничение fkrhfovtciq1l558cw6udg0h0d3 в отношении таблица user_roles
2021-11-03 13:51:24,120 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] SQL Warning Code: 0, SQLState: 00000
2021-11-03 13:51:24,120 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] удаление распространяется на объект ограничение fkhfh9dx7w3ubf1co1vdev94g3f в отношении таблица user_roles
2021-11-03 13:51:24,120 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] SQL Warning Code: 0, SQLState: 00000
2021-11-03 13:51:24,120 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] ограничение "fkrhfovtciq1l558cw6udg0h0d3" в таблице "user_roles" не существует, пропускается
2021-11-03 13:51:24,120 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] SQL Warning Code: 0, SQLState: 00000
2021-11-03 13:51:24,135 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] ограничение "fkhfh9dx7w3ubf1co1vdev94g3f" в таблице "user_roles" не существует, пропускается
2021-11-03 13:51:24,167 INFO org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator [main] HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2021-11-03 13:51:24,167 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2021-11-03 13:51:24,727 INFO org.springframework.boot.autoconfigure.web.servlet.WelcomePageHandlerMapping [main] Adding welcome page template: index
2021-11-03 13:51:24,974 INFO org.springframework.security.web.DefaultSecurityFilterChain [main] Will secure Ant [pattern='/admin'] with [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@51b11186, org.springframework.security.web.context.SecurityContextPersistenceFilter@69c51fdb, org.springframework.security.web.header.HeaderWriterFilter@468eff41, org.springframework.security.web.csrf.CsrfFilter@7602c65d, org.springframework.security.web.authentication.logout.LogoutFilter@6d57b264, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@51eafec0, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@68a97fc1, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@bae5e58, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@5d957cf0, org.springframework.security.web.access.ExceptionTranslationFilter@3777fc44]
2021-11-03 13:51:24,990 INFO org.springframework.security.web.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@128ca7af, org.springframework.security.web.context.SecurityContextPersistenceFilter@52a2e2fb, org.springframework.security.web.header.HeaderWriterFilter@2041c9a3, org.springframework.security.web.authentication.logout.LogoutFilter@549404e7, org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter@3bac86a3, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@7c0035dd, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@5089a72b, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@3bf52f8f, org.springframework.security.web.session.SessionManagementFilter@2bed5828, org.springframework.security.web.access.ExceptionTranslationFilter@24bba1b7, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@4d142b53]
2021-11-03 13:51:25,031 INFO org.apache.juli.logging.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-80"]
2021-11-03 13:51:25,046 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat started on port(s): 80 (http) with context path ''
2021-11-03 13:51:25,062 INFO org.springframework.boot.StartupInfoLogger [main] Started Application in 3.41 seconds (JVM running for 3.991)
2021-11-03 13:51:25,410 INFO org.apache.juli.logging.DirectJDKLog [http-nio-80-exec-1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2021-11-03 13:51:25,410 INFO org.springframework.web.servlet.FrameworkServlet [http-nio-80-exec-1] Initializing Servlet 'dispatcherServlet'
2021-11-03 13:51:25,411 INFO org.springframework.web.servlet.FrameworkServlet [http-nio-80-exec-1] Completed initialization in 1 ms
2021-11-03 13:52:04,661 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2021-11-03 13:52:04,661 INFO com.zaxxer.hikari.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2021-11-03 13:52:04,677 INFO com.zaxxer.hikari.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2021-11-03 13:52:08,362 INFO org.hibernate.validator.internal.util.Version [background-preinit] HV000001: Hibernate Validator 6.2.0.Final
2021-11-03 13:52:08,362 INFO org.springframework.boot.StartupInfoLogger [main] Starting Application using Java 11.0.11 on DESKTOP-MME1U5F with PID 9960 (C:\Users\HP-Note\IdeaProjects\JM-PP-3-1-3\target\classes started by HP-Note in C:\Users\HP-Note\IdeaProjects\JM-PP-3-1-3)
2021-11-03 13:52:08,362 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2021-11-03 13:52:08,927 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2021-11-03 13:52:08,943 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 10 ms. Found 0 JPA repository interfaces.
2021-11-03 13:52:09,224 INFO org.springframework.context.support.PostProcessorRegistrationDelegate$BeanPostProcessorChecker [main] Bean 'org.springframework.security.access.expression.method.DefaultMethodSecurityExpressionHandler@38c9e0d6' of type [org.springframework.security.access.expression.method.DefaultMethodSecurityExpressionHandler] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2021-11-03 13:52:09,224 INFO org.springframework.context.support.PostProcessorRegistrationDelegate$BeanPostProcessorChecker [main] Bean 'methodSecurityMetadataSource' of type [org.springframework.security.access.method.DelegatingMethodSecurityMetadataSource] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2021-11-03 13:52:09,520 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat initialized with port(s): 80 (http)
2021-11-03 13:52:09,526 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-80"]
2021-11-03 13:52:09,541 INFO org.apache.juli.logging.DirectJDKLog [main] Starting service [Tomcat]
2021-11-03 13:52:09,541 INFO org.apache.juli.logging.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/9.0.52]
2021-11-03 13:52:09,651 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2021-11-03 13:52:09,651 INFO org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 1257 ms
2021-11-03 13:52:09,791 INFO org.hibernate.jpa.internal.util.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2021-11-03 13:52:09,822 INFO org.hibernate.Version [main] HHH000412: Hibernate ORM core version 5.4.32.Final
2021-11-03 13:52:09,886 INFO org.hibernate.annotations.common.reflection.java.JavaReflectionManager [main] HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2021-11-03 13:52:09,933 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2021-11-03 13:52:10,104 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2021-11-03 13:52:10,120 INFO org.hibernate.dialect.Dialect [main] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL94Dialect
2021-11-03 13:52:10,643 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] SQL Warning Code: 0, SQLState: 00000
2021-11-03 13:52:10,643 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] удаление распространяется на объект ограничение fkrhfovtciq1l558cw6udg0h0d3 в отношении таблица user_roles
2021-11-03 13:52:10,643 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] SQL Warning Code: 0, SQLState: 00000
2021-11-03 13:52:10,643 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] удаление распространяется на объект ограничение fkhfh9dx7w3ubf1co1vdev94g3f в отношении таблица user_roles
2021-11-03 13:52:10,643 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] SQL Warning Code: 0, SQLState: 00000
2021-11-03 13:52:10,643 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] ограничение "fkrhfovtciq1l558cw6udg0h0d3" в таблице "user_roles" не существует, пропускается
2021-11-03 13:52:10,643 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] SQL Warning Code: 0, SQLState: 00000
2021-11-03 13:52:10,643 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] ограничение "fkhfh9dx7w3ubf1co1vdev94g3f" в таблице "user_roles" не существует, пропускается
2021-11-03 13:52:10,690 INFO org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator [main] HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2021-11-03 13:52:10,690 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2021-11-03 13:52:11,233 INFO org.springframework.boot.autoconfigure.web.servlet.WelcomePageHandlerMapping [main] Adding welcome page template: index
2021-11-03 13:52:11,440 INFO org.springframework.security.web.DefaultSecurityFilterChain [main] Will secure Ant [pattern='/admin'] with [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@37d8562f, org.springframework.security.web.context.SecurityContextPersistenceFilter@31a80c88, org.springframework.security.web.header.HeaderWriterFilter@6d6d81c, org.springframework.security.web.csrf.CsrfFilter@2a7b5925, org.springframework.security.web.authentication.logout.LogoutFilter@2809e38a, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@1bbfd42f, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@5a5c2889, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@d7c4fcb, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@19656e21, org.springframework.security.web.access.ExceptionTranslationFilter@3e3bf77b]
2021-11-03 13:52:11,472 INFO org.springframework.security.web.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@3606eee9, org.springframework.security.web.context.SecurityContextPersistenceFilter@54eb2bf6, org.springframework.security.web.header.HeaderWriterFilter@257708e, org.springframework.security.web.authentication.logout.LogoutFilter@37c45154, org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter@628aea61, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@6d01f2e5, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@66e434e8, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@1e34840f, org.springframework.security.web.session.SessionManagementFilter@6167a456, org.springframework.security.web.access.ExceptionTranslationFilter@71e89a26, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@294a12b5]
2021-11-03 13:52:11,503 INFO org.apache.juli.logging.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-80"]
2021-11-03 13:52:11,523 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat started on port(s): 80 (http) with context path ''
2021-11-03 13:52:11,531 INFO org.springframework.boot.StartupInfoLogger [main] Started Application in 3.578 seconds (JVM running for 4.179)
2021-11-03 13:52:11,838 INFO org.apache.juli.logging.DirectJDKLog [http-nio-80-exec-1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2021-11-03 13:52:11,838 INFO org.springframework.web.servlet.FrameworkServlet [http-nio-80-exec-1] Initializing Servlet 'dispatcherServlet'
2021-11-03 13:52:11,840 INFO org.springframework.web.servlet.FrameworkServlet [http-nio-80-exec-1] Completed initialization in 2 ms
2021-11-03 13:52:13,439 WARN org.apache.juli.logging.DirectJDKLog [http-nio-80-exec-3] Creation of SecureRandom instance for session ID generation using [SHA1PRNG] took [124] milliseconds.
2021-11-03 13:54:09,139 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2021-11-03 13:54:09,154 INFO com.zaxxer.hikari.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2021-11-03 13:54:09,164 INFO com.zaxxer.hikari.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2021-11-03 13:54:14,692 INFO org.hibernate.validator.internal.util.Version [background-preinit] HV000001: Hibernate Validator 6.2.0.Final
2021-11-03 13:54:14,692 INFO org.springframework.boot.StartupInfoLogger [main] Starting Application using Java 11.0.11 on DESKTOP-MME1U5F with PID 11684 (C:\Users\HP-Note\IdeaProjects\JM-PP-3-1-3\target\classes started by HP-Note in C:\Users\HP-Note\IdeaProjects\JM-PP-3-1-3)
2021-11-03 13:54:14,692 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2021-11-03 13:54:15,237 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2021-11-03 13:54:15,253 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 10 ms. Found 0 JPA repository interfaces.
2021-11-03 13:54:15,556 INFO org.springframework.context.support.PostProcessorRegistrationDelegate$BeanPostProcessorChecker [main] Bean 'org.springframework.security.access.expression.method.DefaultMethodSecurityExpressionHandler@593a6726' of type [org.springframework.security.access.expression.method.DefaultMethodSecurityExpressionHandler] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2021-11-03 13:54:15,560 INFO org.springframework.context.support.PostProcessorRegistrationDelegate$BeanPostProcessorChecker [main] Bean 'methodSecurityMetadataSource' of type [org.springframework.security.access.method.DelegatingMethodSecurityMetadataSource] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2021-11-03 13:54:15,772 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat initialized with port(s): 80 (http)
2021-11-03 13:54:15,780 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-80"]
2021-11-03 13:54:15,780 INFO org.apache.juli.logging.DirectJDKLog [main] Starting service [Tomcat]
2021-11-03 13:54:15,780 INFO org.apache.juli.logging.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/9.0.52]
2021-11-03 13:54:15,886 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2021-11-03 13:54:15,887 INFO org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 1148 ms
2021-11-03 13:54:15,991 INFO org.hibernate.jpa.internal.util.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2021-11-03 13:54:16,022 INFO org.hibernate.Version [main] HHH000412: Hibernate ORM core version 5.4.32.Final
2021-11-03 13:54:16,085 INFO org.hibernate.annotations.common.reflection.java.JavaReflectionManager [main] HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2021-11-03 13:54:16,179 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2021-11-03 13:54:16,363 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2021-11-03 13:54:16,373 INFO org.hibernate.dialect.Dialect [main] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL94Dialect
2021-11-03 13:54:16,870 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] SQL Warning Code: 0, SQLState: 00000
2021-11-03 13:54:16,870 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] удаление распространяется на объект ограничение fkrhfovtciq1l558cw6udg0h0d3 в отношении таблица user_roles
2021-11-03 13:54:16,870 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] SQL Warning Code: 0, SQLState: 00000
2021-11-03 13:54:16,870 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] удаление распространяется на объект ограничение fkhfh9dx7w3ubf1co1vdev94g3f в отношении таблица user_roles
2021-11-03 13:54:16,870 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] SQL Warning Code: 0, SQLState: 00000
2021-11-03 13:54:16,870 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] ограничение "fkrhfovtciq1l558cw6udg0h0d3" в таблице "user_roles" не существует, пропускается
2021-11-03 13:54:16,870 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] SQL Warning Code: 0, SQLState: 00000
2021-11-03 13:54:16,870 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] ограничение "fkhfh9dx7w3ubf1co1vdev94g3f" в таблице "user_roles" не существует, пропускается
2021-11-03 13:54:16,917 INFO org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator [main] HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2021-11-03 13:54:16,917 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2021-11-03 13:54:17,427 INFO org.springframework.boot.autoconfigure.web.servlet.WelcomePageHandlerMapping [main] Adding welcome page template: index
2021-11-03 13:54:17,627 INFO org.springframework.security.web.DefaultSecurityFilterChain [main] Will secure Ant [pattern='/admin'] with [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@7a74672, org.springframework.security.web.context.SecurityContextPersistenceFilter@7bd7c4cf, org.springframework.security.web.header.HeaderWriterFilter@4d7f9b33, org.springframework.security.web.csrf.CsrfFilter@6ffa8126, org.springframework.security.web.authentication.logout.LogoutFilter@5b8599c7, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@6d6d81c, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@67b20b4c, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@63ccb1b2, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@35b79b1f, org.springframework.security.web.access.ExceptionTranslationFilter@694f0655]
2021-11-03 13:54:17,643 INFO org.springframework.security.web.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@4353db40, org.springframework.security.web.context.SecurityContextPersistenceFilter@7602c65d, org.springframework.security.web.header.HeaderWriterFilter@3962b216, org.springframework.security.web.authentication.logout.LogoutFilter@6785786d, org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter@123426a9, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@5a5c2889, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@7668f8fd, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@56887c8f, org.springframework.security.web.session.SessionManagementFilter@31a80c88, org.springframework.security.web.access.ExceptionTranslationFilter@5a23b9d1, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@55300b93]
2021-11-03 13:54:17,674 INFO org.apache.juli.logging.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-80"]
2021-11-03 13:54:17,690 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat started on port(s): 80 (http) with context path ''
2021-11-03 13:54:17,705 INFO org.springframework.boot.StartupInfoLogger [main] Started Application in 3.434 seconds (JVM running for 4.071)
2021-11-03 13:54:18,010 INFO org.apache.juli.logging.DirectJDKLog [http-nio-80-exec-1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2021-11-03 13:54:18,010 INFO org.springframework.web.servlet.FrameworkServlet [http-nio-80-exec-1] Initializing Servlet 'dispatcherServlet'
2021-11-03 13:54:18,012 INFO org.springframework.web.servlet.FrameworkServlet [http-nio-80-exec-1] Completed initialization in 1 ms
2021-11-03 13:54:58,304 ERROR org.apache.juli.logging.DirectJDKLog [http-nio-80-exec-10] Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is org.springframework.web.client.ResourceAccessException: I/O error on GET request for "http://localhost:8080": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect] with root cause
java.net.ConnectException: Connection refused: connect
	at java.base/java.net.PlainSocketImpl.connect0(Native Method)
	at java.base/java.net.PlainSocketImpl.socketConnect(PlainSocketImpl.java:101)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:399)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:242)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:224)
	at java.base/java.net.Socket.connect(Socket.java:609)
	at java.base/java.net.Socket.connect(Socket.java:558)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:182)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:474)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:569)
	at java.base/sun.net.www.http.HttpClient.parseHTTP(HttpClient.java:709)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getInputStream0(HttpURLConnection.java:1615)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1520)
	at java.base/java.net.HttpURLConnection.getResponseCode(HttpURLConnection.java:527)
	at org.springframework.http.client.SimpleBufferingClientHttpRequest.executeInternal(SimpleBufferingClientHttpRequest.java:82)
	at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:66)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:776)
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:711)
	at org.springframework.web.client.RestTemplate.exchange(RestTemplate.java:602)
	at com.example.front.controller.GatewayRestController.userPage(GatewayRestController.java:49)
	at com.example.front.controller.GatewayRestController$$FastClassBySpringCGLIB$$fc584a81.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:779)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750)
	at org.springframework.security.access.intercept.aopalliance.MethodSecurityInterceptor.invoke(MethodSecurityInterceptor.java:61)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:692)
	at com.example.front.controller.GatewayRestController$$EnhancerBySpringCGLIB$$44ecac03.userPage(<generated>)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1064)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:655)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:327)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:121)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:115)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:105)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:218)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:212)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:110)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:80)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:211)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:183)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:358)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:271)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:94)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1726)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:829)
2021-11-03 13:54:59,427 ERROR org.apache.juli.logging.DirectJDKLog [http-nio-80-exec-1] Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is org.springframework.web.client.ResourceAccessException: I/O error on GET request for "http://localhost:8080": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect] with root cause
java.net.ConnectException: Connection refused: connect
	at java.base/java.net.PlainSocketImpl.connect0(Native Method)
	at java.base/java.net.PlainSocketImpl.socketConnect(PlainSocketImpl.java:101)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:399)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:242)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:224)
	at java.base/java.net.Socket.connect(Socket.java:609)
	at java.base/java.net.Socket.connect(Socket.java:558)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:182)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:474)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:569)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:242)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:341)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:362)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1253)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1187)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1081)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1015)
	at org.springframework.http.client.SimpleBufferingClientHttpRequest.executeInternal(SimpleBufferingClientHttpRequest.java:76)
	at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:66)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:776)
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:711)
	at org.springframework.web.client.RestTemplate.exchange(RestTemplate.java:602)
	at com.example.front.controller.GatewayRestController.userPage(GatewayRestController.java:49)
	at com.example.front.controller.GatewayRestController$$FastClassBySpringCGLIB$$fc584a81.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:779)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750)
	at org.springframework.security.access.intercept.aopalliance.MethodSecurityInterceptor.invoke(MethodSecurityInterceptor.java:61)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:692)
	at com.example.front.controller.GatewayRestController$$EnhancerBySpringCGLIB$$44ecac03.userPage(<generated>)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1064)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:655)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:327)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:121)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:115)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:105)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:218)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:212)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:110)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:80)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:211)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:183)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:358)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:271)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:94)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1726)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:829)
2021-11-03 13:55:00,482 ERROR org.apache.juli.logging.DirectJDKLog [http-nio-80-exec-2] Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is org.springframework.web.client.ResourceAccessException: I/O error on GET request for "http://localhost:8080": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect] with root cause
java.net.ConnectException: Connection refused: connect
	at java.base/java.net.PlainSocketImpl.connect0(Native Method)
	at java.base/java.net.PlainSocketImpl.socketConnect(PlainSocketImpl.java:101)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:399)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:242)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:224)
	at java.base/java.net.Socket.connect(Socket.java:609)
	at java.base/java.net.Socket.connect(Socket.java:558)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:182)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:474)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:569)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:242)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:341)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:362)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1253)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1187)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1081)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1015)
	at org.springframework.http.client.SimpleBufferingClientHttpRequest.executeInternal(SimpleBufferingClientHttpRequest.java:76)
	at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:66)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:776)
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:711)
	at org.springframework.web.client.RestTemplate.exchange(RestTemplate.java:602)
	at com.example.front.controller.GatewayRestController.userPage(GatewayRestController.java:49)
	at com.example.front.controller.GatewayRestController$$FastClassBySpringCGLIB$$fc584a81.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:779)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750)
	at org.springframework.security.access.intercept.aopalliance.MethodSecurityInterceptor.invoke(MethodSecurityInterceptor.java:61)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:692)
	at com.example.front.controller.GatewayRestController$$EnhancerBySpringCGLIB$$44ecac03.userPage(<generated>)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1064)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:655)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:327)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:121)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:115)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:105)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:218)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:212)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:110)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:80)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:211)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:183)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:358)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:271)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:94)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1726)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:829)
2021-11-03 13:55:01,537 ERROR org.apache.juli.logging.DirectJDKLog [http-nio-80-exec-3] Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is org.springframework.web.client.ResourceAccessException: I/O error on GET request for "http://localhost:8080": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect] with root cause
java.net.ConnectException: Connection refused: connect
	at java.base/java.net.PlainSocketImpl.connect0(Native Method)
	at java.base/java.net.PlainSocketImpl.socketConnect(PlainSocketImpl.java:101)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:399)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:242)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:224)
	at java.base/java.net.Socket.connect(Socket.java:609)
	at java.base/java.net.Socket.connect(Socket.java:558)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:182)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:474)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:569)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:242)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:341)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:362)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1253)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1187)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1081)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1015)
	at org.springframework.http.client.SimpleBufferingClientHttpRequest.executeInternal(SimpleBufferingClientHttpRequest.java:76)
	at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:66)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:776)
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:711)
	at org.springframework.web.client.RestTemplate.exchange(RestTemplate.java:602)
	at com.example.front.controller.GatewayRestController.userPage(GatewayRestController.java:49)
	at com.example.front.controller.GatewayRestController$$FastClassBySpringCGLIB$$fc584a81.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:779)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750)
	at org.springframework.security.access.intercept.aopalliance.MethodSecurityInterceptor.invoke(MethodSecurityInterceptor.java:61)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:692)
	at com.example.front.controller.GatewayRestController$$EnhancerBySpringCGLIB$$44ecac03.userPage(<generated>)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1064)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:655)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:327)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:121)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:115)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:105)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:218)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:212)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:110)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:80)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:211)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:183)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:358)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:271)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:94)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1726)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:829)
2021-11-03 13:55:02,626 ERROR org.apache.juli.logging.DirectJDKLog [http-nio-80-exec-4] Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is org.springframework.web.client.ResourceAccessException: I/O error on GET request for "http://localhost:8080": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect] with root cause
java.net.ConnectException: Connection refused: connect
	at java.base/java.net.PlainSocketImpl.connect0(Native Method)
	at java.base/java.net.PlainSocketImpl.socketConnect(PlainSocketImpl.java:101)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:399)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:242)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:224)
	at java.base/java.net.Socket.connect(Socket.java:609)
	at java.base/java.net.Socket.connect(Socket.java:558)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:182)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:474)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:569)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:242)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:341)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:362)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1253)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1187)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1081)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1015)
	at org.springframework.http.client.SimpleBufferingClientHttpRequest.executeInternal(SimpleBufferingClientHttpRequest.java:76)
	at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:66)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:776)
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:711)
	at org.springframework.web.client.RestTemplate.exchange(RestTemplate.java:602)
	at com.example.front.controller.GatewayRestController.userPage(GatewayRestController.java:49)
	at com.example.front.controller.GatewayRestController$$FastClassBySpringCGLIB$$fc584a81.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:779)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750)
	at org.springframework.security.access.intercept.aopalliance.MethodSecurityInterceptor.invoke(MethodSecurityInterceptor.java:61)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:692)
	at com.example.front.controller.GatewayRestController$$EnhancerBySpringCGLIB$$44ecac03.userPage(<generated>)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1064)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:655)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:327)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:121)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:115)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:105)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:218)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:212)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:110)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:80)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:211)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:183)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:358)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:271)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:94)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1726)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:829)
2021-11-03 13:55:03,704 ERROR org.apache.juli.logging.DirectJDKLog [http-nio-80-exec-5] Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is org.springframework.web.client.ResourceAccessException: I/O error on GET request for "http://localhost:8080": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect] with root cause
java.net.ConnectException: Connection refused: connect
	at java.base/java.net.PlainSocketImpl.connect0(Native Method)
	at java.base/java.net.PlainSocketImpl.socketConnect(PlainSocketImpl.java:101)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:399)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:242)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:224)
	at java.base/java.net.Socket.connect(Socket.java:609)
	at java.base/java.net.Socket.connect(Socket.java:558)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:182)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:474)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:569)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:242)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:341)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:362)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1253)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1187)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1081)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1015)
	at org.springframework.http.client.SimpleBufferingClientHttpRequest.executeInternal(SimpleBufferingClientHttpRequest.java:76)
	at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:66)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:776)
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:711)
	at org.springframework.web.client.RestTemplate.exchange(RestTemplate.java:602)
	at com.example.front.controller.GatewayRestController.userPage(GatewayRestController.java:49)
	at com.example.front.controller.GatewayRestController$$FastClassBySpringCGLIB$$fc584a81.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:779)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750)
	at org.springframework.security.access.intercept.aopalliance.MethodSecurityInterceptor.invoke(MethodSecurityInterceptor.java:61)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:692)
	at com.example.front.controller.GatewayRestController$$EnhancerBySpringCGLIB$$44ecac03.userPage(<generated>)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1064)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:655)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:327)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:121)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:115)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:105)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:218)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:212)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:110)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:80)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:211)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:183)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:358)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:271)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:94)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1726)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:829)
2021-11-03 13:55:05,793 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2021-11-03 13:55:05,795 INFO com.zaxxer.hikari.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2021-11-03 13:55:05,804 INFO com.zaxxer.hikari.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2021-11-03 13:55:08,431 INFO org.springframework.boot.StartupInfoLogger [main] Starting Application using Java 11.0.11 on DESKTOP-MME1U5F with PID 14976 (C:\Users\HP-Note\IdeaProjects\JM-PP-3-1-3\target\classes started by HP-Note in C:\Users\HP-Note\IdeaProjects\JM-PP-3-1-3)
2021-11-03 13:55:08,430 INFO org.hibernate.validator.internal.util.Version [background-preinit] HV000001: Hibernate Validator 6.2.0.Final
2021-11-03 13:55:08,435 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2021-11-03 13:55:09,004 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2021-11-03 13:55:09,018 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 9 ms. Found 0 JPA repository interfaces.
2021-11-03 13:55:09,287 INFO org.springframework.context.support.PostProcessorRegistrationDelegate$BeanPostProcessorChecker [main] Bean 'org.springframework.security.access.expression.method.DefaultMethodSecurityExpressionHandler@5edc70ed' of type [org.springframework.security.access.expression.method.DefaultMethodSecurityExpressionHandler] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2021-11-03 13:55:09,292 INFO org.springframework.context.support.PostProcessorRegistrationDelegate$BeanPostProcessorChecker [main] Bean 'methodSecurityMetadataSource' of type [org.springframework.security.access.method.DelegatingMethodSecurityMetadataSource] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2021-11-03 13:55:09,451 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat initialized with port(s): 80 (http)
2021-11-03 13:55:09,458 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-80"]
2021-11-03 13:55:09,458 INFO org.apache.juli.logging.DirectJDKLog [main] Starting service [Tomcat]
2021-11-03 13:55:09,459 INFO org.apache.juli.logging.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/9.0.52]
2021-11-03 13:55:09,530 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2021-11-03 13:55:09,530 INFO org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 1062 ms
2021-11-03 13:55:09,664 INFO org.hibernate.jpa.internal.util.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2021-11-03 13:55:09,690 INFO org.hibernate.Version [main] HHH000412: Hibernate ORM core version 5.4.32.Final
2021-11-03 13:55:09,752 INFO org.hibernate.annotations.common.reflection.java.JavaReflectionManager [main] HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2021-11-03 13:55:09,806 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2021-11-03 13:55:09,964 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2021-11-03 13:55:09,974 INFO org.hibernate.dialect.Dialect [main] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL94Dialect
2021-11-03 13:55:10,486 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] SQL Warning Code: 0, SQLState: 00000
2021-11-03 13:55:10,486 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] удаление распространяется на объект ограничение fkrhfovtciq1l558cw6udg0h0d3 в отношении таблица user_roles
2021-11-03 13:55:10,490 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] SQL Warning Code: 0, SQLState: 00000
2021-11-03 13:55:10,490 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] удаление распространяется на объект ограничение fkhfh9dx7w3ubf1co1vdev94g3f в отношении таблица user_roles
2021-11-03 13:55:10,491 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] SQL Warning Code: 0, SQLState: 00000
2021-11-03 13:55:10,492 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] ограничение "fkrhfovtciq1l558cw6udg0h0d3" в таблице "user_roles" не существует, пропускается
2021-11-03 13:55:10,492 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] SQL Warning Code: 0, SQLState: 00000
2021-11-03 13:55:10,492 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] ограничение "fkhfh9dx7w3ubf1co1vdev94g3f" в таблице "user_roles" не существует, пропускается
2021-11-03 13:55:10,529 INFO org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator [main] HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2021-11-03 13:55:10,535 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2021-11-03 13:55:11,028 INFO org.springframework.boot.autoconfigure.web.servlet.WelcomePageHandlerMapping [main] Adding welcome page template: index
2021-11-03 13:55:11,246 INFO org.springframework.security.web.DefaultSecurityFilterChain [main] Will secure Ant [pattern='/admin'] with [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@2dec57c5, org.springframework.security.web.context.SecurityContextPersistenceFilter@205b73d8, org.springframework.security.web.header.HeaderWriterFilter@2de82bf8, org.springframework.security.web.csrf.CsrfFilter@75312c94, org.springframework.security.web.authentication.logout.LogoutFilter@102f3f05, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@572db5ee, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@5bc40f5d, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@70940cb8, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@5b8599c7, org.springframework.security.web.access.ExceptionTranslationFilter@47f416d0]
2021-11-03 13:55:11,262 INFO org.springframework.security.web.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@73dd3a46, org.springframework.security.web.context.SecurityContextPersistenceFilter@7b6b99c5, org.springframework.security.web.header.HeaderWriterFilter@6ec77cab, org.springframework.security.web.authentication.logout.LogoutFilter@7b43f95c, org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter@394950ad, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@2e1c8027, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@72d7afff, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@bae5e58, org.springframework.security.web.session.SessionManagementFilter@17c72ffa, org.springframework.security.web.access.ExceptionTranslationFilter@67216c33, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@65f3f9e2]
2021-11-03 13:55:11,297 INFO org.apache.juli.logging.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-80"]
2021-11-03 13:55:11,311 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat started on port(s): 80 (http) with context path ''
2021-11-03 13:55:11,321 INFO org.springframework.boot.StartupInfoLogger [main] Started Application in 3.282 seconds (JVM running for 3.845)
2021-11-03 13:55:11,597 INFO org.apache.juli.logging.DirectJDKLog [http-nio-80-exec-1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2021-11-03 13:55:11,598 INFO org.springframework.web.servlet.FrameworkServlet [http-nio-80-exec-1] Initializing Servlet 'dispatcherServlet'
2021-11-03 13:55:11,599 INFO org.springframework.web.servlet.FrameworkServlet [http-nio-80-exec-1] Completed initialization in 1 ms
2021-11-03 13:55:14,031 ERROR org.apache.juli.logging.DirectJDKLog [http-nio-80-exec-4] Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is org.springframework.web.client.ResourceAccessException: I/O error on GET request for "http://localhost:8080": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect] with root cause
java.net.ConnectException: Connection refused: connect
	at java.base/java.net.PlainSocketImpl.connect0(Native Method)
	at java.base/java.net.PlainSocketImpl.socketConnect(PlainSocketImpl.java:101)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:399)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:242)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:224)
	at java.base/java.net.Socket.connect(Socket.java:609)
	at java.base/java.net.Socket.connect(Socket.java:558)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:182)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:474)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:569)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:242)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:341)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:362)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1253)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1187)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1081)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1015)
	at org.springframework.http.client.SimpleBufferingClientHttpRequest.executeInternal(SimpleBufferingClientHttpRequest.java:76)
	at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:66)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:776)
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:711)
	at org.springframework.web.client.RestTemplate.exchange(RestTemplate.java:602)
	at com.example.front.controller.GatewayRestController.userPage(GatewayRestController.java:49)
	at com.example.front.controller.GatewayRestController$$FastClassBySpringCGLIB$$fc584a81.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:779)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750)
	at org.springframework.security.access.intercept.aopalliance.MethodSecurityInterceptor.invoke(MethodSecurityInterceptor.java:61)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:692)
	at com.example.front.controller.GatewayRestController$$EnhancerBySpringCGLIB$$8a22152c.userPage(<generated>)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1064)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:655)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:327)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:121)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:115)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:105)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:218)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:212)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:110)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:80)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:211)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:183)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:358)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:271)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:94)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1726)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:829)
2021-11-03 13:55:15,154 ERROR org.apache.juli.logging.DirectJDKLog [http-nio-80-exec-5] Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is org.springframework.web.client.ResourceAccessException: I/O error on GET request for "http://localhost:8080": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect] with root cause
java.net.ConnectException: Connection refused: connect
	at java.base/java.net.PlainSocketImpl.connect0(Native Method)
	at java.base/java.net.PlainSocketImpl.socketConnect(PlainSocketImpl.java:101)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:399)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:242)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:224)
	at java.base/java.net.Socket.connect(Socket.java:609)
	at java.base/java.net.Socket.connect(Socket.java:558)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:182)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:474)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:569)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:242)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:341)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:362)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1253)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1187)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1081)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1015)
	at org.springframework.http.client.SimpleBufferingClientHttpRequest.executeInternal(SimpleBufferingClientHttpRequest.java:76)
	at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:66)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:776)
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:711)
	at org.springframework.web.client.RestTemplate.exchange(RestTemplate.java:602)
	at com.example.front.controller.GatewayRestController.userPage(GatewayRestController.java:49)
	at com.example.front.controller.GatewayRestController$$FastClassBySpringCGLIB$$fc584a81.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:779)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750)
	at org.springframework.security.access.intercept.aopalliance.MethodSecurityInterceptor.invoke(MethodSecurityInterceptor.java:61)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:692)
	at com.example.front.controller.GatewayRestController$$EnhancerBySpringCGLIB$$8a22152c.userPage(<generated>)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1064)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:655)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:327)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:121)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:115)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:105)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:218)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:212)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:110)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:80)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:211)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:183)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:358)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:271)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:94)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1726)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:829)
2021-11-03 13:55:16,247 ERROR org.apache.juli.logging.DirectJDKLog [http-nio-80-exec-6] Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is org.springframework.web.client.ResourceAccessException: I/O error on GET request for "http://localhost:8080": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect] with root cause
java.net.ConnectException: Connection refused: connect
	at java.base/java.net.PlainSocketImpl.connect0(Native Method)
	at java.base/java.net.PlainSocketImpl.socketConnect(PlainSocketImpl.java:101)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:399)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:242)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:224)
	at java.base/java.net.Socket.connect(Socket.java:609)
	at java.base/java.net.Socket.connect(Socket.java:558)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:182)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:474)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:569)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:242)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:341)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:362)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1253)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1187)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1081)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1015)
	at org.springframework.http.client.SimpleBufferingClientHttpRequest.executeInternal(SimpleBufferingClientHttpRequest.java:76)
	at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:66)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:776)
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:711)
	at org.springframework.web.client.RestTemplate.exchange(RestTemplate.java:602)
	at com.example.front.controller.GatewayRestController.userPage(GatewayRestController.java:49)
	at com.example.front.controller.GatewayRestController$$FastClassBySpringCGLIB$$fc584a81.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:779)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750)
	at org.springframework.security.access.intercept.aopalliance.MethodSecurityInterceptor.invoke(MethodSecurityInterceptor.java:61)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:692)
	at com.example.front.controller.GatewayRestController$$EnhancerBySpringCGLIB$$8a22152c.userPage(<generated>)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1064)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:655)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:327)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:121)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:115)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:105)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:218)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:212)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:110)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:80)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:211)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:183)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:358)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:271)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:94)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1726)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:829)
2021-11-03 13:55:17,333 ERROR org.apache.juli.logging.DirectJDKLog [http-nio-80-exec-7] Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is org.springframework.web.client.ResourceAccessException: I/O error on GET request for "http://localhost:8080": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect] with root cause
java.net.ConnectException: Connection refused: connect
	at java.base/java.net.PlainSocketImpl.connect0(Native Method)
	at java.base/java.net.PlainSocketImpl.socketConnect(PlainSocketImpl.java:101)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:399)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:242)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:224)
	at java.base/java.net.Socket.connect(Socket.java:609)
	at java.base/java.net.Socket.connect(Socket.java:558)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:182)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:474)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:569)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:242)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:341)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:362)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1253)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1187)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1081)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1015)
	at org.springframework.http.client.SimpleBufferingClientHttpRequest.executeInternal(SimpleBufferingClientHttpRequest.java:76)
	at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:66)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:776)
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:711)
	at org.springframework.web.client.RestTemplate.exchange(RestTemplate.java:602)
	at com.example.front.controller.GatewayRestController.userPage(GatewayRestController.java:49)
	at com.example.front.controller.GatewayRestController$$FastClassBySpringCGLIB$$fc584a81.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:779)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750)
	at org.springframework.security.access.intercept.aopalliance.MethodSecurityInterceptor.invoke(MethodSecurityInterceptor.java:61)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:692)
	at com.example.front.controller.GatewayRestController$$EnhancerBySpringCGLIB$$8a22152c.userPage(<generated>)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1064)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:655)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:327)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:121)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:115)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:105)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:218)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:212)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:110)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:80)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:211)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:183)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:358)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:271)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:94)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1726)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:829)
2021-11-03 13:55:18,412 ERROR org.apache.juli.logging.DirectJDKLog [http-nio-80-exec-8] Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is org.springframework.web.client.ResourceAccessException: I/O error on GET request for "http://localhost:8080": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect] with root cause
java.net.ConnectException: Connection refused: connect
	at java.base/java.net.PlainSocketImpl.connect0(Native Method)
	at java.base/java.net.PlainSocketImpl.socketConnect(PlainSocketImpl.java:101)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:399)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:242)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:224)
	at java.base/java.net.Socket.connect(Socket.java:609)
	at java.base/java.net.Socket.connect(Socket.java:558)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:182)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:474)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:569)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:242)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:341)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:362)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1253)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1187)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1081)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1015)
	at org.springframework.http.client.SimpleBufferingClientHttpRequest.executeInternal(SimpleBufferingClientHttpRequest.java:76)
	at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:66)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:776)
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:711)
	at org.springframework.web.client.RestTemplate.exchange(RestTemplate.java:602)
	at com.example.front.controller.GatewayRestController.userPage(GatewayRestController.java:49)
	at com.example.front.controller.GatewayRestController$$FastClassBySpringCGLIB$$fc584a81.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:779)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750)
	at org.springframework.security.access.intercept.aopalliance.MethodSecurityInterceptor.invoke(MethodSecurityInterceptor.java:61)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:692)
	at com.example.front.controller.GatewayRestController$$EnhancerBySpringCGLIB$$8a22152c.userPage(<generated>)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1064)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:655)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:327)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:121)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:115)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:105)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:218)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:212)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:110)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:80)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:211)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:183)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:358)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:271)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:94)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1726)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:829)
2021-11-03 13:55:19,577 ERROR org.apache.juli.logging.DirectJDKLog [http-nio-80-exec-9] Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is org.springframework.web.client.ResourceAccessException: I/O error on GET request for "http://localhost:8080": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect] with root cause
java.net.ConnectException: Connection refused: connect
	at java.base/java.net.PlainSocketImpl.connect0(Native Method)
	at java.base/java.net.PlainSocketImpl.socketConnect(PlainSocketImpl.java:101)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:399)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:242)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:224)
	at java.base/java.net.Socket.connect(Socket.java:609)
	at java.base/java.net.Socket.connect(Socket.java:558)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:182)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:474)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:569)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:242)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:341)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:362)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1253)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1187)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1081)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1015)
	at org.springframework.http.client.SimpleBufferingClientHttpRequest.executeInternal(SimpleBufferingClientHttpRequest.java:76)
	at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:66)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:776)
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:711)
	at org.springframework.web.client.RestTemplate.exchange(RestTemplate.java:602)
	at com.example.front.controller.GatewayRestController.userPage(GatewayRestController.java:49)
	at com.example.front.controller.GatewayRestController$$FastClassBySpringCGLIB$$fc584a81.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:779)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750)
	at org.springframework.security.access.intercept.aopalliance.MethodSecurityInterceptor.invoke(MethodSecurityInterceptor.java:61)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:692)
	at com.example.front.controller.GatewayRestController$$EnhancerBySpringCGLIB$$8a22152c.userPage(<generated>)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1064)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:655)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:327)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:121)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:115)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:105)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:218)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:212)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:110)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:80)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:336)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:211)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:183)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:358)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:271)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:94)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1726)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:829)
2021-11-03 13:55:20,757 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2021-11-03 13:55:20,759 INFO com.zaxxer.hikari.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2021-11-03 13:55:20,769 INFO com.zaxxer.hikari.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2021-11-03 13:57:46,071 INFO org.hibernate.validator.internal.util.Version [background-preinit] HV000001: Hibernate Validator 6.2.0.Final
2021-11-03 13:57:46,071 INFO org.springframework.boot.StartupInfoLogger [main] Starting Application using Java 11.0.11 on DESKTOP-MME1U5F with PID 15336 (C:\Users\HP-Note\IdeaProjects\JM-PP-3-1-3\target\classes started by HP-Note in C:\Users\HP-Note\IdeaProjects\JM-PP-3-1-3)
2021-11-03 13:57:46,071 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2021-11-03 13:57:46,645 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2021-11-03 13:57:46,661 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 9 ms. Found 0 JPA repository interfaces.
2021-11-03 13:57:46,919 INFO org.springframework.context.support.PostProcessorRegistrationDelegate$BeanPostProcessorChecker [main] Bean 'org.springframework.security.access.expression.method.DefaultMethodSecurityExpressionHandler@2cd62003' of type [org.springframework.security.access.expression.method.DefaultMethodSecurityExpressionHandler] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2021-11-03 13:57:46,935 INFO org.springframework.context.support.PostProcessorRegistrationDelegate$BeanPostProcessorChecker [main] Bean 'methodSecurityMetadataSource' of type [org.springframework.security.access.method.DelegatingMethodSecurityMetadataSource] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2021-11-03 13:57:47,102 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat initialized with port(s): 80 (http)
2021-11-03 13:57:47,102 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-80"]
2021-11-03 13:57:47,102 INFO org.apache.juli.logging.DirectJDKLog [main] Starting service [Tomcat]
2021-11-03 13:57:47,102 INFO org.apache.juli.logging.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/9.0.52]
2021-11-03 13:57:47,180 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2021-11-03 13:57:47,180 INFO org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 1078 ms
2021-11-03 13:57:47,304 INFO org.hibernate.jpa.internal.util.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2021-11-03 13:57:47,335 INFO org.hibernate.Version [main] HHH000412: Hibernate ORM core version 5.4.32.Final
2021-11-03 13:57:47,398 INFO org.hibernate.annotations.common.reflection.java.JavaReflectionManager [main] HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2021-11-03 13:57:47,445 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2021-11-03 13:57:47,570 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2021-11-03 13:57:47,585 INFO org.hibernate.dialect.Dialect [main] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL94Dialect
2021-11-03 13:57:48,101 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] SQL Warning Code: 0, SQLState: 00000
2021-11-03 13:57:48,101 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] удаление распространяется на объект ограничение fkrhfovtciq1l558cw6udg0h0d3 в отношении таблица user_roles
2021-11-03 13:57:48,117 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] SQL Warning Code: 0, SQLState: 00000
2021-11-03 13:57:48,117 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] удаление распространяется на объект ограничение fkhfh9dx7w3ubf1co1vdev94g3f в отношении таблица user_roles
2021-11-03 13:57:48,117 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] SQL Warning Code: 0, SQLState: 00000
2021-11-03 13:57:48,117 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] ограничение "fkrhfovtciq1l558cw6udg0h0d3" в таблице "user_roles" не существует, пропускается
2021-11-03 13:57:48,117 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] SQL Warning Code: 0, SQLState: 00000
2021-11-03 13:57:48,117 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper$StandardWarningHandler [main] ограничение "fkhfh9dx7w3ubf1co1vdev94g3f" в таблице "user_roles" не существует, пропускается
2021-11-03 13:57:48,164 INFO org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator [main] HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2021-11-03 13:57:48,164 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2021-11-03 13:57:48,664 INFO org.springframework.boot.autoconfigure.web.servlet.WelcomePageHandlerMapping [main] Adding welcome page template: index
2021-11-03 13:57:48,871 INFO org.springframework.security.web.DefaultSecurityFilterChain [main] Will secure Ant [pattern='/admin'] with [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@4889fbba, org.springframework.security.web.context.SecurityContextPersistenceFilter@1fb00a6d, org.springframework.security.web.header.HeaderWriterFilter@6ffa8126, org.springframework.security.web.csrf.CsrfFilter@15a41088, org.springframework.security.web.authentication.logout.LogoutFilter@7da1ef46, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@2a7b5925, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@25f73119, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@20923380, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@6018d82c, org.springframework.security.web.access.ExceptionTranslationFilter@270ab7bc]
2021-11-03 13:57:48,887 INFO org.springframework.security.web.DefaultSecurityFilterChain [main] Will secure any request with [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@68a97fc1, org.springframework.security.web.context.SecurityContextPersistenceFilter@664083f6, org.springframework.security.web.header.HeaderWriterFilter@37816ea6, org.springframework.security.web.authentication.logout.LogoutFilter@c7a1db6, org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter@4aadf144, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@5a8835c6, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@67216c33, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@227fc322, org.springframework.security.web.session.SessionManagementFilter@35b79b1f, org.springframework.security.web.access.ExceptionTranslationFilter@6bb71265, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@69c51fdb]
2021-11-03 13:57:48,918 INFO org.apache.juli.logging.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-80"]
2021-11-03 13:57:48,934 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat started on port(s): 80 (http) with context path ''
2021-11-03 13:57:48,949 INFO org.springframework.boot.StartupInfoLogger [main] Started Application in 3.266 seconds (JVM running for 3.838)
2021-11-03 13:57:49,230 INFO org.apache.juli.logging.DirectJDKLog [http-nio-80-exec-1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2021-11-03 13:57:49,230 INFO org.springframework.web.servlet.FrameworkServlet [http-nio-80-exec-1] Initializing Servlet 'dispatcherServlet'
2021-11-03 13:57:49,231 INFO org.springframework.web.servlet.FrameworkServlet [http-nio-80-exec-1] Completed initialization in 1 ms
2021-11-03 13:59:30,659 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2021-11-03 13:59:30,659 INFO com.zaxxer.hikari.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2021-11-03 13:59:30,674 INFO com.zaxxer.hikari.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
